(function(){window.console||(window.console={log:function(){},warn:function(){},info:function(){},error:function(){},debug:function(){},dir:function(){}});Ext.define("Forte.IDE",{extend:"Ext.container.Viewport",projectPanel:null,mainPanel:null,infoPanel:null,debugTabControl:null,buildControl:null,id:"component:root",onUnload:!1,forceClose:!1,IDEStatus:{activeTab:0,tabList:[],projectTreeStatus:{},projectPanelWidth:200,infoPanelHeight:200,collapseProjectPanel:!1,collapseInfoPanel:!1,collapseWebdavPanel:!1,
fileCursorList:{},debuggerAutoReload:!0},getIDEStatus:function(){return this.IDEStatus},initComponent:function(){window.forte=this;var a=this;MessageHub.subscribe(Message.SetOnUnloadStatus,function(b){a.onUnload=b.getOnUnload();a.setUnloadAction()});MessageHub.subscribe(Message.SendIDEStatus,function(b){var c=b.getStatusKey(),b=b.getStatusValue();a.IDEStatus[c]=b;c={IDEStatus:a.IDEStatus};try{localStorage.setItem(Forte.API.projectId,JSON.stringify(c))}catch(e){console.log(["Error saving LocalStorage",
e])}});MessageHub.subscribe(Message.HeaderToolbar.FocusSearchBox,function(){var a=Ext.getCmp("mainpanel-toolbar"),b=$("input",a.getEl().dom)[0];a.focus();b.select(0,b.value.length)});var b=null;try{b=JSON.parse(localStorage.getItem(Forte.API.projectId))}catch(c){localStorage.removeItem(Forte.API.projectId)}if(b&&b.IDEStatus)this.IDEStatus=b.IDEStatus;this.buildControl=new Forte.Build.BuildControl;this.infoPanel=this.createInfoPanel();this.projectPanel=this.createProjectPanel();this.mainPanel=this.createMainPanel();
this.utilPanel=this.createUtilPanel();Ext.apply(this,{title:"Monaca IDE",layout:{type:"border",padding:"0"},items:[{region:"north",id:"component:header",xtype:"headertoolbar",buildControl:this.buildControl,debuggerAutoReload:a.IDEStatus.debuggerAutoReload,foundDebuggers:0},this.projectPanel,{region:"center",id:"component:center",xtype:"container",layout:{type:"border",padding:"0"},items:[this.mainPanel,this.infoPanel],listeners:{resize:function(){var a=Ext.getCmp("component:center").layout.splitters.south,
b=$(a.getEl().dom);a.setHeight(0);this.doLayout();b.css({top:b.position().top-4+"px"});setTimeout(function(){$(a.getEl().dom).css({width:"100%",height:"7px","z-index":"10"})},1,a)}},margins:"0 0 0 0"},this.utilPanel],listeners:{resize:function(){var a={west:this.layout.splitters.west,east:this.layout.splitters.east};a.west.setWidth(0);a.east.setWidth(0);typeof a.west.getEl()!=="undefined"&&$(a.west.getEl().dom).css({left:$(a.west.getEl().dom).position().left-3+"px"});typeof a.east.getEl()!=="undefined"&&
$(a.east.getEl().dom).css({left:$(a.east.getEl().dom).position().left-3+"px"});setTimeout(function(){$(a.west.getEl().dom).css({width:"7px","z-index":"10"});$(a.east.getEl().dom).css({width:"7px","z-index":"10"})},1,a);var b=document.getElementById("forte-dashboard");if(b&&typeof b.onresize==="function")b.onresize()},afterrender:function(){getQueryString().hide_preview_panel!=="true"&&Ext.getCmp("component:previewpanel").showContent()}}});b=function(a){Ext.getCmp();a.clientX<Ext.getCmp("component:projectpanel").getWidth()&&
a.clientY>Ext.getCmp("component:header").getHeight()||a.preventDefault()};window.addEventListener("dragover",b,false);window.addEventListener("drop",b,false);this.loadmask=new Ext.LoadMask(this,{msg:'<img src="/img/loading-icon.gif" /><br />Loading...'});this.callParent();if(isChromeAppInstalled()){Forte.API.pingToChromeDebugger();setInterval(function(){Forte.API.pingToChromeDebugger()},5E3)}var e=function(){var a=Forte.API.readUserSetting(null,function(){});a.fail(function(){Cell.LightMessageBox.show({title:Forte.Resources.Text.ERROR_NETWORK_TITLE,
msg:Forte.Resources.Text.ERROR_NETWORK,buttons:Cell.LightMessageBox.OK});window.setTimeout(e,18E4)});a.success(function(){window.setTimeout(e,18E4)})};window.setTimeout(e,18E4);b=function(){Forte.API.checkMultiUse().done(function(a){a.result.isDetectedMultiUse&&Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,msg:a.result.description,buttons:Cell.LightMessageBox.OKCANCEL,callback:function(a){if(a=="ok")location.href=MONACA_WEB_HOST_SSL+"/dashboard"}})})};window.setTimeout(b,12E4);
window.setInterval(b,3E5);!bowser.webkit&&!bowser.firefox?Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.ERROR_GENERAL_UNSUPPORTED_BROWSER):bowser.safari&&parseFloat(bowser.version)<6&&Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.ERROR_GENERAL_UNSUPPORTED_BROWSER);detectWinMac()==="win"&&$("body").addClass("x-win");Forte.Settings.Keymap.initKeymap();a.setUnloadAction()},setUnloadAction:function(){var a=
this;$(window).unbind("beforeunload");a.onUnload&&$(window).bind("beforeunload",function(){if(!a.forceClose)return Forte.Resources.Text.GENERAL_CLOSE_WINDOW_CONFIRM})},createProjectPanel:function(){return Ext.create("Forte.ProjectPanel",{id:"component:projectpanel-wrap",animCollapse:false,margins:"0",collapseWebdavPanel:this.IDEStatus.collapseWebdavPanel,collapseProjectPanel:this.IDEStatus.collapseProjectPanel,projectTreeStatus:this.IDEStatus.projectTreeStatus,projectPanelWidth:this.IDEStatus.projectPanelWidth,
listeners:{collapse:function(){Ext.getCmp("component:root").fireEvent("resize");Ext.getCmp("mainpanel-collapse-projectpanel").addClass("collapsed")},expand:function(){Ext.getCmp("component:root").fireEvent("resize");Ext.getCmp("mainpanel-collapse-projectpanel").removeCls("collapsed")},resize:function(){Ext.getCmp("component:root").fireEvent("resize")}}})},createMainPanel:function(){if(!this.IDEStatus.fileCursorList)this.IDEStatus.fileCursorList={};return Ext.create("Forte.MainPanel",{preTabList:this.IDEStatus.tabList,
preActiveTab:this.IDEStatus.activeTab,fileCursorList:this.IDEStatus.fileCursorList,region:"center",margins:"0"})},createUtilPanel:function(){return Ext.create("Forte.PreviewPanel.PreviewPanel",{})},createToolbarPanel:function(){MessageHub.subscribe(Message.UpdateEditorState,function(b){var c=a.down("#save_button"),e=a.down("#searchbox");if(b.isSaving()){c.setDisabled(true);b.isSaving()&&c.setIconCls("ide-loading-icon2")}else{c.setDisabled(!b.activeTabIsUnsaved());c.setIconCls("ide-header-save")}e.setDisabled(!b.isAceTab())});
var a;return a=Ext.create("Ext.toolbar.Toolbar",{region:"north",margin:"3 0 0 0",baseCls:"none",items:[{xtype:"cell.button",text:Forte.Resources.Text.HEADER_BUTTON_SAVE,iconCls:"ide-header-save",itemId:"save_button",disabled:true,handler:function(){Message.MainPanel.SaveActiveEditorTab.send()},ui:"embed"},"->",{xtype:"cell.textfield",ui:"searchbox",itemId:"searchbox",emptyText:"Search...",listeners:{specialkey:function(a,c){if(c.getKey()==c.ENTER){var e=a.getValue();MessageHub.send(new Message.MainPanel.SearchActiveTab(e,
c.shiftKey))}},focus:function(){var a=$("input",this.getEl().dom)[0];a.select(0,a.value.length)}}}]})},createInfoPanel:function(){return Ext.create("Forte.InfoPanel.InfoPanel",{infoPanelHeight:this.IDEStatus.infoPanelHeight,collapseInfoPanel:this.IDEStatus.collapseInfoPanel})}});Ext.onReady(function(){Ext.resizer.SplitterTracker.override({performResize:function(a){var b=this.getSplitter();b.orientation==="vertical"?b.setWidth(0):b.setHeight(0);setTimeout(function(){var a=$(b.getEl().dom);b.orientation===
"vertical"?a.css({width:"7px","z-index":"10"}):a.css({top:a.position().top-4+"px",height:"7px","z-index":"10"})},1,b);this.callOverridden(a)}})})})();Forte.IDE.PLUGIN_INAPP_UPDATER="io.monaca.plugins.inappupdater";Forte.IDE.PLUGIN_ASSETS_ENCRYPTION="mobi.monaca.plugins.Encrypt";Forte.IDE.PLUGIN_CROSSWALK="cordova-plugin-crosswalk-webview";(function(){var a="",a=location.pathname.match(/^\/dev.php/)?"/dev.php/api":"/api";Ext.define("Forte.API",{singleton:!0,projectId:null,chromeAppId:"eampeimhpjmnimjbfajnbegjnafjadld",projectName:null,backendId:null,mbaasAppId:null,userName:null,hasAppUploadSupport:null,planName:null,projectDirectory:null,otherProjects:null,projectSettings:null,projectSettingFileList:null,logoutUrl:null,mypageUrl:null,previewUrl:null,apiToken:null,debugToken:null,inspectorUrl:null,subscriberUrl:null,idePublisherUrl:null,
gravatar:null,hasReadmeMd:!1,previewWindowUrl:null,treeCache:null,iosCustomDebuggerVer:"",androidCustomDebuggerVer:"",isInspectorLoaded:!1,isStorageExceeded:!1,projectRole:null,frameworkVersion:null,cordovaVersion:null,cordovaVersionList:null,cordovaPlatformVersions:null,ideMode:null,isStandardCordova:null,init:function(a){var c=jQuery.Deferred(),e=this;this.projectId=a.projectId;this.ideHost=a.ideHost;this.appHost=a.appHost;this.apiToken=a.apiToken;this.getJSON("/project/:project_id/getProjectInfo").success(function(a){a?
(e.setParameters(a.result),c.resolve()):c.reject("Failed to initialize project")}).error(function(a){Forte.API.convertFail(null,a);c.reject()});return c.promise()},setParameters:function(a){for(var c in a)this[c]=a[c]},addApiTokenToParams:function(a){a=a||{};a.api_token=this.apiToken;return a},getAPIUrl:function(a){return this.ideHost+a.replace(":project_id",this.projectId)},getJSON:function(a,c){return $.getJSON(this.getAPIUrl(a),this.addApiTokenToParams(c))},postJSON:function(a,c){return $.post(this.getAPIUrl(a),
this.addApiTokenToParams(c),null,"json")},getText:function(a,c){return $.get(this.getAPIUrl(a),this.addApiTokenToParams(c),null,"text")},tree:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.getJSON("/api/project/:project_id/file/tree",a).success(function(a){"ok"==a.status?(Forte.API.treeCache=a.result.items,c(a.result.items)):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},read:function(a,
c,e,f){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};a=a.replace(/\+/g,"%2B");return this.getText("/api/project/:project_id/file/read/"+a,f).success(function(a){c({content:a})}).error(function(a){Forte.API.convertFail(e,a)})},getProjectFileUrl:function(a){return this.getAPIUrl("/api/project/:project_id/file/read/"+a+"?api_token="+this.apiToken)},"export":function(a){return this.getAPIUrl("/api/project/:project_id/export/"+a+"?api_token="+
this.apiToken)},save:function(a,c,e,f,g,h){var e=e||function(){},f=f||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},j=this;return this.postJSON("/api/project/:project_id/file/save",{token:this.token,content:c,path:a,debugKey:this.debugToken,contentFrom:g||"",templateId:h||""}).success(function(c){if(isChromeAppInstalled()){var g={action:"reload",projectId:j.projectId,deviceId:"all"};a&&(g.filepath=[a]);chrome.runtime.sendMessage(j.chromeAppId,g)}"ok"===
c.status?e(c):f(c.code,c.message)}).error(function(a){Forte.API.convertFail(f,a)})},remove:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/file/remove",{token:this.token,path:a}).success(function(a){"ok"==a.status?c():e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},rmdir:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
b)};return this.postJSON("/api/project/:project_id/file/remove",{token:this.token,path:a}).success(function(a){"ok"==a.status?c():e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},mkdir:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/file/mkdir",{token:this.token,path:a}).success(function(a){"ok"==a.status?c():e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,
a)})},move:function(a,c,e,f){e=e||function(){};f=f||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/file/move",{token:this.token,from:a,to:c}).success(function(a){"ok"==a.status?e():f(a.code,a.message)}).error(function(a){Forte.API.convertFail(f,a)})},qrcode:function(a,c){"undefined"===typeof c&&(c=120);return"https://chart.googleapis.com/chart?chs="+c+"&cht=qr&chl="+encodeURIComponent(a)},sendApp:function(a,
c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/build/sendapp",{queue_id:a}).success(function(a){"ok"==a.status?c():e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},copy:function(a,c,e,f){e=e||function(){};f=f||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/file/copy",
{token:this.token,fromPath:a,toPath:c}).success(function(a){"ok"==a.status?e():f(a.code,a.message)}).error(function(a){Forte.API.convertFail(f,a)})},upload:function(a,c,e,f){var g=new XMLHttpRequest;g.open("post",a+"?api_token="+this.apiToken);g.setRequestHeader("X-Requested-With","XMLHttpRequest");g.addEventListener("readystatechange",function(){switch(this.status){case 413:this.abort(),f(413,Forte.Resources.Text.WIDGETS_UPLOAD_ERROR_FILESIZE)}});g.addEventListener("load",function(a){try{var b=JSON.parse(a.target.responseText);
if(!b)throw"Invalid response";"ok"===b.status?e(b.result):f(b.code,b.message)}catch(c){f(0,Forte.Resources.Text.GENERAL_ERROR_MSG)}},!1);var a=new FormData,h;for(h in c)a.append(h,c[h]);g.send(a)},uploads:function(b,c,e,f,g){var f=f||function(){},g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},h=new XMLHttpRequest;"@"==b.charAt(0)?h.open("post",b.substr(1),!0):h.open("post",a+"/project/"+this.projectId+"/file/save?api_token="+this.apiToken,!0);h.setRequestHeader("X-Requested-With",
"XMLHttpRequest");h.addEventListener("readystatechange",function(){switch(this.status){case 413:this.abort(),g(413,Forte.Resources.Text.WIDGETS_UPLOAD_ERROR_FILESIZE)}});h.addEventListener("load",function(a){switch(this.status){case 200:var b={};try{b=jQuery.parseJSON(a.target.responseText)}catch(c){Forte.API.convertFail(g,this);break}"ok"===b.status?f(b):g(b.code,b.message||Forte.Resources.Text.GENERAL_ERROR_MSG);break;default:Forte.API.convertFail(g,this)}},!1);h.onerror=function(){Forte.API.convertFail(g,
this)};var j=new FormData;j.append("path",b+c.name);b="";b=e instanceof jQuery?e.attr("name"):"string"===typeof e?e:"file";j.append(b,c);h.send(j)},uploadTo:function(a,c,e,f,g){return Forte.API.uploads("@"+a,c,e,f,g)},readProjectSetting:function(a,c){var a=a||function(){},c=c||Forte.API.showProjectSettingError,e=this;return this.getJSON("/api/project/:project_id/setting/read").success(function(f){"ok"==f.status?(e.projectSettings=f.result,a(f.result)):c(f.code,f.message)}).error(function(a){Forte.API.convertFail(c,
a)})},saveProjectSetting:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/setting/save",{settings:a}).success(function(a){"ok"==a.status?c():e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},uploadSetting:function(a,c,e,f,g,h){f=f||function(){};g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};null==h&&
(h=c);"string"===typeof a?$target=$(".x-form-file-input[name="+h+"]"):($target=a,a=c);bowser.msie?(a={},a.type=c,a.project=e,a[c]=$target[0].files[0],this.upload(Forte.API.getAPIUrl("/api/project/:project_id/setting/upload"),a,f,g)):$target.upload(Forte.API.getAPIUrl("/api/project/:project_id/setting/upload"),this.addApiTokenToParams({type:c,project:e}),function(a){a?a.status=="ok"?f(a.result):g(a.code,a.message):g(0,Forte.Resources.Text.GENERAL_ERROR_MSG)},"json")},importPKCSKey:function(a,c,e,f,
g){f=f||function(){};g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};if(bowser.msie){var h={};h.type=a;h.password=e;h[a]=c[0].files[0];this.upload(Forte.API.getAPIUrl("/api/project/:project_id/import/pkcs"),h,f,g)}else c.upload(Forte.API.getAPIUrl("/api/project/:project_id/import/pkcs"),this.addApiTokenToParams({type:a,password:e}),function(a){a?"ok"==a.status?f(a.result):g(a.code,a.message):g(0,Forte.Resources.Text.GENERAL_ERROR_MSG)},"json")},deleteSettingImg:function(b,
c,e,f,g){f=f||function(){};g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.post(a+"/project/"+this.projectId+"/setting/deleteImg",this.addApiTokenToParams({type:c,project:e}),function(){},"json").success(function(a){"ok"==a.status?f(a.result):g(a.code,a.message)}).error(function(a){Forte.API.convertFail(g,a)})},uploadSettingImg:function(a,c,e,f,g){f=f||function(){};g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
b)};switch(c){case "icon_all_android":a="/androidIcon";break;case "icon_all_ios":a="/iosIcon";break;case "splash_all_ios":a="/iosSplash";break;default:a=""}if(bowser.msie){var e={},h=document.getElementsByClassName("x-form-file-input")[c];h||g();e.type=c;e[c]=h.files[0];this.upload(this.getAPIUrl("/api/project/:project_id/setting/uploadImg"+a),e,f,g)}else $(".x-form-file-input[name="+c+"]").upload(this.getAPIUrl("/api/project/:project_id/setting/uploadImg"+a),this.addApiTokenToParams({type:c}),function(a){a?
"ok"==a.status?f(a.result):g(a.code,a.message):g(0,Forte.Resources.Text.GENERAL_ERROR_MSG)},"json")},readProjectSettingFileList:function(b,c){var b=b||function(){},c=c||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},e=this;return $.getJSON(a+"/project/"+this.projectId+"/setting/filelist",this.addApiTokenToParams({})).success(function(a){"ok"==a.status?(e.projectSettingFileList=a.result.filelist,b()):c(a.code,a.message)}).error(function(a){Forte.API.convertFail(c,
a)})},getProjectSettingFileList:function(){return this.projectSettingFileList},saveUserSetting:function(b,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.post(a+"/project/"+this.projectId+"/usersetting/save",this.addApiTokenToParams({settings:b}),function(){},"json").success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},readUserSetting:function(b,c){b=b||
function(){};c=c||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.getJSON(a+"/project/"+this.projectId+"/usersetting/read",this.addApiTokenToParams({}),function(){},"json").success(function(a){"ok"==a.status?b(a.result.settings):c(a.code,a.message)}).error(function(a){Forte.API.convertFail(c,a)})},getUserSetting:function(b){var c=b||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},e={};$.ajax({dataType:"json",
url:a+"/project/"+this.projectId+"/usersetting/read",data:this.addApiTokenToParams({}),async:!1,timeout:1E4,success:function(a){"ok"==a.status?e=a.result.settings:c(a.code,a.message)},error:function(a){Forte.API.convertFail(c,a)}});return e},makeKeystore:function(b,c,e,f,g){f=f||function(){};g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.post(a+"/project/"+this.projectId+"/setting/make/keystore",this.addApiTokenToParams({password:b,alias:c,
alias_password:e}),function(){},"json").success(function(a){"ok"==a.status?f(a.result):g(a.code,a.message)}).error(function(a){Forte.API.convertFail(g,a)})},makeAlias:function(b,c,e,f){e=e||function(){};f=f||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.post(a+"/project/"+this.projectId+"/setting/make/alias",this.addApiTokenToParams({alias:b,password:c}),function(){},"json").success(function(a){"ok"==a.status?e(a.result):f(a.code,a.message)}).error(function(a){Forte.API.convertFail(f,
a)})},deleteAlias:function(b,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.post(a+"/project/"+this.projectId+"/setting/delete/alias",this.addApiTokenToParams({alias:b}),function(){},"json").success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},makeCSR:function(b,c,e,f,g){f=f||function(){};g=g||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
b)};return $.post(a+"/project/"+this.projectId+"/setting/make/csr",this.addApiTokenToParams({email:b,username:c,type:e}),function(){},"json").success(function(a){"ok"==a.status?f(a.result):g(a.code,a.message)}).error(function(a){Forte.API.convertFail(g,a)})},deleteCert:function(b,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return $.post(a+"/project/"+this.projectId+"/setting/delete/cert",this.addApiTokenToParams({type:b}),
function(){},"json").success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},build:function(b,c,e,f){var g=a+"/project/"+this.projectId+"/build",c={platform:b||"android",purpose:c||"debug",framework_version:this.frameworkVersion};"android"===b&&"undefined"!==typeof f.androidWebView&&(c.android_webview=f.androidWebView);"android"===b&&"crosswalk"===f.androidWebView&&(c.android_arch=f.androidArch);this.sendEventToGA("build","execute",c.platform,
c);var h=$.post(g,this.addApiTokenToParams(c),function(a){window.dispatchEvent(new CustomEvent("buildStarted"));e(a,h)},"json");return h},buildStatus:function(b,c){var e=$.post(a+"/project/"+this.projectId+"/build/status/"+b,this.addApiTokenToParams({}),function(a){c(a,e)},"json");return e},buildResult:function(b,c){var e=$.post(a+"/project/"+this.projectId+"/build/result/"+b,this.addApiTokenToParams({}),function(a){c(a,e)},"json");return e},buildDebugger:function(b,c,e){var f=a+"/build/debugger",
g={project_id:this.projectId,platform:b,purpose:"debug"};"android"===b&&"undefined"!==typeof e.androidWebView&&(g.android_webview=e.androidWebView);"android"===b&&"crosswalk"===e.androidWebView&&(g.android_arch=e.androidArch);var h=$.post(f,this.addApiTokenToParams(g),function(a){c(a,h)},"json"),j=null,j=setInterval(function(){if(h.readyState>=1){clearInterval(j);var a=document.getElementById("iframe:"+Forte.API.getAPIUrl("/page/buildHistory"));if(a){a=a.getElementsByTagName("iframe");a.length&&a[0].contentWindow.dispatchEvent(new CustomEvent("buildStarted"))}}},
500);return h},readEnvironmentSettings:function(b,c){return $.get(a+"/project/"+this.projectId+"/env_setting/read",this.addApiTokenToParams({}),function(a){"ok"==a.status?b(a.result):c(a.code,a.reason)},"json").error(function(a){Forte.API.convertFail(c,a)})},saveEnvironmentSettings:function(b,c,e){return $.post(a+"/project/"+this.projectId+"/env_setting/save",this.addApiTokenToParams(b),function(a){"ok"==a.status?c(a.result):e(a.code,a.reason)},"json")},canBuildAndroidApp:function(b,c){return $.get(a+
"/project/"+this.projectId+"/can_build_android_app",this.addApiTokenToParams({}),function(a){"ok"==a.status?b(a.result):c(a.code,a.reason)},"json")},canBuildIOSApp:function(b,c){return $.get(a+"/project/"+this.projectId+"/can_build_ios_app",this.addApiTokenToParams({}),function(a){"ok"==a.status?b(a.result):c(a.code,a.reason)},"json")},listIntegration:function(a,c){return this.getJSON("/api/project/:project_id/integration/list").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,
a)})},listCordovaPlugin:function(a,c){return this.getJSON("/api/project/:project_id/cordovaPlugin/list").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,a)})},getInstalledCordovaRegistryIoPlugins:function(a,c){return this.getJSON("/api/project/:project_id/cordovaPlugin/getCordovaRegistryIoPlugins").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,a)})},disableCordovaPlugin:function(a,
c,e){return this.postJSON("/api/project/:project_id/cordovaPlugin/disable",{id:a}).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},enableCordovaPlugin:function(a,c,e){return this.postJSON("/api/project/:project_id/cordovaPlugin/enable",{id:a}).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},importCordovaPlugin:function(a,c,e,f){var g=Forte.API.getAPIUrl("/api/project/:project_id/cordovaPlugin/import?api_token="+
Forte.API.apiToken);return"string"===typeof a?$.post(g,{name:a},null,"json").done(function(a){"ok"==a.status?e(a.result):f(a.code,a.message)}).fail(function(a){Forte.API.convertFail(f,a)}):Forte.API.uploadTo(g,a,c,e,f)},switchCordovaVersion:function(a,c,e){e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/cordova/switchCordovaVersion",{cordovaVersion:a}).success(function(a){"ok"==a.status?c(a.result):e(a.code,
a.message)}).error(function(a){Forte.API.convertFail(e,a)})},upgradeCordovaVersion:function(a,c){c=c||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/cordova/upgradeCordovaVersion").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,a)})},listHtml5Plugin:function(a,c,e){return this.getJSON("/api/project/:project_id/html5Plugin/list",{keyword:a}).success(function(a){"ok"==
a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},getHtml5PluginInfo:function(a,c,e){return this.getJSON("/api/project/:project_id/html5Plugin/info",a).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},installHtml5Plugin:function(a,c,e,f){return this.getJSON("/api/project/:project_id/html5Plugin/install",{name:a,version:c}).success(function(a){"ok"==a.status?e(a.result):f(a.code,a.message)}).error(function(a){Forte.API.convertFail(f,
a)})},uninstallHtml5Plugin:function(a,c,e){return this.getJSON("/api/project/:project_id/html5Plugin/uninstall",{name:a}).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},setHtml5PluginLoader:function(a,c,e){return this.postJSON("/api/project/:project_id/html5Plugin/setLoader",{filenames:a}).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},getVersionListOfPlugin:function(a){return this.filterResult(this.getJSON("/api/project/:project_id/cordovaPlugin/versionList",
{pluginId:a}))},getClientList:function(a,c){return this.getJSON("/api/user/info/clientList").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,a)})},sendProjectRun:function(){return this.postJSON("/api/project/:project_id/run")},download:function(a){return this.getAPIUrl("/api/project/:project_id/folder/download?path="+encodeURIComponent(a)+"&api_token="+Forte.API.apiToken)},grep:function(b,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
b)};return $.getJSON(a+"/project/"+this.projectId+"/file/grep",this.addApiTokenToParams(b)).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},history:function(b,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};b=b.replace(/\+/g,"%2B");return $.getJSON(a+"/project/"+this.projectId+"/file/history"+b,this.addApiTokenToParams({})).success(function(a){if("ok"==a.status){var b=
a.result;b.snapshotHistories=[];b.history.forEach(function(a){""!=a.snapshot_path&&b.snapshotHistories.push(a)});c(b)}else e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},addTeamUser:function(b,c,e){return $.getJSON(a+"/project/"+this.projectId+"/team/userAdd",this.addApiTokenToParams(b)).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},listTeamUser:function(b,c,e){return $.getJSON(a+"/project/"+this.projectId+
"/team/userList",this.addApiTokenToParams(b)).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},removeTeamUser:function(b,c,e){return $.getJSON(a+"/project/"+this.projectId+"/team/userRemove",this.addApiTokenToParams(b)).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},changeTeamUserRole:function(b,c,e){return $.getJSON(a+"/project/"+this.projectId+"/team/changeRole",
this.addApiTokenToParams(b)).success(function(a){"ok"==a.status?c(a.result):e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},setWelcomeState:function(a){document.cookie="welcome="+a+"; expires="+(new Date(2020,12,31)).toGMTString()},sendToInspector:function(a){if(!1!=this.isInspectorLoaded){var c=document.getElementById("ide-inspector-iframe");-1!=c.src.indexOf(this.inspectorUrl)&&c.contentWindow.postMessage(a,this.inspectorUrl)}},sendToTeamPanel:function(a){var c=document.getElementById("ide-team-iframe");
c&&-1!=c.src.indexOf(this.ideHost)&&c.contentWindow.postMessage(a,c.src)},getFilesByDirAndType:function(a){var c=[],e=[],a=getFileDirectory(a.substr(a.indexOf("/www/"))),f;for(f in this.treeCache){var g=this.treeCache[f];"file"==g.type&&("image"==g.content&&getFileDirectory(f)==a)&&(c.push(g),e.push(getFileName(f)))}for(f=0;f<c.length;f++)c[f].name=e[f];return c},getDebuggerVersion:function(a,c,e){"ios"!==a&&"android"!==a||("function"!==typeof e&&(e=function(){}),a=this.getAPIUrl("/api/project/:project_id/debugger_version/")+
a,$.getJSON(a,this.addApiTokenToParams({})).done(function(a){"ok"==a.status?c(a.result.version):e()}).fail(e))},getEnabledCordovaPlugins:function(a,c){a=a||function(){};c=c||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.getJSON("/api/project/:project_id/cordovaPlugin/listEnabled").success(function(e){"ok"===e.status?a(e.result.list):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,a)})},postCloud:function(a,c,e,f,g){if("undefined"===
typeof a)throw Error("Forte.API.postCloud: Invalid arguments");if(null===c||"undefined"===typeof c)c={};c.__token=this.apiToken;a=JSON.stringify({jsonrpc:"2.0",method:a,params:c,id:"1"});e=e||function(){};f=f||function(a){var b=a.message+"\n";if("undefined"!==typeof a.data)for(errKey in a.data)b+=" - "+errKey+": "+a.data[errKey]+"\n";var c=Forte.Resources.Text.GENERAL_ERROR;a.code&&(c+=" ("+a.code+")");Cell.LightMessageBox.alert({title:c,msg:b,minWidth:400,buttons:1})};return $.ajax({url:this.cloudHost+
"admin/json-rpc/"+this.backendId,data:a,dataType:"json",type:"POST",timeout:2E4,headers:{"Content-Type":"application/json"},xhrFields:{withCredentials:!0},success:function(a,b,c){"undefined"!==typeof a.error?f(a.error):e(a.result,b,c)},error:function(a,b,c){f({code:"",message:c?c:b})},complete:g||function(){}})},_postBackend:function(b,c,e,f,g){e=e||function(){};f=f||function(a){var b=a.message+"\n";if("undefined"!==typeof a.data)for(errKey in a.data)b+=" - "+errKey+": "+a.data[errKey]+"\n";var c=
Forte.Resources.Text.GENERAL_ERROR;a.code&&(c+=" ("+a.code+")");Cell.LightMessageBox.alert({title:c,msg:b,minWidth:400,buttons:1})};return $.post(a+"/backend/"+this.projectId+"/"+b,this.addApiTokenToParams(c),null,"json").done(function(a){"ok"==a.status?e(a.result):f({code:a.code,message:a.message})}).fail(function(a,b,c){f({code:null,message:c?c:b,data:null})}).always(g||function(){})},createBackend:function(a,c,e,f){this._postBackend("create",{name:a},c,e,f)},deleteBackend:function(a,c,e,f){this._postBackend("delete",
{_id:a},c,e,f)},renameBackend:function(a,c,e,f,g){this._postBackend("rename",{_id:a,name:c},e,f,g)},changeBackend:function(a,c,e,f,g){this._postBackend("change",{_id:a,backend_type:c},e,f,g)},detachBackend:function(a,c,e){this._postBackend("detach",{},a,c,e)},saveBackendSettings:function(a,c,e,f){this._postBackend("setting/save",{backendId:this.backendId,settings:a},c,e,f)},loadBackendSettings:function(a,c,e){this._postBackend("setting/load",{backendId:this.backendId},a,c,e)},getBackendList:function(a,
c,e){this._postBackend("list",{},function(c){for(var e=0;e<c.backends.length;e++)c.backends[e].name=Ext.htmlEncode(c.backends[e].name);a&&a(c)},c,e)},getOwnedBackendList:function(a,c,e){this._postBackend("ownedlist",{},function(c){for(var e=0;e<c.backends.length;e++)c.backends[e].name=Ext.htmlEncode(c.backends[e].name);a&&a(c)},c,e)},getOptionalAndroidPermissions:function(){return{"android.permission.ACCESS_COARSE_LOCATION":"Access Coarse Location","android.permission.ACCESS_FINE_LOCATION":"Access Fine Location",
"android.permission.ACCESS_LOCATION_EXTRA_COMMANDS":"Access Location Extra Commands","android.permission.BLUETOOTH":"Bluetooth","android.permission.BLUETOOTH_ADMIN":"Bluetooth (Admin)","android.permission.CAMERA":"Camera","android.permission.FLASHLIGHT":"Flashlight","android.permission.MODIFY_AUDIO_SETTINGS":"Modify Audio Settings","android.permission.READ_PHONE_STATE":"Read Phone State","android.permission.RECEIVE_SMS":"Receive SMS","android.permission.RECORD_AUDIO":"Record Audio","android.permission.READ_CONTACTS":"Read Contacts",
"android.permission.VIBRATE":"Vibrate","android.permission.WRITE_CONTACTS":"Write Contacts","android.permission.WAKE_LOCK":"Wake Lock","android.permission.RECEIVE_BOOT_COMPLETED":"Receive Boot Completed","android.permission.GET_ACCOUNTS":"Get Accounts","android.permission.WRITE_EXTERNAL_STORAGE":"Write External Storage"}},convertFail:function(a,c){if(!(4>c.readyState)){var a=a||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},e;try{e=JSON.parse(c.responseText)}catch(f){a(0,
Forte.Resources.Text.GENERAL_ERROR_MSG,{});return}a(e.code,e.message,e)}},pingToChromeDebugger:function(){isChromeAppInstalled()&&chrome.runtime.sendMessage(Forte.API.chromeAppId,{action:"ping"})},saveAssetsEncryptPassword:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.postJSON("/api/project/:project_id/specificPlugin/saveAssetsEncryptPassword",{data:a}).success(function(a){"ok"==a.status?c():e(a.code,
a.message)}).error(function(a){Forte.API.convertFail(e,a)})},getInAppUpdaterSetting:function(a,c){a=a||function(){};c=c||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.getJSON("/api/project/:project_id/specificPlugin/getInAppUpdaterSetting").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(a){Forte.API.convertFail(c,a)})},saveInAppUpdaterSetting:function(a,c,e){c=c||function(){};e=e||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
b)};return this.postJSON("/api/project/:project_id/specificPlugin/saveInAppUpdaterSetting",{data:a}).success(function(a){"ok"==a.status?c():e(a.code,a.message)}).error(function(a){Forte.API.convertFail(e,a)})},skipSetLoader:function(){return this.filterResult(this.getJSON("/api/project/:project_id/html5Plugin/skipSetLoader"))},showError:function(a){var c={title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:"",buttons:Cell.LightMessageBox.OK,modal:!0,noEscape:!1,fn:function(){}};"string"===typeof a?
c.msg=a:$.extend(c,a);Cell.LightMessageBox.show(c)},getUserInfoNews:function(a,c){a=a||function(){};c=c||function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)};return this.getJSON("/api/user/info/news").success(function(e){"ok"==e.status?a(e.result):c(e.code,e.message)}).error(function(){Forte.API.convertFail(c,jqXHR)})},filterResult:function(a){return a.then(function(a){return"ok"==a.status?$.Deferred().resolve(a.result).promise():$.Deferred().reject(a.code,
a.message,a).promise()},function(){var c=$.Deferred();Forte.API.convertFail(function(a,b,g){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b);c.reject(a,b,g)},a);return c.promise()})},getSpecificPluginSettings:function(a){return this.filterResult(this.getJSON("/api/project/:project_id/specificPlugin/getPluginSettings",{pluginId:a.id}))},updateSpecificPluginSettings:function(a,c){var e=a.id.split("@")[0],e=$.extend({pluginId:e},c);return this.filterResult(this.postJSON("/api/project/:project_id/specificPlugin/updatePluginSettings",
e))},sendEventToGA:function(a,c,e,f,g){"function"===typeof ga&&ga("send","event",a,c,e,f);"undefined"!==typeof mixpanel&&(g=g||{},g.category=a,g.action=c,g.label=e,g.value=f,mixpanel.track(a+"/"+c,g))},checkMultiUse:function(){return this.getJSON("/api/user/info/checkMultiUse")},switchLanguage:function(a){return this.getJSON("/api/user/info/switchLanguage/"+a)},showProjectSettingError:function(a,c,e){Forte.API.isStandardCordova&&!Forte.API.ideMode&&e&&e.result&&e.result.hasConfigXmlParseError?Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
Forte.Resources.Text.ERROR_CONFIG_XML_PARSE,function(){MessageHub.send(new Message.MainPanel.OpenEditorTab({filepath:"/config.xml",mime:"text/xml"}))}):Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,c)},showOtherDevToolsDialog:function(a){angular.element(document.getElementById("dashboard-controller")).scope().onClickStartButton(a,"widget-devtools-guide")},getSessionUrl:function(a){return this.getJSON("/api/user/getSessionUrl?url="+a)}});Forte.API.FRAMEWORK_VERSION_TWO=
2.9;Forte.API.FRAMEWORK_VERSION_THREE=3.5;Forte.API.CORDOVA_VERSION_FIVE=5.2;Forte.API.CORDOVA_VERSION_SIX=6.2;Forte.API.CORDOVA_VERSION_FINAL=Forte.API.CORDOVA_VERSION_SIX;Forte.API.IDEMODE_SETTING="setting";Forte.API.IDEMODE_BUILD="build";Forte.API.IDEMODE_DEBUGGER="debugger"})();(function(){Ext.define("Forte.MainPanel",{extend:"Cell.tab.TabPanel",alias:"widget.mainpanel",tabQueue:[],creatingTab:!1,preTabList:null,preActiveTab:null,fileCursorList:{},currentTabFileName:"",savingAll:{},environmentSettings:null,editorToolbar:null,keybindHandlers:{ace:null,emacs:null,vim:null},tabDict:{},plugins:[{ptype:"itstabtool",position:"after",items:[{xtype:"button",dock:"top",icon:"/img/new_ide/main/tabbar_detail.png",ui:"embed-detail",id:"mainpanel-menu",tooltip:Forte.Resources.Text.MAIN_DETAIL_TOOLTIP,
listeners:{click:function(){var a=Ext.getCmp("component:mainpanel"),b=this.getEl().getXY(),c=a.getTabList(),e=[];b[0]-=183;b[1]+=28;for(var f=0;f<c.length;f++)c[f]===a.getActiveTab()?e.push({xtype:"menucheckitem",checked:!0,text:c[f].title,tabnum:f,listeners:{beforecheckchange:function(){g.destroy();return!1}}}):e.push({text:c[f].title,tabnum:f,handler:function(){a.setActiveTab(this.tabnum)}});var g=new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},
items:[{scope:this,text:Forte.Resources.Text.MAIN_DETAIL_CLOSE_INACTIVE_TABS,handler:function(){a.closeInactiveTabs()}},{scope:this,text:Forte.Resources.Text.MAIN_DETAIL_CLOSE_ALL_TABS,handler:function(){Message.MainPanel.CloseAllTabs.send()}},"-",e]});g.showAt(b)}}}]}],initComponent:function(){this.initKeybindHandlers();MessageHub.send(new Message.SetOnUnloadStatus(!0));var a=this;Ext.apply(this,{id:"component:mainpanel",cls:"mainpanel-"+window.LANG,split:!1,autoScroll:!1,activeTab:0,resizeTabs:!1,
plain:!0,margin:0,padding:0,tabBar:{cls:"cell-tab-bar-mainpanel"},defaults:{autoScroll:!0},listeners:{scope:this,resize:a.onResize,afterRender:function(){a.createLoadMask();Ext.create("Ext.Button",{id:"mainpanel-collapse-projectpanel",cls:"btn-collapse",tooltip:Forte.Resources.Text.MAIN_COLLAPSE_PROJECTPANEL_TOOLTIP,renderTo:a.getEl(),listeners:{click:function(){Ext.getCmp("component:projectpanel-wrap").toggleCollapse();Ext.getCmp("component:root").fireEvent("resize")}}}).show();Ext.create("Ext.Button",
{id:"mainpanel-collapse-inspector",cls:"btn-collapse",tooltip:Forte.Resources.Text.MAIN_COLLAPSE_INSPECTOR_TOOLTIP,renderTo:a.getEl(),listeners:{click:function(){Ext.getCmp("component:infopanel").toggleCollapse();Ext.getCmp("component:center").fireEvent("resize");Ext.getCmp("component:root").fireEvent("resize")}}}).show();Ext.create("Ext.Button",{id:"mainpanel-collapse-preview",cls:"btn-collapse",renderTo:a.getEl(),listeners:{click:function(){var a=Ext.getCmp("component:previewpanel");a.isHidden()?
(a.show(),a.isHiddenAttach=!1):(a.hide(),a.isHiddenAttach=!0);Ext.getCmp("component:center").fireEvent("resize");Ext.getCmp("component:root").fireEvent("resize")}}}).show();Forte.API.ideMode===Forte.API.IDEMODE_BUILD?a.preTabList=null:(a.pushTabQueue("text",{filepath:"/www/index.html",mime:"text/html"}),Forte.API.hasReadmeMd&&a.pushTabQueue("text",{filepath:"/www/README.md",mime:"text/markdown"}),a.setActiveTab(0));if(a.preTabList)for(var b=0;b<a.preTabList.length;b++){var c=a.preTabList[b];switch(c[0]){case "constTab":"monaca:environment"==
c[1]?(c=new Forte.EnvironmentSettingControl,a.pushTabQueue("environment",{component:c.getSettingPanel(),tabId:"monaca:environment"})):"monaca:settings"==c[1]&&a.pushTabQueue("setting",{page:c[2]});break;case "text":0!=c[1].indexOf("/www/plugins/")&&a.pushTabQueue("text",{filepath:c[1],mime:c[3]});break;case "img":a.pushTabQueue("img",{filepath:c[1]})}}a.editorToolbar=Ext.widget("widgets.editortoolbar",{id:"mainpanel-toolbar",renderTo:a.getEl()});$('<div class="ide-iframemask ide-mainpanel-iframemask" />').appendTo(a.getEl().dom);
setInterval(function(){a.sendIDEStatus()},5E3)},tabchange:function(b,c){"undefined"===typeof c.mime||"text/markdown"===c.mime||!0===c.readOnly?(Message.PreviewPanel.forceCollapse.send(),Message.InfoPanel.forceCollapse.send(),(new Message.HeaderToolbar.DisableMenuItem(["menu-edit-replace","menu-edit-replace-all","menu-edit-commentize","menu-edit-decommentize"],!0)).send()):(Ext.getCmp("component:previewpanel").showPanel(),(new Message.HeaderToolbar.DisableMenuItem(["menu-edit-replace","menu-edit-replace-all",
"menu-edit-commentize","menu-edit-decommentize"],!1)).send());a.sendUpdatedEditorStateMessage({tabchange:!0})},remove:function(){var b=a.getTabBar();155*a.getTabList().length>b.getWidth()?b.addClass("manytabs"):b.removeCls("manytabs")}}});MessageHub.subscribe(Message.MainPanel.ActivateSettingTab,function(){a.setAutoScroll(!0)});MessageHub.subscribe(Message.MainPanel.DeactivateSettingTab,function(){a.setAutoScroll(!1)});MessageHub.subscribe(Message.MainPanel.ActivateEnvironmentTab,function(){a.setAutoScroll(!0)});
MessageHub.subscribe(Message.MainPanel.DeactivateEnvironmentTab,function(){a.setAutoScroll(!1)});MessageHub.subscribe(Message.MainPanel.FocusEditor,function(){a.activeTab.aceEditor.focus()});MessageHub.subscribe(Message.MainPanel.ReplaceActiveTab,function(){var b=a.activeTab.aceEditor,c=prompt(Forte.Resources.Text.WIDGETS_REPLACE_TITLE,b.getCopyText());if(c){var e=prompt(Forte.Resources.Text.WIDGETS_REPLACE_TITLE_2);e&&b.replace(e,{needle:c})}});MessageHub.subscribe(Message.MainPanel.ReplaceActiveTabAll,
function(){var b=a.activeTab.aceEditor,c=prompt(Forte.Resources.Text.WIDGETS_REPLACE_TITLE,b.getCopyText());if(c){var e=prompt(Forte.Resources.Text.WIDGETS_REPLACE_TITLE_2);e&&b.replaceAll(e,{needle:c})}});this.callParent();MessageHub.subscribe(Message.MainPanel.PopTabQueue,function(){a.creatingTab=!1;a.executeTabQueue()});MessageHub.subscribe(Message.MainPanel.OpenIFrameTab,function(b){a.pushTabQueue("iframe",{title:b.getTitle(),url:b.getUrl(),value:b.getValue(),reload:b.getReload()})});MessageHub.subscribe(Message.MainPanel.OpenEditorTab,
function(b){a.pushTabQueue("text",{filepath:b.getPath(),mime:b.getMime(),readOnly:!1,lineNum:b.getLineNum()})});MessageHub.subscribe(Message.MainPanel.OpenReadOnlyEditorTab,function(b){a.pushTabQueue("text",{filepath:b.getPath(),mime:b.getMime(),readOnly:!0})});MessageHub.subscribe(Message.MainPanel.OpenComponentTab,function(){});MessageHub.subscribe(Message.MainPanel.OpenEnvironmentTab,function(b){a.pushTabQueue("environment",{component:b.getComponent(),tabId:b.getTabId()})});MessageHub.subscribe(Message.MainPanel.OpenSettingTab,
function(b){a.pushTabQueue("setting",{page:b.getPage()})});MessageHub.subscribe(Message.MainPanel.RemoveTabByFilepath,function(b){a.closeTabFromFilepath(b.getFilepath()||a.activeTab.filepath)});MessageHub.subscribe(Message.MainPanel.RemoveTabById,function(b){a.closeTabById(b.getId())});MessageHub.subscribe(Message.MainPanel.CloseInactiveTabs,function(){a.closeInactiveTabs()});MessageHub.subscribe(Message.MainPanel.CloseAllTabs,function(){a.closeAllTabs()});MessageHub.subscribe(Message.MainPanel.ReOpenEditorTab,
function(b){a.reCreateTab(b.getOldFilepath(),b.getNewFilepath())});MessageHub.subscribe(Message.MainPanel.OpenHistoryTab,function(b){Forte.API.history(b.getPath(),function(c){0<c.snapshotHistories.length?a.createHistoryTab(b.getPath(),c):Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.HISTORY_NOTICE_NO_HISTORY)})});MessageHub.subscribe(Message.MainPanel.MoveTabLeft,function(){a.moveTabToLeft()});MessageHub.subscribe(Message.MainPanel.MoveTabRight,function(){a.moveTabToRight()});
MessageHub.subscribe(Message.MainPanel.Undo,function(){var b=a.getActiveTab();(b.filetype="text")&&b.undo()});MessageHub.subscribe(Message.MainPanel.Redo,function(){var b=a.getActiveTab();(b.filetype="text")&&b.redo()});MessageHub.subscribe(Message.MainPanel.SearchActiveTab,function(b){var c=a.getActiveTab();c.filetype="text";c.onSearch(b.getText(),b.getBackwards())});MessageHub.subscribe(Message.MainPanel.SearchActiveTabNext,function(){var b=a.getActiveTab();b.filetype="text";b.onSearchNext(Ext.getCmp("mainpanel-toolbar").getNeedle())});
MessageHub.subscribe(Message.MainPanel.SearchActiveTabPrev,function(){var b=a.getActiveTab();b.filetype="text";b.onSearchPrev(Ext.getCmp("mainpanel-toolbar").getNeedle())});MessageHub.subscribe(Message.MainPanel.Commentize,function(){var b=a.getActiveTab();(b.filetype="text")&&b.commentize()});MessageHub.subscribe(Message.MainPanel.Decommentize,function(){var b=a.getActiveTab();(b.filetype="text")&&b.decommentize()});MessageHub.subscribe(Message.MainPanel.SaveActiveEditorTab,function(){var b=a.getActiveTab();
b.filetype="text";b.onSaveFile()});MessageHub.subscribe(Message.MainPanel.SaveAllEditorTab,function(){a.onSaveFileAll()});MessageHub.subscribe(Message.UpdateEnvironmentSettings,function(b){a.setEnvironmentSettings(b.getSettings())});MessageHub.subscribe(Message.MainPanel.CheckLayout,function(b){a.createLayoutCheckTab(b.getPath())})},createLoadMask:function(){var a=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#000",className:"spinner spinner-setting-load"})).spin();Forte.MainPanel.LoadMask=
new Ext.LoadMask(this.el.dom,{msg:a.el.outerHTML})},setEnvironmentSettings:function(a){this.environmentSettings=a?a:{fontsize:"",fontname:"",shiftwidth:4,softwrap:!1,keybind:"ace",theme:"default",printmargin:80,showIndentGuide:!0,showPrintMargin:!0,showSpecialChar:!1,softtabs:!0,preserve_newlines:!1,max_preserve_newlines:0,html_indent_scripts:"normal",js_space_in_paren:!1,js_brace_style:"expand",js_break_chained_methods:!0,js_space_before_conditional:!0,js_wrap_line_length:0}},initKeybindHandlers:function(){this.keybindHandlers.emacs=
require("ace/keyboard/emacs").handler;this.keybindHandlers.vim=require("ace/keyboard/vim").handler;var a=require("ace/keyboard/monaca_default").handler;this.keybindHandlers["default"]=new a(null,"win")},sendUpdatedEditorStateMessage:function(a){var b=!1,c=!1,e=!1,a=a||{};for(p in a)switch(p){case "isSaving":c=!0;break;case "tabchange":e=!0}this.items.findBy(function(a){if(a.edited)return b=!0});var f=a=!1,g=!1,h="none",j="",k=980;self.currentTabFileName="";var m=this.getActiveTab();if(m){var f=!!m.edited,
n=m.aceEditor;n&&(g=n.getSession().getUndoManager().hasRedo());"text"==m.filetype&&(a=!0,m.viewportWidth&&(k=m.viewportWidth));e?m.isHTML?(h="show",j=m.filepath):h="hide":c&&(h="update")}this.savingAll&&(c=!1);this.savingAll&&!b&&(this.savingAll=!1);(new Message.UpdateEditorState({isSaving:c,isSavingAll:this.savingAll,anyTabIsUnsaved:b,activeTabIsUnsaved:f,activeTabHasRedo:g,isAceTab:a,updatePreviewPanel:h,activeTabFilePath:j,viewportWidth:k})).send();0>=this.getTabList()?Ext.getCmp("mainpanel-menu").setDisabled(!0):
Ext.getCmp("mainpanel-menu").setDisabled(!1)},sendIDEStatus:function(){if("function"==typeof this.getTabList&&Forte.API.ideMode!==Forte.API.IDEMODE_BUILD){var a=this.getTabList(),b=[];activeTabIndex=null;null!=this.getActiveTab()&&(activeTabIndex=this.getTabIndex(this.getActiveTab().id)+1);for(var c=0;c<a.length;c++){var e=a[c];if(!e.isHistory)if(e.url)b.push(["iframe",e.title,e.url,e.value]);else if("text"==e.filetype){var f=e.getCurpoint();b.push(["text",e.filepath,f,e.mime]);this.fileCursorList[e.filepath]=
f}}MessageHub.send(new Message.SendIDEStatus("tabList",b));MessageHub.send(new Message.SendIDEStatus("activeTab",activeTabIndex));MessageHub.send(new Message.SendIDEStatus("fileCursorList",this.fileCursorList))}},pushTabQueue:function(a,b){this.tabQueue.push({type:a,argument:b});this.executeTabQueue()},executeTabQueue:function(){if(this.environmentSettings){if(0<this.tabQueue.length){var a=this.tabQueue.shift(),b=a.argument;this.creatingTab=!0;if("text"==a.type)switch(b.mime){case "text/markdown":this.createTabMarkdown(b.filepath,
b.mime);break;default:this.createTabText(b.filepath,b.mime,b.readOnly?!0:!1,b.lineNum)}else"iframe"==a.type?this.createTabIframe(b.title,b.url,b.value,b.reload,b.options):"environment"==a.type?this.createTabEnvironment(b.component,b.tabId):"setting"!=a.type&&"angular"==a.type&&this.createTabAngular(b.templateUrl,b.controller,b);a=this.getTabBar();135*this.getTabList().length>a.getWidth()-42?a.addClass("manytabs"):a.removeCls("manytabs")}this.isCurrentTabEditable()||Ext.getCmp("component:previewpanel").hide()}else setTimeout(function(){Message.MainPanel.PopTabQueue.send()},
1E3)},reCreateTab:function(a,b){var c=Ext.getCmp("editor:"+a);void 0!=c&&(this.remove(c),this.pushTabQueue(getFileType(getFileName(b)),{filepath:b,mime:c.mime}),this.sendUpdatedEditorStateMessage())},openTabSettings:function(){this.pushTabQueue("angular",{readOnly:!0,title:Forte.Resources.Text.HEADER_BUTTON_CONFIG,templateUrl:"setting/index.html"})},openTabBuildHistory:function(){this.pushTabQueue("angular",{title:Forte.Resources.Text.HEADER_BUTTON_BUILD_HISTORY,templateUrl:"build/BuildHistory.html",
"class":"buildhistory",execBeforeClose:!0,controllerTag:{"class":"forte-tab-buildhistory"}})},openTabCiHistory:function(){this.pushTabQueue("angular",{title:Forte.Resources.Text.HEADER_BUTTON_CI_HISTORY,templateUrl:"build/CIHistory.html","class":"ci-history",execBeforeClose:!0,controllerTag:{"class":"ci-history"}})},openTabVcsCommitHistory:function(){this.pushTabQueue("angular",{title:Forte.Resources.Text.HEADER_BUTTON_VCS_COMMIT_HISTORY,templateUrl:"vcs/VcsCommitHistory.html","class":"vcsCommitHistory"})},
openTabServicesApp:function(a){this.pushTabQueue("iframe",{title:"Build",url:a,value:{},reload:!1})},createTabText:function(a,b,c,e){var f=this,g=Ext.getCmp("editor:"+a);if(void 0!=g)f.setActiveTab(g.id),void 0!==e&&g.aceEditor.gotoLine(e),Message.MainPanel.PopTabQueue.send();else{var g=!1,h={row:0,column:0};void 0!=f.fileCursorList[a]&&(h=f.fileCursorList[a]);void 0!==e&&(h.row=e-1,h.column=0);switch(b){case "text/html":g=!0}a=Ext.create("Forte.AceEditor",{mainPanel:f,filepath:a,filetype:"text",
mime:b,isHTML:g,curpoint:h,readOnly:c});b=f.add(a);b.on("removed",function(){f.sendIDEStatus()});f.setContextMenu(b);f.setActiveTab(b);b.disable(!0);a.createAceEditor();a.loadmask.show();a.setCloseAction(b)}},createTabMarkdown:function(a,b){var c=Ext.getCmp("editor:"+a);if(void 0!=c)this.setActiveTab(c.id),Message.MainPanel.PopTabQueue.send();else{c={row:0,column:0};void 0==this.fileCursorList[a]&&(c=this.fileCursorList[a]);var c=Ext.create("Forte.MarkdownEditor",{mainPanel:this,filepath:a,filetype:"text",
isHTML:!1,mime:b,curpoint:c}),e=this.add(c);this.setContextMenu(e);this.setActiveTab(e);e.disable(!0);c.createMdPanel();c.createAceEditor();c.loadmask.show();c.setCloseAction(e)}},createCloudUserTab:function(a){void 0!=Ext.getCmp("cloud:user")?(this.setActiveTab("cloud:user"),Message.MainPanel.PopTabQueue.send()):(a=Ext.create("Forte.CloudUserPanel",{mainPanel:this,columns:a?a.display:null,tabConfig:{tooltip:Forte.Resources.Text.MAIN_CLOUD_USER_TITLE}}),a=this.add(a),this.setContextMenu(a),this.setActiveTab(a))},
createCloudCollectionTab:function(a,b){var c="cloud:collection-"+a;void 0!=Ext.getCmp(c)?(this.setActiveTab(c),Message.MainPanel.PopTabQueue.send()):(c=Ext.create("Forte.CloudCollectionPanel",{mainPanel:this,colName:a,columns:b?b.display:null,tabConfig:{tooltip:a}}),c=this.add(c),this.setContextMenu(c),this.setActiveTab(c))},createCloudPushHistoryTab:function(){if(void 0!=Ext.getCmp("cloud:pushhistory"))this.setActiveTab("cloud:pushhistory"),Message.MainPanel.PopTabQueue.send();else{var a=Ext.create("Forte.CloudPushHistoryPanel",
{mainPanel:this,tabConfig:{tooltip:Forte.Resources.Text.PUSH_APP_HISTORY}}),a=this.add(a);this.setContextMenu(a);this.setActiveTab(a)}},createCloudMailTemplateTab:function(){if(void 0!=Ext.getCmp("cloud:mailtemplate"))this.setActiveTab("cloud:mailtemplate"),Message.MainPanel.PopTabQueue.send();else{var a=Ext.create("Forte.CloudMailTemplatePanel",{mainPanel:this,tabConfig:{tooltip:Forte.Resources.Text.MAIN_CLOUD_MAILTMPL_TITLE}}),a=this.add(a);this.setContextMenu(a);this.setActiveTab(a)}},createHistoryTab:function(a,
b){var c=this,e="history:"+a;if(void 0!=Ext.getCmp(e))c.setActiveTab(e),Message.MainPanel.PopTabQueue.send();else{var f=b.snapshotHistories,g=f[0];f.forEach(function(a){var b=new Date(1E3*a.timestamp),c=b.getHours(),e=b.getMinutes();10>c&&(c="0"+c);10>e&&(e="0"+e);a.text=b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate()+" "+c+":"+e+" ("+a.author+")"});var h;h="image"!=b.content?c.createTextFileView(g,b.mime,getExtName(a)):c.createImageFileView(g);var j="["+Ext.htmlEncode(getFileName(a))+"]",f=
{id:e,xtype:"panel",mainPanel:c,isHistory:!0,title:j,bodyStyle:"border-top:none;border-bottom:none;",closable:!0,cls:"ide-history-panel",iconCls:"ide-pages-panel-"+Ext.getCmp("component:projectpanel").getFileIcon(a),floatParent:!0,layout:"fit",dockedItems:[{xtype:"panel",dock:"top",height:30,layout:"hbox",items:[{xtype:"component",cls:"ide-history-desc",html:"<span>"+Forte.Resources.Text.HISTORY_HEADER(Ext.htmlEncode(a))+"</span>",flex:1},{xtype:"cell.combobox",cls:"ide-history-file-combo",id:e+"FileCombo",
store:{xtype:"store",fields:["text","snapshot_path"],data:f},width:220,editable:!1,queryMode:"local",text:g.text,value:g.snapshot_path,displayField:"text",valueField:"snapshot_path",listConfig:{minWidth:260},listeners:{select:function(a,b){Ext.getCmp(h.id).changeFile(b[0].data.snapshot_path)}}},{xtype:"cell.button",ui:"mini",text:Forte.Resources.Text.HISTORY_REVERT,width:140,height:21,style:"margin-left: 10px; margin-right: 15px;",handler:function(){var f=Ext.getCmp(e+"FileCombo").getValue();null!=
f&&confirm(Forte.Resources.Text.HISTORY_REVERT_CONFIRM)&&Forte.API.save(a,"",function(){"image"!=b.content&&(Ext.getCmp("editor:"+a)?MessageHub.send(new Message.MainPanel.ReOpenEditorTab(a,a)):MessageHub.send(new Message.MainPanel.OpenEditorTab({filepath:a,mime:b.mime})));Message.ProjectPanel.UpdateProject.send();c.remove(Ext.getCmp(e))},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},f)}}]},{xtype:"panel",dock:"bottom",height:8,bodyStyle:"background: none transparent !important;border-bottom:none;",
html:""}],items:[h]},f=c.add(f);c.setContextMenu(f);c.setActiveTab(f)}},setContextMenu:function(a){var b;b=a.title===Forte.Resources.Text.SETTING_TITLE?"monaca:settings":a.filepath;$(a.tab.getEl().dom).on("contextmenu",function(c){c.preventDefault();if(Forte.API.ideMode!==Forte.API.IDEMODE_BUILD){var e=Ext.getCmp("component:mainpanel");(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},items:[{scope:this,text:Forte.Resources.Text.MAIN_DETAIL_CLOSE_THIS_TAB,handler:function(){(new Message.MainPanel.RemoveTabByFilepath(b)).send()}},
{scope:this,text:Forte.Resources.Text.MAIN_DETAIL_CLOSE_OTHER_TABS,handler:function(){e.setActiveTab(a);Message.MainPanel.CloseInactiveTabs.send()}},{scope:this,text:Forte.Resources.Text.MAIN_DETAIL_CLOSE_ALL_TABS,handler:function(){Message.MainPanel.CloseAllTabs.send()}}]})).showAt(c.clientX,c.clientY)}});$(a.tab.getEl().dom).on("mousedown",function(a){1===a.button&&(a.preventDefault(),(new Message.MainPanel.RemoveTabByFilepath(b)).send())})},createTextFileView:function(a,b,c){return{xtype:"panel",
id:"FileView"+(new Date).getTime(),cls:"ide-history-body",html:'<div class="ide-history-file-view" style="width: 100%; height: 100%;"></div>',bodyStyle:"border-bottom:none;",aceEditor:null,loadmask:null,changeFile:function(a){var b=this;b.loadmask.show();Forte.API.read(a,function(a){b.aceEditor.getSession().setValue(a.content);b.aceEditor.resize();b.loadmask.hide()})},listeners:{afterRender:function(){var e=Ext.getCmp("component:mainpanel"),f=$("#"+this.id+" .ide-history-file-view").get(0);this.loadmask=
new Ext.LoadMask(this,{msg:'<img src="/img/loading-icon.gif" /><br />Loading...'});this.aceEditor=ace.edit(f);this.aceEditor.setTheme("ace/theme/eclipse");this.aceEditor.setReadOnly(!0);var g=this.aceEditor.getSession();e.environmentSettings&&("default"!==e.environmentSettings.fontname&&$(f).css({fontFamily:'"'+e.environmentSettings.fontname+'"'}),$(".ace_line",f).css("font-family","Osaka"),$(f).css("font-size",""+e.environmentSettings.fontsize+"px"),g.setTabSize(e.environmentSettings.shiftwidth),
this.aceEditor.setTheme("ace/theme/"+("default"===e.environmentSettings.theme?"eclipse":e.environmentSettings.theme)),this.aceEditor.setShowPrintMargin(e.environmentSettings.showPrintMargin),this.aceEditor.setPrintMarginColumn(e.environmentSettings.printMargin),this.aceEditor.setShowInvisibles(e.environmentSettings.showSpecialChar),this.aceEditor.setDisplayIndentGuides(e.environmentSettings.showIndentGuide),g.setUseSoftTabs(e.environmentSettings.softtabs));g.setUseWrapMode(!0);g.setUseWorker(!1);
e=getAceSyntaxMode(b,c);null!=e&&g.setMode(new e);this.changeFile(a.snapshot_path)},resize:function(){this.aceEditor.resize()}}}},createImageFileView:function(a){return{xtype:"panel",id:"FileView"+(new Date).getTime(),cls:"ide-history-body",style:"text-align: center;",bodyStyle:"background: #272727;",items:[{xtype:"image",margin:10,alt:"preview",cls:"ide-history-image"}],changeFile:function(a){this.items.items[0].setSrc(Forte.API.getProjectFileUrl(a))},listeners:{afterRender:function(){this.changeFile(a.snapshot_path)}}}},
createTabSetting:function(a,b){"undefined"===typeof b&&(b=!0);var c=Ext.getCmp("monaca:settings");void 0!=c?(this.setActiveTab(c.id),c.setActivePanel(a),c.setActiveItem(a),Message.MainPanel.PopTabQueue.send()):(c=Ext.create("Forte.Setting",{id:"monaca:settings",defaultPage:a,nowPage:a,tabConfig:{tooltip:Forte.Resources.Text.SETTING_TITLE},mainPanel:this,closable:b}),c=this.add(c),c.disable(!0),this.setContextMenu(c),this.setActiveTab(c),c.enable(!0),c.setIconCls("ide-setting-panel-icon"))},createTabSettingCloud:function(a){var b=
Ext.getCmp("monaca:settingcloud");void 0!=b?(this.setActiveTab(b.id),b.setActivePanel(a),b.setActiveItem(a),Message.MainPanel.PopTabQueue.send()):(a=Ext.create("Forte.SettingCloud",{id:"monaca:settingcloud",defaultPage:a,nowPage:a,tabConfig:{tooltip:Forte.Resources.Text.CLOUD_SETTING_TITLE},mainPanel:this}),a=this.add(a),a.disable(!0),this.setContextMenu(a),this.setActiveTab(a),a.enable(!0),a.setIconCls("ide-setting-panel-icon"))},createTabEnvironment:function(a,b){this.tabDict[b]?this.setActiveTab(this.tabDict[b]):
(void 0==a.tabConfig&&""!=a.title&&(a.tabConfig={tooltip:a.title}),a=this.add(a),a.tab.addListener("beforeclose",function(){this.tabDict[b]=null},this,{single:!0}),this.tabDict[b]=a,this.setActiveTab(a),this.setContextMenu(a));Message.MainPanel.PopTabQueue.send();this.sendUpdatedEditorStateMessage()},createTabIframe:function(a,b,c,e,f){var g=Ext.getCmp("iframe:"+b);void 0!=g?(this.setActiveTab(g.id),e&&$("iframe.cell-iframe-tab-content",Ext.getDom(g.id))[0].contentWindow.location.reload(),Message.MainPanel.PopTabQueue.send()):
(e="iframe:"+b,c=c||{},0!==b.indexOf("http")&&-1==b.indexOf(Forte.API.ideHost)&&(b=Forte.API.ideHost+b),a=this.add(Ext.apply({id:e,xtype:"panel",title:a,tabConfig:{tooltip:a},value:c,closable:!0,iconCls:"ide-loading-icon2",layout:"fit",bodyStyle:"padding:0px 0px 0",html:'<iframe src="'+b+'" class="cell-iframe-tab-content" frameborder="0"></iframe>',url:b,mainPanel:this,listeners:{afterRender:function(){setIframeMaskHandler()}}},f)),a.disable(!0),this.setContextMenu(a),this.setActiveTab(a),Message.MainPanel.PopTabQueue.send(),
a.enable(!0),a.setIconCls("ide-editor-panel-iframe-icon"))},createTabAngular:function(a,b,c){b=Ext.getCmp("angular:"+a);if(void 0!==b)this.setActiveTab(b.id),Message.MainPanel.PopTabQueue.send();else{b=angular.element(document.body).injector();b.get("$uibModal");var e=b.get("$compile"),b=b.get("$templateCache"),f="angular:"+a,b=b.get(a);-1==a.indexOf(Forte.API.ideHost)&&(a=Forte.API.ideHost+a);var g=this.add(Ext.apply({id:f,xtype:"panel",title:c.title,tabConfig:{tooltip:c.title},closable:!0,iconCls:"ide-editor-panel-iframe-icon",
layout:"fit",html:b,mainPanel:this},c));this.setContextMenu(g);this.setActiveTab(g);Message.MainPanel.PopTabQueue.send();g.enable(!0);setTimeout(function(){var a=document.getElementById(f),b=angular.element(document.body).scope();e(angular.element(a).contents())(b);b.$apply();if(c&&c.execBeforeClose&&c.controllerTag){var k=null;c.controllerTag.class?k=document.getElementsByClassName(c.controllerTag.class)[0]:c.controllerTag.id&&(k=document.getElementById(c.controllerTag.id))}if(k){var m=angular.element(k).scope();
g.tab.addListener({beforeclose:{fn:function(a){a=a.complete;m.beforeClose();a&&a()}}})}})}},createLayoutCheckTab:function(a){var b=Ext.getCmp("layout:"+a);void 0!=b?(this.setActiveTab(b.id),Message.MainPanel.PopTabQueue.send()):(a=Ext.create("Forte.LayoutChecker",{filepath:a}),a=this.add(a),a.disable(!0),this.setActiveTab(a),Message.MainPanel.PopTabQueue.send(),a.enable(!0),a.setIconCls("ide-editor-panel-layout-icon"))},closeTabFromFilepath:function(a){"monaca:settings"===a?(this.remove(Ext.getCmp("monaca:settings")),
this.sendUpdatedEditorStateMessage()):"monaca:environment"===a?(this.remove(Ext.getCmp("monaca:environment")),this.sendUpdatedEditorStateMessage()):(a=Ext.getCmp("editor:"+a),void 0!=a&&(a.tab.fireEvent("beforeclose"),this.sendUpdatedEditorStateMessage()))},closeTabById:function(a){a=Ext.getCmp(a);void 0!=a&&("undefined"!==typeof a.aceDiv?a.tab.fireEvent("beforeclose",{}):this.remove(a),this.sendUpdatedEditorStateMessage())},closeCloudTabs:function(){var a=this.getTabList();if(void 0!=a){for(var b=
a.length,c=0;c<b;c++)0!==a[c].id.indexOf("cloud:",0)&&"monaca:settingcloud"!==a[c].id||(this.remove(a[c]),c--,b--);this.sendUpdatedEditorStateMessage()}},closeInactiveTabs:function(){var a=this,b=a.getTabList();if(void 0!=b){for(var c=b.indexOf(a.getActiveTab()),e=b.length,f=0;f<e;f++)f!==c&&("undefined"!==typeof b[f].aceDiv?b[f].tab.fireEvent("beforeclose",{complete:function(b){b&&a.closeInactiveTabs()}}):(b[f].tab&&b[f].tab.fireEvent("beforeclose"),a.remove(b[f])),f--,e--,c--);this.sendUpdatedEditorStateMessage()}},
closeAllTabs:function(){var a=this,b=a.getTabList();if(void 0!=b){for(var c=b.length,e=0;e<c;e++)"undefined"!==typeof b[0].aceDiv?b[0].tab.fireEvent("beforeclose",{complete:function(){a.closeAllTabs()}}):(b[0].tab&&b[0].tab.fireEvent("beforeclose"),a.remove(b[0]));this.sendUpdatedEditorStateMessage()}},moveTabToRight:function(){var a=this.getActiveTab(),a=this.items.findIndex("id",a.id);a===this.items.length-1?this.setActiveTab(0):a<this.items.length-1&&this.setActiveTab(a+1)},moveTabToLeft:function(){var a=
this.getActiveTab(),a=this.items.findIndex("id",a.id);0===a?this.setActiveTab(this.items.length-1):0<a&&this.setActiveTab(a-1)},onResize:function(){for(var a=this.getTabList(),b=0;b<a.length;b++)if("text"==a[b].filetype)a[b].onResize();Ext.getCmp("component:root").fireEvent("resize")},onSaveFileAll:function(){this.savingAll=!0;for(var a=this.getTabList(),b=0,c=0;c<a.length;c++)a[c].edited&&b++;for(var e=0,c=0;c<a.length;c++)a[c].edited&&(e++,a[c].onSaveFile(!1,b==e));this.sendUpdatedEditorStateMessage()},
isDirty:function(){for(var a=this.getTabList(),b=0;b<a.length;b++)if(a[b].edited)return!0;return!1},getTabList:function(){return Ext.getCmp("component:mainpanel").items.items},getActiveTab:function(){var a=null;this.getTabList().forEach(function(b){b.hidden||(a=b)});return a},isCurrentTabEditable:function(){var a=this.getActiveTab();return"undefined"!==typeof a.mime&&"text/markdown"!==a.mime&&!0!==a.readOnly},getTabIndex:function(a){for(var b=Ext.getCmp("component:mainpanel").items.items,c=0;c<b.length;c++)if(b[c].id==
a)return c;return-1}})})();(function(){Range=require("ace/range").Range;Ext.define("Forte.AceEditor",{extend:"Ext.panel.Panel",alias:"widget.aceeditor",aceEditor:null,mainPanel:null,filepath:null,filename:null,filetype:null,mime:null,extname:null,curpoint:null,edited:!1,aceDiv:null,lastSearchWord:"",readOnly:!1,optBeautify:{},initComponent:function(){var a=this;a.loadmask=new Ext.LoadMask(a,{msg:'<img src="/img/loading-icon.gif" /><br />Loading...'});a.aceDiv=a.filepath+"_ace";a.extname=Ext.htmlEncode(getExtName(a.filepath));
a.filename=Ext.htmlEncode(getFileName(a.filepath));Ext.apply(this,{id:"editor:"+a.filepath,title:a.filename,tabConfig:{tooltip:Ext.htmlEncode(a.filepath)},closable:!0,iconCls:"ide-loading-icon2",floatParent:!0,layout:"fit",bodyStyle:"padding:0px 0px 0",html:'<div id="'+a.aceDiv+'" style="width:100%; height:100%; position: absolute; display : inline; background-color:#FFF;"></div>',listeners:{activate:function(){Ext.getCmp("component:mainpanel").editorToolbar.show();a.aceEditor&&a.aceEditor.focus()},
deactivate:function(){Ext.getCmp("component:mainpanel").editorToolbar.hide()},destroy:function(){var a=Ext.getCmp("component:mainpanel");null===a.activeTab&&a.editorToolbar.hide()}}});this.callParent()},createAceEditor:function(){var a=this;require("ace/ace plugins/esprima/esprimaJsContentAssist plugins/esprima/indexerService monaca/autocomplete/monaca-types monaca/autocomplete/cssContentAssist orion/editor/htmlContentAssist monaca/autocomplete/htmlAttributeAssist monaca/editor".split(" "),function(b,
c,e,f,g,h,j){e=e.Indexer;a.providers={js:{name:"js",provider:new c.EsprimaJavaScriptContentAssistProvider(new e)},css:{name:"css",provider:new g.CssContentAssistProvider(new e)},html:{name:"html",provider:new h.HTMLContentAssistProvider},"html-attr":{name:"html-attr",provider:new j.HTMLAttributeAssistProvider}};require("ace/lib/useragent").getOS();a.aceEditor=b.edit(Ext.getDom(a.aceDiv));a.aceEditor.setTheme("ace/theme/eclipse");a.aceEditor.setReadOnly(a.readOnly);b=a.mainPanel.environmentSettings.keybind;
a.enableAutoComplete=b=="default";a.aceEditor.keyBinding.setKeyboardHandler(a.mainPanel.keybindHandlers[b]);a.setShortcutKey();a.setEventHandler();a.setSyntaxMode();a.configureEditor();a.fetchContents()})},fetchContents:function(){var a=this;Forte.API.read(a.filepath,function(b){a.callbackReadAPI(b)},function(b,c){var e=Ext.getCmp("component:root").getIDEStatus();if(e&&e.tabList.length){for(var f=[],g=0;g<e.tabList.length;g++)f.push(e.tabList[g][1]);if(inArray(a.filepath,f)){a.mainPanel.remove(a);
Message.ProjectPanel.UpdateProject.send();Message.MainPanel.PopTabQueue.send();return}}a.onFetchContentsFail(b,c)})},onFetchContentsFail:function(a){switch(a){case 404:a=Forte.Resources.Text.ERROR_OPEN_FILE_ERROR_NOTFOUND;break;default:a=Forte.Resources.Text.ERROR_OPEN_FILE_ERROR}Cell.LightMessageBox.show({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:a,buttons:Cell.LightMessageBox.OK});this.mainPanel.remove(this);Message.ProjectPanel.UpdateProject.send();Message.MainPanel.PopTabQueue.send()},
undo:function(){this.aceEditor.session.getUndoManager().undo()},redo:function(){this.aceEditor.session.getUndoManager().redo()},commentize:function(){var a=this.aceEditor;extname=this.extname.toLowerCase();var b=a.getSelectionRange(),c=a.session;switch(this.mime){case "text/html":case "text/xml":var e=c.getState(b.start.row),f=c.getState(b.end.row);e.match("^js")&&f.match("^js")?this.commentEachRow("//",a):e.match("^js")&&f.match("^start")?this.commentEachRow("//",a):e.match("^start|comment")&&f.match("^start|comment")&&
this.commentRange("<\!--","--\>",a);break;case "text/javascript":this.commentEachRow("//",a);break;default:this.commentRange("/*","*/",a)}c.selection.setSelectionRange(new Range(b.start.row,0,b.end.row,c.getLine(b.end.row).length))},decommentize:function(){var a=this.aceEditor;extname=this.extname.toLowerCase();var b=a.getSelectionRange(),c=a.session;switch(this.mime){case "text/html":case "text/xml":var e=c.getState(b.start.row),f=c.getState(b.end.row);e.match("^js")&&f.match("^js")?this.decommentEachRow("//",
a):e.match("^js")&&f.match("^start")?this.decommentEachRow("//",a):e.match("^start|^comment")&&f.match("^start|^comment")&&this.decommentRange("<\!--","--\>",a);break;case "text/javascript":this.decommentEachRow("//",a);break;default:this.decommentRange("/*","*/",a)}c.selection.setSelectionRange(new Range(b.start.row,0,b.end.row,c.getLine(b.end.row).length))},setShortcutKey:function(){var a=this,b=[{name:"find",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){Message.HeaderToolbar.FocusSearchBox.send()}},
{name:"savefile",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:function(){a.onSaveFile()}},{name:"replace",bindKey:{win:"Ctrl-R",mac:"Command-Option-R"},exec:function(){Message.MainPanel.ReplaceActiveTab.send()}},{name:"replaceall",bindKey:{win:"Ctrl-Shift-R",mac:"Command-Shift-Option-R"},exec:function(){Message.MainPanel.ReplaceActiveTabAll.send()}},{name:"commentize",bindKey:{win:"Ctrl-K",mac:"Command-K"},exec:function(){a.commentize()}},{name:"decommentize",bindKey:{win:"Ctrl-U",mac:"Command-U"},
exec:function(){a.decommentize()}},{name:"movetableft",bindKey:{win:"Ctrl-[",mac:"Command-["},exec:function(){Message.MainPanel.MoveTabLeft.send()}},{name:"movetabright",bindKey:{win:"Ctrl-]",mac:"Command-]"},exec:function(){Message.MainPanel.MoveTabRight.send()}},{name:"format",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:function(){a.formatCode(a.aceEditor,a.extname,a.optBeautify)}},{name:"fontsizebigger",bindKey:{win:"Ctrl-.",mac:"Command-."},exec:function(){a.mainPanel.environmentSettings.fontsize++;
a.setGutterFontsize(a,a.mainPanel.environmentSettings.fontsize)}},{name:"fontsizesmaller",bindKey:{win:"Ctrl-,",mac:"Command-,"},exec:function(){a.mainPanel.environmentSettings.fontsize--;a.setGutterFontsize(a,a.mainPanel.environmentSettings.fontsize)}}];for(i=0;i<b.length;i++)a.aceEditor.commands.addCommand(b[i])},setGutterFontsize:function(a,b){var c=Ext.getDom(a.aceDiv);$(c).css("font-size",""+b+"px");var e=12>=b?"lte12":14>=b?"lte14":17>=b?"lte17":21>=b?"lte21":25>=b?"lte25":29>=b?"lte29":35>=
b?"lte35":"lg";$(c).removeClass("font-size-lte12 font-size-lte14 font-size-lte17 font-size-lte21 font-size-lte25 font-size-lte29 font-size-lte35 font-size-lg");$(c).addClass("font-size-"+e)},formatCode:function(a,b,c){var e=a.getSelectionRange();if(!e.isEmpty()){e.setStart(e.start.row,0);var f=a.session.getTextRange(e);if(0!==f.length){switch(getMime(b)){case "text/html":b=a.session.getState(e.start.row);f=0===b.indexOf("js-")?js_beautify(f,c):0===b.indexOf("css-")?css_beautify(f,c):html_beautify(f,
c);break;case "text/javascript":f=js_beautify(f,c);break;case "text/css":f=css_beautify(f,c)}a.session.replace(e,f)}}},commentEachRow:function(a,b){for(var c=b.getSelectionRange(),e=b.getSession(),f=c.start.row;f<=c.end.row;f++)e.insert({row:f,column:0},a)},decommentEachRow:function(a,b){for(var c=b.getSelectionRange(),e=b.getSession(),f=c.start.row;f<=c.end.row;f++){var g=e.getLine(f);g.match("^s*"+a)&&(g=g.indexOf(a),e.remove(new Range(f,g,f,g+a.length)))}},commentRange:function(a,b,c){var e=c.getSelectionRange(),
c=c.getSession();c.insert({row:e.start.row,column:c.getLine(e.start.row).search("[^ \t]+")},a);c.insert({row:e.end.row,column:c.getLine(e.end.row).search("$")},b)},decommentRange:function(a,b,c){for(var e=c.getSelectionRange(),c=c.getSession(),f=e.start.row;f<=e.end.row;f++){var g=c.getLine(f);g.match("^[ \t]*"+a.replace("*","\\*"))&&(g=g.indexOf(a),c.remove(new Range(f,g,f,g+a.length)));g=c.getLine(f);g.match(b.replace("*","\\*")+"([ \t]*)$")&&(g=g.lastIndexOf(b),c.remove(new Range(f,g,f,g+b.length)))}},
setEventHandler:function(){var a=this;a.aceEditor.getSession().on("change",function(b){a.onChangeFile(b)})},setSyntaxMode:function(){var a=null,b=!1,a=getAceSyntaxMode(this.mime,this.extname);"text/css"==this.mime&&(b=!0);if(a){var c=this.aceEditor.getSession();c.setMode(new a);c.setUseWorker(!b);if(!b)c.on("changeAnnotation",function(){for(var a=c.getAnnotations(),b=!1,g=a.length-1;0<=g;g--)"warning"==a[g].type&&(a.splice(g,1),b=!0);b&&c.setAnnotations(a)})}},setTheme:function(a){this.aceEditor.setTheme("ace/theme/"+
("default"===a?"eclipse":a))},setAutoCompleteMode:function(a,b){var c=this;if(c.enableAutoComplete){var e={},f=256E3<b.length;switch(a){case "js":case "JS":f||(e={"*":c.providers.js});break;case "css":case "CSS":e={"*":c.providers.css};break;case "html":case "HTML":e={"css-":c.providers.css,"js-":c.providers.js,"html-attr":c.providers["html-attr"],"*":c.providers.html}}var f=require("ace/autocomplete/monaca").AutoCompleteManager,g=c.aceEditor.keyBinding.getKeyboardHandler();c.aceEditor.autocomplete=
new f(c.aceEditor,e,{enableAutoCloseTag:this.mainPanel.environmentSettings.enableAutoCloseTag});c.aceEditor.autocomplete.addEventListener("ac_close",function(){g.onACClose()});c.aceEditor.autocomplete.addEventListener("ac_show",function(){g.onACShow()});MessageHub.subscribe(Message.UpdateEditorState,function(a){("show"==a.updatePreviewPanel()||"hide"==a.updatePreviewPanel())&&c.aceEditor.autocomplete.close()})}},getContent:function(){return this.aceEditor?this.aceEditor.getSession().getValue():""},
setSearchFunction:function(){},setCloseAction:function(a){var b=this;a.tab.addListener({beforeclose:{fn:function(c){var e=c.complete,f=c.canceled;if(b.edited)return Cell.LightMessageBox.show({title:Ext.htmlEncode(b.filepath),msg:Forte.Resources.Text.EDITOR_CLOSE_CONFIRM_SAVE_TEXT,buttons:Cell.LightMessageBox.YESNOCANCEL,fn:function(c){switch(c){case "yes":b.onSaveFile(!0,null,e);break;case "no":b.mainPanel.remove(a);b.mainPanel.sendUpdatedEditorStateMessage();e&&e(!0);break;case "cancel":f&&f()}},
scope:this}),b.mainPanel.sendUpdatedEditorStateMessage(),!1;b.mainPanel.remove(a);b.mainPanel.sendUpdatedEditorStateMessage();e&&e(!1)},scope:this}})},configureEditor:function(a,b){var a=this.aceEditor,b=Ext.getDom(this.aceDiv),c=a.getSession();if(this.mainPanel.environmentSettings){if(this.mainPanel.environmentSettings.disableAutoQuot){var e=c.getMode().$behaviour;null!=e&&(e.remove("string_dquotes"),e.remove("parens"),e.remove("brackets"),e.remove("braces"))}"default"!==this.mainPanel.environmentSettings.fontname&&
$(b).css({fontFamily:'"'+this.mainPanel.environmentSettings.fontname+'"'});$(".ace_line",b).css("font-family","Osaka");this.setGutterFontsize(this,this.mainPanel.environmentSettings.fontsize);c.setTabSize(this.mainPanel.environmentSettings.shiftwidth);this.aceEditor.setTheme("ace/theme/"+("default"===this.mainPanel.environmentSettings.theme?"eclipse":this.mainPanel.environmentSettings.theme));this.aceEditor.setShowPrintMargin(this.mainPanel.environmentSettings.showPrintMargin);this.aceEditor.setPrintMarginColumn(this.mainPanel.environmentSettings.printMargin);
this.aceEditor.setShowInvisibles(this.mainPanel.environmentSettings.showSpecialChar);this.aceEditor.setDisplayIndentGuides(this.mainPanel.environmentSettings.showIndentGuide);this.aceEditor.getSession().setUseSoftTabs(this.mainPanel.environmentSettings.softtabs);this.mainPanel.environmentSettings.softtabs?(this.optBeautify.indent_char=" ",this.optBeautify.indent_size=this.mainPanel.environmentSettings.shiftwidth):(this.optBeautify.indent_char="\t",this.optBeautify.indent_size=1);this.optBeautify.preserve_newlines=
this.mainPanel.environmentSettings.preserve_newlines;this.optBeautify.max_preserve_newlines=this.mainPanel.environmentSettings.max_preserve_newlines;this.optBeautify.indent_scripts=this.mainPanel.environmentSettings.html_indent_scripts;this.optBeautify.space_in_paren=this.mainPanel.environmentSettings.js_space_in_paren;this.optBeautify.brace_style=this.mainPanel.environmentSettings.js_brace_style;this.optBeautify.break_chained_methods=this.mainPanel.environmentSettings.js_break_chained_methods;this.optBeautify.space_before_conditional=
this.mainPanel.environmentSettings.js_space_before_conditional;this.optBeautify.wrap_line_length=this.mainPanel.environmentSettings.js_wrap_line_length}},resetChangeState:function(){try{this.undoCounter=this.aceEditor.getSession().getUndoManager().$undoStack.length}catch(a){this.undoCounter=0}},onSaveFile:function(a,b,c){var e=this,a=a||!1;if(e.edited&&!e.readOnly){var f=e.getContent();e.mainPanel.sendUpdatedEditorStateMessage({isSaving:!0});Forte.API.save(e.filepath,f,function(b){e.edited=!1;e.aceEditor.originalMD5hash=
getMD5HashFromText(f);e.setTitle(e.filename);e.resetChangeState();e.afterSaveFile(b);a&&(e.mainPanel.remove(e),c&&c(!0));e.mainPanel.sendUpdatedEditorStateMessage()},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b);e.mainPanel.sendUpdatedEditorStateMessage()})}},afterSaveFile:function(a){switch(this.extname){case "ts":this.handleTypeScriptBuildResult(a)}},handleTypeScriptBuildResult:function(a){if(a.result.parseError){var b=a.result.parseResult.error,c=[],
e;for(e in b)c.push({row:b[e].lineno-1,text:b[e].message,type:"error"});this.aceEditor.session.setAnnotations(c)}else{this.aceEditor.session.clearAnnotations();var f=this.filepath.replace(/ts$/,"js");Forte.API.read(f,function(a){if(null!=a.content){var b=Ext.getCmp("editor:"+f);b&&b.aceEditor.getSession().setValue(a.content)}})}a.result.reload&&Message.ProjectPanel.UpdateProject.send()},callbackReadAPI:function(a){this.edited=!1;if(null!=a.content){this.aceEditor.getSession().setValue(a.content);
this.curpoint?this.curpoint.row&&this.curpoint.column?this.aceEditor.gotoLine(this.curpoint.row+1,this.curpoint.column,!0):this.curpoint.row&&this.aceEditor.gotoLine(this.curpoint.row+1):this.aceEditor.navigateTo(0,0);this.aceEditor.originalMD5hash=getMD5HashFromText(a.content);this.enable(!0);Message.MainPanel.PopTabQueue.send();this.loadmask.hide();this.mainPanel.sendUpdatedEditorStateMessage({tabchange:!0});var b="";switch(this.mime){case "text/html":b="ide-editor-panel-pagehtml-icon";break;case "text/markdown":b=
"ide-editor-panel-pagemd-icon";break;case "text/javascript":b=this.extname.match(/json/i)?"ide-editor-panel-pagejson-icon":this.extname.match(/ui/i)?"ide-editor-panel-pageui-icon":"ide-editor-panel-pagejs-icon";break;case "text/css":b="ide-editor-panel-pagecss-icon";break;case "text/xml":b="ide-editor-panel-pagesystem-icon";break;case "text/objective-c":b=this.extname.match(/h/i)?"ide-editor-panel-pageobjective-c-header-icon":"ide-editor-panel-pageobjective-c-icon";break;case "text/java":b="ide-editor-panel-pagejava-icon";
break;default:b="ide-editor-panel-pagetxt-icon"}this.readOnly&&(b+=" ide-editor-panel-readonly");this.setIconCls(b);this.aceEditor.resize();this.setAutoCompleteMode(this.extname,a.content);this.resetChangeState()}else Cell.LightMessageBox.show({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:Forte.Resources.Text.ERROR_OPEN_FILE_ERROR_EMPTY,buttons:Cell.LightMessageBox.OK}),this.mainPanel.remove(this),Message.MainPanel.PopTabQueue.send()},getCurpoint:function(){return this.aceEditor.getCursorPosition()},
isChanged:function(){try{var a=this.aceEditor.getSession().getUndoManager().$undoStack.length}catch(b){a=0}return this.undoCounter!=a},onChangeFile:function(){var a=this;a.disabled||setTimeout(function(){a.isChanged()?(a.setTitle("*"+a.filename),a.edited=!0):(a.setTitle(a.filename),a.edited=!1);a.mainPanel.sendUpdatedEditorStateMessage()},50,a)},onResize:function(){this.aceEditor&&this.aceEditor.resize()},onSearch:function(a,b){var c=!0;if(a)if(this.lastSearchWord==a)if(b)this.onSearchPrev(a);else this.onSearchNext(a);
else c=this.aceEditor.find(a),this.lastSearchWord=a,(new Message.HeaderToolbar.ChangeSearchBoxColor(c)).send();else(new Message.HeaderToolbar.ChangeSearchBoxColor(c)).send()},onSearchNext:function(a){this.aceEditor.findNext({needle:a})},onSearchPrev:function(a){this.aceEditor.findPrevious({needle:a})}})})();(function(){Ext.define("Forte.ProjectPanel",{extend:"Cell.tab.TabPanel",alias:"widget.projectpanel",ui:"dark",collapseWebdavPanel:!1,collapseProjectPanel:!1,projectPanelWidth:200,projectTreeStatus:{},initComponent:function(){var a=[Ext.create("Forte.PagesPanel",{region:"center",split:!0,title:'<img src="/img/new_ide/projectPanel/project_icon_active.png" />',projectTreeStatus:this.projectTreeStatus,tabConfig:{tooltip:Forte.Resources.Text.PAGES_TAB_TREE}}),Ext.create("Forte.GrepPanel",{region:"center",
title:'<img src="/img/new_ide/projectPanel/search_icon_active.png" />',tabConfig:{tooltip:Forte.Resources.Text.PAGES_TAB_GREP}}),Ext.create("Forte.CloudControlPanel",{region:"center",title:'<img src="/img/new_ide/projectPanel/ico_cloud_active.png" />',tabConfig:{tooltip:Forte.Resources.Text.PAGES_TAB_CLOUD}})];Ext.apply(this,{region:"west",layout:{type:"border",padding:"0"},width:this.projectPanelWidth,maxWidth:550,minWidth:100,split:!0,title:Forte.API.projectName,activeTab:0,resizeTabs:!1,collapsible:!0,
collapsed:this.collapseProjectPanel,collapseFirst:!1,collapseMode:"mini",header:!1,items:a});this.callParent()},sendIDEStatus:function(){MessageHub.send(new Message.SendIDEStatus("projectPanelWidth",this.getWidth()));MessageHub.send(new Message.SendIDEStatus("collapseProjectPanel",this.collapsed))}})})();Forte.ProjectPanel.PAGE_TREE=0;Forte.ProjectPanel.PAGE_GREP=1;Forte.ProjectPanel.PAGE_BACKEND=2;(function(){Ext.define("Forte.PagesPanel",{extend:"Cell.tree.DarkTreePanel",alias:"widget.pagespanel",mixins:{fileDroppable:"Cell.fileDroppable"},projectTreeStatus:{},currentDir:"/www/",wwwDir:null,selectedNode:null,isSelected:!1,dblClickTimer:[],isShowHidden:!1,isShowDeleted:!1,fileIcons:{},htmlFileList:{},initComponent:function(){var a=this;this.loadmask=new Ext.LoadMask(this,{msg:""});a.text="";a.dragoverText="";Ext.apply(this,{id:"component:projectpanel",iconCls:null,rootVisible:!1,store:this.createTreeStore(),
scroll:"auto",autoScroll:!0,split:!0,useArrows:!0,viewConfig:{plugins:{ptype:"treeviewdragdrop"}},tbar:[{type:"button",icon:"/img/new_ide/projectPanel/add_file_icon.png",id:"AddFileButton",tooltip:Forte.Resources.Text.PAGES_CONTEXTMENU_NEW,handler:function(){var a=Ext.getCmp("component:projectpanel");a.createNewFile(a.currentDir)}},{type:"button",icon:"/img/new_ide/projectPanel/add_folder_icon.png",id:"AddFolderButton",tooltip:Forte.Resources.Text.PAGES_CONTEXTMENU_NEWDIR,handler:function(){var a=
Ext.getCmp("component:projectpanel");a.createNewFolder(a.currentDir)}},{type:"button",icon:"/img/new_ide/projectPanel/upload_file_icon.png",id:"UploadFileButton",tooltip:Forte.Resources.Text.PAGES_CONTEXTMENU_UPLOAD,handler:function(){var a=Ext.getCmp("component:projectpanel");Forte.Widgets.UploadWindow.showWindow(a.currentDir,function(a){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOADED_FILE(a),type:"report"})).send()})}},"->",{type:"button",id:"DetailMenu",cls:"cell-btn-detail",
icon:"/img/new_ide/projectPanel/detail.png",tooltip:Forte.Resources.Text.PAGES_CONTEXTMENU_TITLE,handler:function(){var b=this.getEl().getXY();b[1]+=23;(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},items:[{text:Forte.Resources.Text.PAGES_CONTEXTMENU_REFRESH,icon:"/img/new_ide/projectPanel/project_tree_reload_icon.png",handler:function(){a.onCreateProjectTree()}},{xtype:"menuseparator"},{xtype:"menucheckitem",text:Forte.Resources.Text.PAGES_CONTEXTMENU_SHOW_DELETED,checked:a.isShowDeleted,
listeners:{checkchange:function(b,e){a.isShowDeleted=e;a.onCreateProjectTree()}}},{xtype:"menucheckitem",text:Forte.Resources.Text.PAGES_CONTEXTMENU_SHOW_HIDDEN,checked:a.isShowHidden,listeners:{checkchange:function(b,e){a.isShowHidden=e;a.onCreateProjectTree()}}}]})).showAt(b)}}],listeners:{scope:this,select:function(a,c){var e=getEditableFlags(c);this.selectedNode=c;this.isSelected=!1;this.uploadPath=this.currentDir=getFileDirectory(c.data.filepath);Ext.getCmp("AddFileButton").setDisabled(!e.canCreateFile);
Ext.getCmp("AddFolderButton").setDisabled(!e.canCreateDir);Ext.getCmp("UploadFileButton").setDisabled(!e.canUploadTo);MessageHub.send(new Message.Tree.SelectNode(c.data))},itemclick:function(b,c,e,f,g){this.isSelected&&this.dblClickTimer.push(setTimeout(a.onChangeNameInline,300,a,e));this.isSelected=!0;this.selectedNode=c;g.stopEvent()},itemdblclick:function(a,c,e,f,g){this.isSelected=!1;for(var h=0;h<this.dblClickTimer.length;h++)clearTimeout(this.dblClickTimer[h]);c.data.deleted?MessageHub.send(new Message.MainPanel.OpenHistoryTab({path:c.data.filepath,
mime:c.data.mime})):(this.onOpenFile(a,c,e,f,g),Ext.getCmp("component:mainpanel").isCurrentTabEditable()?Ext.getCmp("component:previewpanel").showPanel():(Message.PreviewPanel.forceCollapse.send(),(new Message.HeaderToolbar.DisableMenuItem(["menu-edit-replace","menu-edit-replace-all","menu-edit-commentize","menu-edit-decommentize"],!0)).send()))},itemexpand:function(){this.sendIDEStatus();this.updateDeletedFilesBG()},itemcollapse:function(){this.sendIDEStatus()},itemcontextmenu:function(a,c,e,f,g){this.onContextMenu(c.data,
e,g)},beforeitemmove:function(a,c,e,f,g){this.onBeforeitemmove(a,c,e,f,g)},afterRender:function(){var a=this;a.onCreateProjectTree();a.el.dom.addEventListener("dragover",function(){a.addClass("dragover")});$(a.body.dom).on({click:function(){a.getSelectionModel().deselectAll()},contextmenu:function(c){a.wwwDir&&(a.getSelectionModel().select(a.wwwDir),a.onContextMenu({filepath:"/www/"},null,c))}})}},dockedItems:[{xtype:"component",dock:"bottom",id:"guide-dev-tools",baseCls:"cell-guide-other-tools",
html:'<div class="cell-guide-other-tools-inner" style="background-color: #333;width: 180px;padding:10px;"><span style="color: #e5e5e5;">'+Forte.Resources.Text.WIDGETS_GUIDE_OTHER_DEV_TOOLS_TITLE+'</span><input type="submit" id="panel" value=""><div id="guide-dev-tools-inner" ><div style="margin-top:6px;color:#b2b2b2;">'+Forte.Resources.Text.WIDGETS_GUIDE_OTHER_DEV_TOOLS_DESC+'</div><ul><li>\u30fb<a href="#" onclick="Forte.API.showOtherDevToolsDialog(1);return false;">Monaca Localkit</a></li><li>\u30fb<a href="#" onclick="Forte.API.showOtherDevToolsDialog(2);return false;">Monaca for Visual Studio</a></li><li>\u30fb<a href="#" onclick="Forte.API.showOtherDevToolsDialog(3);return false;">Monaca CLI</a></li></ul></div></div>',
listeners:{afterrender:function(){$("#panel",this.getEl().dom).click(function(){$("#guide-dev-tools").toggleClass("open")})}}}]});this.callParent();MessageHub.subscribe(Message.ProjectPanel.UpdateProject,function(){a.onCreateProjectTree()});MessageHub.subscribe(Message.ProjectPanel.CreateNewFile,function(){a.createNewFile("/www/")});MessageHub.subscribe(Message.ProjectPanel.CreateNewDirectory,function(){a.createNewFolder("/www/")});MessageHub.subscribe(Message.PluginDialog.Saved,function(){a.onCreateProjectTree()})},
getFileIcon:function(a){return this.fileIcons[a]},onOpenFile:function(a,b){var b=this.selectedNode,c=b.data.type,e=b.data.filepath,f=b.data.mime||"text/plain";"text"===c?b.data.readOnly?MessageHub.send(new Message.MainPanel.OpenReadOnlyEditorTab({filepath:e,mime:f})):MessageHub.send(new Message.MainPanel.OpenEditorTab({filepath:e,mime:f})):"image"===c?(c=getFileDirectory(b.data.filepath),e=encodeURIComponent(getFileName(b.data.filepath)),(f=Ext.getCmp("picture:/api/project/"+Forte.API.projectId+"/file/read"+
c+e))?f.toFront():Ext.widget("widgets.picturepreview",{title:b.data.filepath.substr(5),filepath:"/api/project/"+Forte.API.projectId+"/file/read"+c+e}).show()):"audio"===c?(c=Ext.getCmp("audio:"+b.data.filepath))?c.toFront():(c=getFileDirectory(b.data.filepath),e=encodeURIComponent(getFileName(b.data.filepath)),Ext.widget("widgets.audiopreview",{title:b.data.filepath.substr(5),filepath:"/api/project/"+Forte.API.projectId+"/file/read"+c+e}).show()):"plugin"===c&&MessageHub.send(new Message.MainPanel.OpenPluginSettingsDialog)},
onCreateFile:function(){var a=this.getSelectionModel().getSelection()[0],b=getFileDirectory(a.data.filepath);this.createNewFile(b,a)},createNewFile:function(a,b){var c=this,e=function(){Forte.Widgets.NewFileWindow.showWindow(a,function(e,g){c.callbackCreateFile(g,a,b,e)})};Forte.API.isStorageExceeded?Ext.create("Cell.window.StorageLimitDialog").showWindow(e):e()},setDisableFileButtons:function(a){["AddFileButton","AddFolderButton","UploadFileButton"].forEach(function(b){Ext.getCmp(b).setDisabled(a)})},
callbackCreateFile:function(a,b,c,e){if(!a.match(/^[!-~]+$/)||a.match(/[/<>;]/))Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_CREATE_FILE_TITLE,Forte.Resources.Text.ERROR_CREATE_FILE_INVALID_TEXT);else{var f=b+a,g=getMime(getExtName(a)),b=c?c.childNodes:this.getRootNode().childNodes[0].childNodes;0==b.length&&(b=c.parentNode.childNodes);for(c=0;c<b.length;c++)if(b[c].data.filepath==f||b[c].data.filepath==f+"/"){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_CREATE_FILE_TITLE,Forte.Resources.Text.ERROR_CREATE_FILE_EXIST_TEXT);
return}var h=this;Forte.API.save(f,"@@NEW_FILE@@",function(){h.onCreateProjectTree();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_CREATE_FILE(a),type:"report"})).send();(new Message.MainPanel.OpenEditorTab({filepath:f,mime:g})).send()},null,null,e)}},onDeleteFile:function(){var a=this,b=this.getSelectionModel().getSelection()[0],c=b.data.filepath;"/www/"==c||!b.data.deletable?Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_DELETE_FILE_TITLE,Forte.Resources.Text.ERROR_DELETE_FILE_TOP_TEXT):
Cell.DarkMessageBox.confirm(Forte.Resources.Text.PAGES_DELETE_MESSAGEBOX_TITLE,Forte.Resources.Text.PAGES_DELETE_MESSAGEBOX_TEXT(b.data.filepath),function(e){"yes"===e&&a.deleteFile(c,b)})},deleteFile:function(a,b){var c=this;"directory"==b.data.type?(Forte.API.rmdir(a,function(){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_DELETE_FILE,type:"report"})).send();c.onCreateProjectTree()}),function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b].data.filepath,h=a.childNodes[b];
"directory"==a.childNodes[b].data.type?arguments.callee(h):MessageHub.send(new Message.MainPanel.RemoveTabByFilepath(c))}}(b)):(Forte.API.remove(a,function(){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_DELETE_FILE,type:"report"})).send();c.onCreateProjectTree()}),MessageHub.send(new Message.MainPanel.RemoveTabByFilepath(a)))},onCreateFolder:function(){var a=this.getSelectionModel().getSelection()[0],b=getFileDirectory(a.data.filepath);this.createNewFolder(b,a)},createNewFolder:function(a,
b){var c=this;Cell.LightMessageBox.prompt(Forte.Resources.Text.PAGES_NEWDIR_MESSAGEBOX_TITLE,Forte.Resources.Text.PAGES_NEWDIR_MESSAGEBOX_TEXT+"\n"+a,function(e,f){"ok"==e&&c.callbackCreateDirectory(f,a,b)})},callbackCreateDirectory:function(a,b,c){if(!a.match(/^[!-~]+$/)||a.match(/[/<>;]/))Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_CREATE_DIR_TITLE,Forte.Resources.Text.ERROR_CREATE_DIR_INVALID_TEXT);else{for(var b=b+a,c=c?c.childNodes:this.getRootNode().childNodes,e=0;e<c.length;e++)if(c[e].data.filepath==
b||c[e].data.filepath==b+"/"){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_CREATE_DIR_TITLE,Forte.Resources.Text.ERROR_CREATE_DIR_EXIST_TEXT);return}var f=this;Forte.API.mkdir(b,function(){f.onCreateProjectTree();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_CREATE_DIR(a),type:"report"})).send()})}},onBeforeitemmove:function(a,b,c){var e=this,f=a.data.filepath,g=c.data.filepath+getFileName(a.data.filepath),h="directory"===a.data.type,b=getEditableFlags(a),j=getEditableFlags(c);
h&&(g=c.data.filepath+getFileName(f.substring(0,f.length-1)));if(!b.canDelete)return Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_MOVE_FILE_TITLE,Forte.Resources.Text.ERROR_MOVE_FILE_INVALID_FROM),e.onCreateProjectTree(),!0;if(!j.canMoveTo||"/res/"==f)return Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_MOVE_FILE_TITLE,Forte.Resources.Text.ERROR_MOVE_FILE_INVALID_TEXT),e.onCreateProjectTree(),!0;for(b=0;b<c.childNodes.length;b++)if(c.childNodes[b].data.filepath==g||c.childNodes[b].data.filepath==
g+"/")return Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_MOVE_FILE_TITLE,Forte.Resources.Text.ERROR_MOVE_FILE_EXIST_TEXT),this.onCreateProjectTree(),!0;h&&(g+="/");Forte.API.move(f,g,function(){h?e.removeAndOpenTab(a,g+"/"):MessageHub.send(new Message.MainPanel.ReOpenEditorTab(f,g));e.onCreateProjectTree()},function(a,b){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_MOVE_FILE_TITLE,Forte.Resources.Text.ERROR_MOVE_FILE_OTHER_TEXT(b));e.onCreateProjectTree();return!0})},onChangeName:function(){var a=
this,b=this.getSelectionModel().getSelection()[0],c=getFileDirectory(b.data.filepath),e=b.data.filepath;"/www/"==e||!b.data.deletable?Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_REMOVE_FILE_TITLE,Forte.Resources.Text.ERROR_REMOVE_FILE_TOP_TEXT):Cell.DarkMessageBox.prompt(Forte.Resources.Text.PAGES_RENAME_MESSAGEBOX_TITLE,Forte.Resources.Text.PAGES_RENAME_MESSAGEBOX_TEXT+"<br />"+e,function(f,g){"ok"==f&&a.callbackRename(f,g,c,b,e)},this,!1,getFileName(e))},callbackRename:function(a,b,c,e,
f){var g=!1,h=c+b,j=this;if(!b.match(/^[!-~]+$/)||b.match(/[/<>;]/))Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_REMOVE_FILE_TITLE,Forte.Resources.Text.ERROR_REMOVE_FILE_INVALID_TEXT);else if(f.lastIndexOf("/")+1==f.length&&(g=!0,h=getFileDirectory(c.substring(0,c.length-1))+b),"ok"==a){a=e.parentNode;for(b=0;b<a.childNodes.length;b++)if(a.childNodes[b].data.filepath==h||a.childNodes[b].data.filepath==h+"/"){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_REMOVE_FILE_TITLE,Forte.Resources.Text.ERROR_REMOVE_FILE_EXIST_TEXT);
return}Forte.API.move(f,h,function(){g?j.removeAndOpenTab(e,h+"/"):MessageHub.send(new Message.MainPanel.ReOpenEditorTab(f,h));j.onCreateProjectTree()},function(a,b){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_REMOVE_FILE_TITLE,Forte.Resources.Text.ERROR_REMOVE_FILE_OTHER_TEXT(b))})}},onChangeNameInline:function(a,b){var c=a.getSelectionModel().getSelection()[0];filepath=c.data.filepath;filedir=getFileDirectory(filepath);icons=b.children[0].children[0];iconHTML=document.createElement("div");
flags=getEditableFlags(c);d=document.importNode(icons.lastElementChild,!1);iconHTML.appendChild(d);if(flags.canRename&&"/www/"!==filepath&&c.data.deletable&&!(0==filepath.indexOf("/www/plugins/")||"/android/"==filepath||"/iOS/"==filepath))filenameEditor=new Ext.Editor({cls:"cell-inlineeditor",ignoreNoChange:!0,field:{labelAlign:"right",labelWidth:32,labelPad:0,xtype:"textfield",allowBlank:!1,fieldLabel:iconHTML.innerHTML,labelSeparator:""}}),filenameEditor.startEdit(b.children[0],c.get("text")),filenameEditor.on("deactivate",
function(a){setTimeout(function(){a.destroy()},3E3)},this,{single:!0}),filenameEditor.on("complete",function(b,f){var g=getFileDirectory(filepath);a.callbackRename("ok",f,g,c,filepath);a.selectedNode=c},this,{single:!0})},removeAndOpenTab:function(a,b){for(var c=0;c<a.childNodes.length;c++){var e=a.childNodes[c].data.filepath,f="",g=a.childNodes[c];"directory"==a.childNodes[c].data.type?(f=getFileName(e.substring(0,e.length-1)),arguments.callee(g,b+f+"/")):(f=getFileName(e),MessageHub.send(new Message.MainPanel.ReOpenEditorTab(e,
b+f)))}},onFileCopy:function(){var a=this.getSelectionModel().getSelection()[0];this.copyFile(a)},copyFile:function(a){var b=this;Cell.DarkMessageBox.prompt(Forte.Resources.Text.PAGES_COPY_MESSAGEBOX_TITLE,Forte.Resources.Text.PAGES_COPY_MESSAGEBOX_TEXT,function(c,e){"ok"==c&&b.callbackCopyFile(e,a)},this,!1,"copy_"+getFileName(a.data.filepath))},callbackCopyFile:function(a,b){var c=this,e=getFileDirectory(b.data.filepath),f=b.data.filepath;if(!a.match(/^[!-~]+$/)||a.match(/[/<>;]/))Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_CREATE_FILE_TITLE,
Forte.Resources.Text.ERROR_CREATE_FILE_INVALID_TEXT);else{var g=e+a,e=b?b.childNodes:this.getRootNode().childNodes[0].childNodes;if(0==e.length){for(var e=b.parentNode.childNodes,h=0;h<e.length;h++)if(e[h].data.filepath==g||e[h].data.filepath==g+"/"){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_CREATE_FILE_TITLE,Forte.Resources.Text.ERROR_CREATE_FILE_EXIST_TEXT);return}Forte.API.copy(f,g,function(){c.onCreateProjectTree();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_COPY_FILE(g),
type:"report"})).send()})}else Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_COPY_FILE_TITLE,Forte.Resources.Text.ERROR_COPY_FILE_IS_DIR_TEXT)}},onFilePaste:function(){this.getSelectionModel().getSelection();alert("now developping")},onFileUpload:function(){var a=this.getSelectionModel().getSelection()[0],a=getFileDirectory(a.data.filepath);Forte.Widgets.UploadWindow.showWindow(a,function(a){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOADED_FILE(a),type:"report"})).send()})},
onJSLibraryAdd:function(){},createTreeStore:function(){tree_root=Ext.data.NodeInterface({text:"root",id:"project_root",expanded:!0,draggable:!1,readOnly:!1});return tree_store=Ext.create("Ext.data.TreeStore",{root:tree_root,folderSort:!0,sorters:[{property:"text",direction:"ASC"}]})},onCreateProjectTree:function(a){var b=this;b.loadmask.show();b.disable(!0);b.currentDir="/www/";b.selectedNode=null;Forte.API.tree({is_show_hidden:b.isShowHidden?1:0,is_show_deleted:b.isShowDeleted?1:0},function(c){b.callbackTreeAPI(c);
MessageHub.send(new Message.ProjectPanel.DirectoryCreated);"function"==typeof a&&a()},function(){Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.ERROR_API_TREE);b.enable(!0);b.loadmask.hide()})},callbackTreeAPI:function(a){var b=this.store.tree.root;b.removeAll();this.makeTreePanel(b,a);this.enable(!0);this.updateDeletedFilesBG();this.loadmask.hide()},updateDeletedFilesBG:function(){setTimeout(function(){var a=$(Ext.getDom("component:projectpanel")).find(".ide-pages-panel-deleted").parent().parent().parent();
a.length&&a.css("background","#3D3D3D")},100)},makeTreePanel:function(a,b){var c=this,e={},f=[],f=[],g=[],h;for(h in b)"dir"==b[h].type?f.push(h):g.push(h);f.sort();g.sort();f=f.concat(g);for(h=0;h<f.length;h++){var g=f[h],j=b[g],k=g.substring(0,g.lastIndexOf("/")),m=Ext.htmlEncode(g.substring(g.lastIndexOf("/")+1)),n={deleted:1==j.deleted,deletable:1==j.deletable,hidden:1==j.hidden};n.draggable=n.deletable;if(c.isShowHidden||!n.hidden)if(c.isShowDeleted||!n.deleted)if("dir"==j.type||"plugins"==j.type){var q=
g+"/",l=Ext.data.NodeInterface(n),l=e[k]?e[k].appendChild(l):a.appendChild(l);l.data.text=m;l.data.id=q+"_pages_item";l.data.filepath=q;l.data.expanded=!0;l.data.type="directory";l.data.iconCls="ide-pages-panel-"+j.icon;l.data.expanded=!1;!0==j.readOnly&&(l.data.iconCls+=" ide-pages-panel-readonly");n.deleted&&(l.data.iconCls+=" ide-pages-panel-deleted");n.hidden&&(l.data.iconCls+=" ide-pages-panel-hidden");l.addListener({expand:{fn:function(){c.setProjectTreeStatus()},scope:this},collapse:{fn:function(){c.setProjectTreeStatus()},
scope:this}});"/www/"===q?(c.wwwDir=l,l.data.expanded=!0):q in c.projectTreeStatus&&c.projectTreeStatus[q].isExpanded&&(l.data.expanded=!0);e[g]=l}else{q=getFileName(g);getExtName(q);var l=j.fileType,r=j.mime,o="ide-pages-panel-"+j.icon,t=j.readOnly?!0:!1;!0==j.readOnly&&(o+=" ide-pages-panel-readonly");n.deleted&&(o+=" ide-pages-panel-deleted");n.hidden&&(o+=" ide-pages-panel-hidden");var s="",s=null!=j.renameTo?j.platform?j.renameTo+" ("+Forte.Resources.Text.PAGES_PLATFORM_FOR(j.platform)+")":j.renameTo:
m;null!=j.realpath&&(g=j.realpath);c.fileIcons[g]=j.icon;"text/html"==r&&(!n.deleted&&!n.hidden)&&(c.htmlFileList[g]={path:g,filename:q});l=Ext.data.NodeInterface({text:s,id:g+"_pages_item",filepath:g,expanded:!0,leaf:!0,type:l,readOnly:t,iconCls:o,mime:r});Ext.apply(l,n);e[k]?e[k].appendChild(l):a.appendChild(l)}}},select:function(a){(a=this.store.tree.root.findChild("filepath",a,!0))&&this.getSelectionModel().select(a);return a},setProjectTreeStatus:function(){var a=this,b=a.store.tree.root;a.projectTreeStatus=
{};(function(b){for(var e=0;e<b.childNodes.length;e++){var f=b.childNodes[e],g=f.data.filepath,h={};f.isLeaf()?h.isExpanded=!1:(h.isExpanded=f.isExpanded(),arguments.callee(f));a.projectTreeStatus[g]=h}})(b)},onCheckLayout:function(){var a=this.getSelectionModel().getSelection()[0];getFileDirectory(a.data.filepath);var b=getExtName(a.data.filepath);"text"==a.data.type&&("html"==b||"htm"==b)?MessageHub.send(new Message.MainPanel.CheckLayout(a.data.filepath)):Cell.DarkMessageBox.alert(Forte.Resources.Text.ERROR_REMOVE_FILE_LAYOUT_TITLE,
Forte.Resources.Text.ERROR_REMOVE_FILE_LAYOUT_TEXT)},createContextMenu:function(a){var b=getEditableFlags(this.selectedNode);return new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},items:[{scope:this,text:Forte.Resources.Text.PAGES_CONTEXTMENU_NEW,icon:"/img/cell/icon/document.png",disabled:!b.canCreateFile,handler:function(){Ext.getCmp("component:projectpanel").onCreateFile()}},{scope:this,text:Forte.Resources.Text.PAGES_CONTEXTMENU_NEWDIR,icon:"/img/cell/icon/blue-folder-horizontal.png",
disabled:!b.canCreateDir,handler:function(){Ext.getCmp("component:projectpanel").onCreateFolder()}},{scope:this,text:Forte.Resources.Text.PAGES_CONTEXTMENU_DELETE,icon:"/img/cell/icon/cross.png",disabled:!b.canDelete,handler:function(){Ext.getCmp("component:projectpanel").onDeleteFile()}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_RENAME,scope:this,icon:"/img/icon/textfield.png",disabled:!b.canRename,handler:function(){var b=Ext.getCmp("component:projectpanel");b.onChangeNameInline(b,a)}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_OPEN,
scope:this,icon:"/img/icon/page_copy.png",disabled:!b.canOpen,handler:Ext.getCmp("component:projectpanel").onOpenFile},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_COPY,scope:this,icon:"/img/icon/page_copy.png",disabled:!b.canCopy,handler:Ext.getCmp("component:projectpanel").onFileCopy},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_HISTORY,scope:this,icon:"/img/icon/page_copy.png",disabled:!b.canViewHistory,handler:function(){var a=Ext.getCmp("component:projectpanel").getSelectionModel().getSelection()[0];
MessageHub.send(new Message.MainPanel.OpenHistoryTab({path:a.data.filepath,mime:a.data.mime}))}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_UPLOAD,scope:this,icon:"/img/cell/icon/upload-cloud.png",disabled:!b.canUploadTo,handler:function(){Ext.getCmp("component:projectpanel").onFileUpload()}},{text:Forte.Resources.Text.GENERAL_EXPORT_FOLDER,scope:this,icon:"/img/cell/icon/download-cloud.png",disabled:!b.canDownload,handler:function(){var a=Ext.getCmp("component:projectpanel").getSelectionModel().getSelection()[0],
a=Forte.API.download(a.data.filepath);window.open(a)}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_PLUGIN,scope:this,icon:"/img/icon/component.png",handler:function(){MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_HTML5_PLUGINS))}}]})},onContextMenu:function(a,b,c){"undefined"!==typeof c.stopEvent?c.stopEvent():c.preventDefault();a=this.createContextMenu(b);b?a.showBy(b,"tr?",[-10,-5]):a.showAt([c.clientX,c.clientY]);a.getEl().on({contextmenu:function(){this.activeItem.handler();
this.close()},scope:a,preventDefault:!0});a.on({hide:function(){this.destroy()}})},onDrop:function(a,b){var c=b.originalEvent.dataTransfer.files,e=b.originalEvent.dataTransfer.items,f=[],g=[];a.fileNum.uploaded=0;a.fileNum.total=0;a.absorbEvent(b);a.removeCls("dragover");a.selectedNode||a.select("/www/");if(getEditableFlags(a.selectedNode).canUploadTo&&c.length){for(var h=0;h<c.length;h++)if(e){var j=e[h].webkitGetAsEntry(),k=a.selectedNode.data.filepath;j.isFile?(k=k.substring(0,k.lastIndexOf("/")+
1)+c[h].name,f.push(a.pushItem(k,null,j))):j.isDirectory&&g.push(j)}else a.pushFile(a,c[h]);$.when.apply($,f).then(function(){g.forEach(function(b){a.parseDir(a,b)})});a.disallowOverWrite=!0}},sendIDEStatus:function(){MessageHub.send(new Message.SendIDEStatus("projectTreeStatus",this.projectTreeStatus))}})})();(function(){Ext.define("Forte.GrepPanel",{extend:"Cell.panel.DarkPanel",alias:"widget.greppanel",keyword:"",is_ignorecase:!0,is_regex:!1,initComponent:function(){var a=this;Ext.apply(this,{id:"component:greppanel",scroll:"auto",autoScroll:!0,tbar:[{xtype:"cell.searchinput",allowBlank:!0,flex:1,listeners:{specialkey:function(b,c){if(c.getKey()==c.ENTER){var e=this;e.showLoading();a.keyword=b.getValue();Forte.API.grep({keyword:a.keyword,is_ignorecase:a.is_ignorecase?1:0,is_regex:a.is_regex?1:0},a.onGrepSuccess,
a.onGrepFail).complete(function(){e.hideLoading()})}}}},{xtype:"button",cls:"cell-btn-detail",icon:"/img/new_ide/projectPanel/detail.png",tooltip:Forte.Resources.Text.PAGES_CONTEXTMENU_TITLE,menu:Ext.create("Cell.menu.ContextMenu",{items:[{xtype:"menucheckitem",text:Forte.Resources.Text.GREP_IGNORE_CASE,checked:!a.is_ignorecase,listeners:{checkchange:function(b,c){a.is_ignorecase=!c}}},{xtype:"menucheckitem",text:Forte.Resources.Text.GREP_USE_REGEX,checked:a.is_regex,listeners:{checkchange:function(b,
c){a.is_regex=c}}}]})}],items:[{xtype:"cell.darktree",id:"GrepResultPanel",expandable:!1,rootVisible:!1,allowDrag:!1,allowDrop:!1,border:!1,animate:!1,items:[{xtype:"component",style:"padding:10px 0 0 7px;",ui:"dark",id:"GrepResultPanel-noresults",hidden:!0,html:Forte.Resources.Text.GREP_NO_RESULTS}],listeners:{select:function(a,c){var e=c.raw.fileName;e&&MessageHub.send(new Message.MainPanel.OpenEditorTab({filepath:e,mime:getMime(getExtName(e)),lineNum:c.raw.lineNum}))}}}]});this.callParent()},onGrepFail:function(a,
b,c){Ext.getCmp("component:greppanel");(!c.reasons||!(c.reasons.keyword&&"too short keyword."==c.reasons.keyword))&&Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)},onGrepSuccess:function(a){var b=Ext.getCmp("component:greppanel"),c=Ext.getCmp("GrepResultPanel");data=[];root=c.getRootNode().removeAll();if(null==a||0==a.length)Ext.getCmp("GrepResultPanel-noresults").show();else{Ext.getCmp("GrepResultPanel-noresults").hide();for(var e in a){var c={text:Ext.htmlEncode(e),
leaf:!1,expanded:!0,iconCls:"ide-pages-panel-"+Ext.getCmp("component:projectpanel").getFileIcon(e),children:[]},f=b.keyword,g=null;try{!1==b.is_regex&&(f=f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")),g=RegExp(f,"g"+(b.is_ignorecase?"i":""))}catch(h){console.warn(h)}var f=a[e],j;for(j in f){var k=f[j].excerpt;g?(k=k.replace(g,"[monaca_highlight]$&[/monaca_highlight]"),k=Ext.htmlEncode(k),k=str_replace_all("[monaca_highlight]",'<span class="highlight">',k),k=str_replace_all("[/monaca_highlight]",
"</span>",k)):k=Ext.htmlEncode(k);c.children.push({fileName:e,lineNum:f[j].num,text:Ext.htmlEncode(f[j].num+": ")+k,leaf:!0,iconCls:"ide-pages-panel-arrow"})}root.appendChild(c)}}}})})();(function(){Ext.define("Forte.CloudControlPanel",{extend:"Cell.panel.DarkPanel",collections:[],backends:[],ownedBackends:[],mbaasApps:[],settings:{},initComponent:function(){var a=this;a.loadmask=new Ext.LoadMask(a,{msg:'<img src="/img/loading-icon.gif" /><br />Loading...'});var b=Forte.API.backendId?a.createContents():Forte.API.mbaasAppId?a.createMbaasContents(Forte.API.mbaasAppId):a.createDetachedContents();Ext.apply(this,{id:"component:cloudpanel",scroll:"auto",layout:{type:"vbox",align:"stretch"},
items:b,tbar:[{xtype:"button",cls:"cell-cloud-toolbar-detail",icon:"/img/new_ide/cloud/btn_gear.png",ui:"dark-embed",width:40,menu:Ext.create("Cell.menu.ContextMenu",{listeners:{show:function(){this.down("#openconfig").setDisabled(!Forte.API.backendId?!0:!1)}},items:[{text:Forte.Resources.Text.CLOUD_SELECT_BACKEND+"...",scope:a,handler:a.openCreateBackend},{text:Forte.Resources.Text.CLOUD_SETTINGS+"...",itemId:"openconfig",handler:function(){Ext.getCmp("component:mainpanel").createTabSettingCloud(0)}},
"-",{text:Forte.Resources.Text.CLOUD_MANAGE_BACKEND+"...",scope:a,handler:a.openManageBackend}]})},"->",{xtype:"button",itemId:"control-help",icon:"/img/icon/help.png",ui:"dark-embed",hidden:Forte.API.mbaasAppId?!0:!1,handler:function(){window.open(Forte.Resources.DocumentURL.BACKEND)}}],listeners:{afterrender:function(){var a=this;a.loadmask.show();Forte.API.getBackendList(function(b){var f="";a.backends=b.backends;for(var g=0;g<a.backends.length;g++)Forte.API.backendId===a.backends[g]._id&&(f=a.backends[g].name);
Forte.API.backendId&&a.getComponent("cloudpanel-cont").setTitle(f);a.mbaasApps=[];for(key in b.mbaas_apps)a.mbaasApps.push({_id:key,name:b.mbaas_apps[key]});Forte.API.mbaasAppId&&("undefined"===typeof b.mbaas_apps[Forte.API.mbaasAppId]?(a.getComponent("mbaas-console-btns"),a.getComponent("mbaas-title").update(Forte.Resources.Text.CLOUD_MBAAS_NOT_CONNECTED),a.down("#mbaas-console").setDisabled(!0),Forte.API.mbaasAppId=null):(a.down("#mbaas-console").setDisabled(!1),a.getComponent("mbaas-title").update(Ext.htmlEncode(b.mbaas_apps[Forte.API.mbaasAppId]))));
a.loadmask.hide()});Forte.API.getOwnedBackendList(function(b){a.ownedBackends=b.backends});Forte.API.backendId&&Forte.API.loadBackendSettings(function(b){a.settings=b.settings})},resize:function(){var b=26*a.collections.length,e=Ext.getCmp("component:cloudpanel").getHeight()-138,f=a.down("#tree-collection");f&&f.setHeight(b>e?e:b)}}});Forte.API.backendId&&Forte.API.postCloud("Collection.list",null,a.onGetCollectionList);a.callParent()},createContents:function(){var a=this,b=Ext.create("Ext.data.TreeStore",
{root:Ext.data.NodeInterface({text:"Collection",expanded:!0,draggable:!1,readOnly:!0}),folderSort:!0,sorters:[{property:"text",direction:"ASC"}]});if(a.rendered){var c=this.down("#control-help");c&&c.show()}return[{title:Forte.Resources.Text.CLOUD_DATA,itemId:"cloudpanel-cont",cls:"cell-cloud-data",items:[{xtype:"cell.button",ui:"dark-embed",icon:"/img/new_ide/cloud/ico_user.png",text:Forte.Resources.Text.CLOUD_USER,handler:function(){Ext.getCmp("component:mainpanel").createCloudUserTab(a.settings.userpanel)},
listeners:{afterrender:function(a){a.getEl().on("contextmenu",function(a){a.browserEvent.preventDefault();return!1})}}},{xtype:"cell.button",ui:"dark-embed",icon:"/img/new_ide/cloud/ico_mail.png",text:Forte.Resources.Text.CLOUD_MAILTEMPLATE,handler:function(){Ext.getCmp("component:mainpanel").createCloudMailTemplateTab()},listeners:{afterrender:function(a){a.getEl().on("contextmenu",function(a){a.browserEvent.preventDefault();return!1})}}},{xtype:"cell.button",ui:"dark-embed",icon:"/img/new_ide/push/ico_push_to_app.png",
text:Forte.Resources.Text.PAGES_TAB_PUSH,handler:function(){Ext.getCmp("component:mainpanel").createCloudPushHistoryTab()},listeners:{afterrender:function(a){a.getEl().on("contextmenu",function(a){a.browserEvent.preventDefault();return!1})}}},{xtype:"component",ui:"projectpanel-title",cls:"cloud-tree-collection-title",html:Forte.Resources.Text.CLOUD_COLLECTION},{xtype:"cell.darktree",cls:"cloud-tree-collection",itemId:"tree-collection",expandable:!1,rootVisible:!1,allowDrag:!1,allowDrop:!1,border:!1,
animate:!1,store:b,listeners:{itemclick:function(b,c){var g=c.data.text;if(g){var h="undefined"!==typeof a.settings.collectionpanel?a.settings.collectionpanel[g]:null;Ext.getCmp("component:mainpanel").createCloudCollectionTab(g,h)}a.down("#tree-collection").getSelectionModel().deselectAll()},itemcontextmenu:function(b,c,g,h,j){a.onCollectionTreeContextMenu(a,c,g,h,j)}}}]},{xtype:"button",ui:"embed",cls:"cell-btn-detail collection-btn-detail",icon:"/img/new_ide/projectPanel/detail.png",tooltip:Forte.Resources.Text.PAGES_CONTEXTMENU_TITLE,
menu:Ext.create("Cell.menu.ContextMenu",{items:[{text:Forte.Resources.Text.CLOUD_NEW_COLLECTION+"...",scope:a,handler:a.openAddNewCollection},{text:Forte.Resources.Text.CLOUD_COLLECTION_DELETE+"...",scope:a,handler:a.openDeleteCollection}]})}]},createMbaasContents:function(a,b){"undefined"===typeof b&&(b="");if(this.rendered){var c=this.down("#control-help");c&&c.hide()}return[{xtype:"component",cls:"cloud-control-mbaas-title",html:"NIFTY Cloud mobile backend"},{xtype:"component",itemId:"mbaas-title",
cls:"cloud-control-mbaas-name",html:Ext.htmlEncode(b)},{xtype:"container",height:280,itemId:"mbaas-console-btns",cls:"cloud-control-mbaas-console",layout:{type:"vbox"},items:[{xtype:"cell.button",ui:"blue",itemId:"mbaas-console",cls:"cloud-control-mbaas-console-btn",width:180,height:50,text:Forte.Resources.Text.CLOUD_MBAAS_OPEN_CONSOLE,handler:function(){var b={width:1E3,height:600,left:100,top:40,status:"no",location:"no",scrollbars:"no",toolbar:"no",personalbar:"no",menubar:"no"},c=[],g;for(g in b)c.push(g+
"="+b[g]);self.previewWindow=window.open(Forte.Resources.URL.MBAAS_CONSOLE+encodeURIComponent(a),"mbaas_console_window",c.join(","))}},{xtype:"container",cls:"ide-backend-portal-documents",items:[{xtype:"component",html:Forte.Resources.Text.CLOUD_MBAAS_DOCUMENT}]},{xtype:"component",cls:"ide-backend-portal-expr",html:Forte.Resources.Text.CLOUD_MBAAS_DOCUMENT_EXPR}]}]},createDetachedContents:function(){if(this.rendered){var a=this.down("#control-help");a&&a.show()}return[{xtype:"container",cls:"ide-backend-portal",
items:[{xtype:"component",html:"<h2>"+Forte.Resources.Text.CLOUD_BACKEND_WELCOME_TITLE+"</h2>"},{xtype:"component",margin:"20px 0 0 0",style:"line-height: 1.2",html:Forte.Resources.Text.CLOUD_BACKEND_WELCOME_DESCRIPTION},{xtype:"cell.button",cls:"cloud-control-createbackend",scope:this,text:Forte.Resources.Text.CLOUD_START_USING_BACKEND,ui:"blue",handler:this.openCreateBackend},{xtype:"container",cls:"ide-backend-portal-documents",items:[{xtype:"component",html:Forte.Resources.Text.CLOUD_BACKEND_WELCOME_DOCUMENT}]},
{xtype:"container",cls:"cloud-control-createexternal",hidden:"ja"!==window.LANG,items:[{xtype:"cell.button",scope:this,text:Forte.Resources.Text.CLOUD_START_USING_EXTERNAL,ui:"blue",handler:this.openCreateExternal}]}]}]},onCollectionTreeContextMenu:function(a,b,c,e,f){var c=[f.browserEvent.clientX,f.browserEvent.clientY],g=b.data;f.preventDefault();(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:function(){a.down("#tree-collection").getSelectionModel().deselectAll();
this.destroy()}},items:[{scope:this,text:Forte.Resources.Text.CLOUD_COLLECTION_PERMISSION,handler:function(){Forte.API.postCloud("Collection.getConfig",{_id:g.text},function(a){Ext.create("Cell.window.CollectionSecurityWindow",{colName:g.text,colConfig:a.config}).show()})}},{scope:this,text:Forte.Resources.Text.CLOUD_DELETE_COLLECTION,handler:function(){a.openDeleteCollection(g.text)}}]})).showAt(c)},openCreateBackend:function(){var a=this;if("admin"!=Forte.API.projectRole)Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_SELECT_BACKEND,
Forte.Resources.Text.CLOUD_SELECT_BACKEND_DISABLED);else{var b=Ext.create("Ext.data.Store",{fields:["_id","name"],displayField:"name",valueField:"_id",data:a.backends}),c=Ext.create("Ext.data.Store",{fields:["_id","name"],displayField:"name",valueField:"_id",data:a.mbaasApps||[]}),e="";Forte.API.mbaasAppId?e=Forte.API.mbaasAppId:0<a.mbaasApps.length&&(e=a.mbaasApps[0]._id);var f=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.CLOUD_SELECT_BACKEND_TITLE,closable:!0,resizable:!1,layout:"vbox",
modal:!0,width:400,height:0===a.mbaasApps.length?360:424,bodyStyle:"padding-top: 30px;",bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){f.close()}},{xtype:"cell.button",itemId:"submit",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_APPLY,handler:function(){var b=this,c=!1,e=function(){b.setDisabled(!1);c&&f.close();Forte.API.getOwnedBackendList(function(b){a.ownedBackends=b.backends})};b.setDisabled(!0);if(f.getComponent("createnew").getValue()){var k=
f.getComponent("newname").getValue();Forte.API.createBackend(k,function(b){var e=b.backend_id,f=b.api_key;Forte.API.backendId||(a.removeAll(),a.add(a.createContents()));Forte.API.backendId=e;Forte.API.cloudApiKey=f;Forte.API.mbaasAppId=null;Forte.API.loadBackendSettings(function(b){a.settings=b.settings;Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_SELECT_BACKEND,Forte.Resources.Text.CLOUD_BACKEND_CREATED)});a.getComponent("cloudpanel-cont").setTitle(b.name);a.backends.push({_id:b.backend_id,
name:b.name});a.onGetCollectionList({items:[]});Ext.getCmp("component:mainpanel").closeCloudTabs();c=!0},null,e)}else if(f.getComponent("useexist").getValue()){var m=f.getComponent("name").getValue();Forte.API.changeBackend(m,0,function(b){a.loadmask.show();var e=a.getComponent("collectionempty");e&&a.remove(e);Forte.API.backendId||(a.removeAll(),a.add(a.createContents()));Forte.API.backendId=b.backend_id;Forte.API.cloudApiKey=b.api_key;Forte.API.mbaasAppId=null;Forte.API.loadBackendSettings(function(b){a.settings=
b.settings;Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_SELECT_BACKEND,Forte.Resources.Text.CLOUD_BACKEND_CHANGED)});Forte.API.postCloud("Collection.list",null,function(b){a.onGetCollectionList(b);a.loadmask.hide()});a.getComponent("cloudpanel-cont").setTitle(b.name);Ext.getCmp("component:mainpanel").closeCloudTabs();c=!0},null,e)}else if(f.getComponent("usembaas").getValue()){if(m=f.getComponent("name-mbaas").getValue())if(k=f.getComponent("name-mbaas").store.findRecord("_id",m)){var n=
k.data.name;Forte.API.changeBackend(m,1,function(){Forte.API.backendId=null;Forte.API.cloudApiKey=null;Forte.API.mbaasAppId=m;Ext.getCmp("component:mainpanel").closeCloudTabs();var b=a.getComponent("collectionempty");b&&a.remove(b);a.removeAll();a.add(a.createMbaasContents(m,n));Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_SELECT_BACKEND,Forte.Resources.Text.CLOUD_BACKEND_CHANGED);c=!0},null,e)}}else a.detachBackend(a,function(){c=!0;Cell.LightMessageBox.alert("Success",Forte.Resources.Text.CLOUD_BACKEND_DETACHED);
f.close()})}}],items:[{xtype:"radio",boxLabel:Forte.Resources.Text.CLOUD_CREATE_NEW_BACKEND,checked:!Forte.API.backendId&&!Forte.API.mbaasAppId,itemId:"createnew",name:"seltype",style:"margin-bottom:5px"},{xtype:"textfield",itemId:"newname",editable:!0,emptyText:Forte.Resources.Text.CLOUD_CREATE_NEW_BACKEND_HOLDER,width:320,style:"margin-bottom: 12px;",listeners:{afterrender:function(a){a.getEl().on("keypress",function(a){if(a.keyCode===Ext.EventObject.RETURN||10===a.keyCode)a=f.down("#submit"),a.handler.call(a);
f.down("#createnew").setValue(!0)})}}},{xtype:"radio",boxLabel:Forte.Resources.Text.CLOUD_USE_EXISTING_BACKEND,checked:Forte.API.backendId?!0:!1,itemId:"useexist",name:"seltype",style:"margin-bottom:5px"},{xtype:"cell.combo",itemId:"name",displayField:"name",valueField:"_id",store:b,editable:!1,value:Forte.API.backendId?Forte.API.backendId:a.backends.length?a.backends[0]._id:null,width:320,listeners:{afterrender:function(a){a.getEl().on("keypress",function(a){if(a.keyCode===Ext.EventObject.RETURN||
10===a.keyCode)a=f.down("#submit"),a.handler.call(a);f.down("#useexist").setValue(!0)})},select:function(){f.down("#useexist").setValue(!0)}}},{xtype:"radio",boxLabel:Forte.Resources.Text.CLOUD_USE_MBAAS,checked:Forte.API.mbaasAppId&&a.mbaasApps.length,hidden:0===a.mbaasApps.length,itemId:"usembaas",name:"seltype",style:"margin-bottom:5px"},{xtype:"cell.combo",itemId:"name-mbaas",displayField:"name",valueField:"_id",store:c,allowBlank:!1,editable:!1,hidden:0===a.mbaasApps.length,value:e,width:320,
listeners:{afterrender:function(a){a.getEl().on("keypress",function(a){if(a.keyCode===Ext.EventObject.RETURN||10===a.keyCode)a=f.down("#submit"),a.handler.call(a);f.down("#usembaas").setValue(!0)})},select:function(){f.down("#usembaas").setValue(!0)}}},{xtype:"radio",boxLabel:Forte.Resources.Text.CLOUD_DETACH_BACKEND,disabled:!Forte.API.backendId&&!Forte.API.mbaasAppId,name:"seltype"}]}).show()}},openManageBackend:function(){var a=this,b=Ext.create("Ext.data.Store",{fields:["_id","name","using_projects",
{name:"created_at",type:"date",dateFormat:"timestamp",convert:unixToText}],displayField:"name",valueField:"_id",data:a.ownedBackends}),c=Ext.create("Cell.window.LightWindow",{cls:"ide-cloud-managebackend",title:Forte.Resources.Text.CLOUD_MANAGE_BACKEND,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:580,height:400,bodyStyle:"padding-top: 30px;",bbar:[{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){c.close()}},"->",{xtype:"cell.button",itemId:"delete",
ui:"red",text:Forte.Resources.Text.GENERAL_DELETE,disabled:!0,width:90,handler:function(){var e=c.getComponent("name"),f=e.getValue();Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.CLOUD_BACKEND_DELETE_CONFIRM,function(g){"yes"==g&&(f===Forte.API.backendId&&a.detachBackend(a),a.deleteBackend(a,f,function(){b.remove(b.findRecord("_id",f));e.setValue("");c.close();Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_SELECT_BACKEND,Forte.Resources.Text.CLOUD_BACKEND_DELETED);
Forte.API.getOwnedBackendList(function(b){a.ownedBackends=b.backends})}))})}},{xtype:"cell.button",itemId:"rename",ui:"blue",disabled:!0,width:120,text:Forte.Resources.Text.CLOUD_BACKEND_CHANGENAME,handler:function(){var b=c.getComponent("name").getValue(),f=c.down("#newName").getValue();Forte.API.renameBackend(b,f,function(){for(var g=0;g<a.backends.length;g++)if(b===a.backends[g]._id){a.backends[g].name=Ext.htmlEncode(f);break}for(g=0;g<a.ownedBackends.length;g++)if(b===a.ownedBackends[g]._id){a.ownedBackends[g].name=
Ext.htmlEncode(f);break}b===Forte.API.backendId&&a.getComponent("cloudpanel-cont").setTitle(f);c.close();Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_SELECT_BACKEND,Forte.Resources.Text.CLOUD_BACKEND_RENAMED)})}}],items:[{xtype:"cell.combo",itemId:"name",displayField:"name",emptyText:Forte.Resources.Text.CLOUD_BACKEND_DELETE_PLACEHOLDER,valueField:"_id",store:b,editable:!1,style:"margin-bottom: 5px",width:320,listeners:{change:function(a,b){if(b){for(var g=this.findRecord("_id",b),h=[],j=
0;j<g.data.using_projects.length;j++)h.push(g.data.using_projects[j].name);c.down("#delete").enable();c.down("#rename").enable();c.down("#newName").setValue(g.data.name);c.down("#relatedProjects").setValue(h.join(", "));c.down("#createdAt").setValue(g.data.created_at)}}}},{xtype:"component",cls:"cell-annotation",html:Forte.Resources.Text.CLOUD_MANAGE_OWN_LIST,width:500,style:"border-bottom:1px solid #e3e3e3; color:#999; line-height:130%; padding-bottom:20px;"},{xtype:"fieldset",ui:"transparent",title:Forte.Resources.Text.CLOUD_MANAGE_BACKEND_DETAILS,
defaults:{width:480,labelWidth:140},items:[{xtype:"textfield",itemId:"newName",fieldLabel:Forte.Resources.Text.CLOUD_MANAGE_BACKEND_NAME},{xtype:"displayfield",itemId:"relatedProjects",fieldLabel:Forte.Resources.Text.CLOUD_MANAGE_RELATED_PROJECTS},{xtype:"displayfield",itemId:"createdAt",fieldLabel:Forte.Resources.Text.CLOUD_MANAGE_CREATED_AT}]}]}).show()},deleteBackend:function(a,b,c){Forte.API.deleteBackend(b,function(e){for(var f=0;f<a.backends.length;f++)if(b===a.backends[f]._id){a.backends.splice(f,
1);break}c&&c(e)})},detachBackend:function(a,b){Forte.API.detachBackend(function(c){Forte.API.backendId=null;Forte.API.mbaasAppId=null;a.removeAll();a.add({xtype:"container",style:"text-align: center",items:[{xtype:"cell.button",cls:"cloud-control-createbackend",scope:a,text:Forte.Resources.Text.CLOUD_SELECT_BACKEND,ui:"light",handler:a.openCreateBackend}]});Ext.getCmp("component:mainpanel").closeCloudTabs();b&&b(c)})},openAddNewCollection:function(){var a=this,b=Ext.create("Cell.window.LightWindow",
{title:Forte.Resources.Text.CLOUD_NEW_COLLECTION,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:400,height:354,bodyStyle:"padding-top: 30px;",bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){b.close()}},{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_ADD,handler:function(){var c=this,e=!1;c.setDisabled(!0);var f=b.getComponent("defaultPublicPermission"),g=f.getComponent("read").getValue()?"r":"",f=f.getComponent("write").getValue()?
"w":"";Forte.API.postCloud("Collection.create",{_id:b.getComponent("colName").getValue(),isInsertable:b.getComponent("isInsertable").getValue(),defaultPublicPermission:g+f},function(){e=!0;Forte.API.postCloud("Collection.list",null,a.onGetCollectionList);Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_NEW_COLLECTION,Forte.Resources.Text.CLOUD_COLLECTION_CREATED)},null,function(){c.setDisabled(!1);e&&b.close()})}}],items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.CLOUD_NEW_COLLECTION_NAME},
{xtype:"textfield",itemId:"colName",editable:!0,emptyText:"MyCollection",width:320,style:"margin-bottom: 20px;"},{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.CLOUD_NEW_COLLECTION_SECURITY,style:"margin-bottom: 12px;"},{xtype:"checkbox",itemId:"isInsertable",boxLabel:Forte.Resources.Text.CLOUD_COLLECTION_ALLOW_INSERT,checked:!0,editable:!0,style:"margin: 0 0 20px 20px;"},{xtype:"component",html:Forte.Resources.Text.CLOUD_COLLECTION_DEFAULT_PERMISSION,style:"margin-bottom: 10px;"},
{xtype:"container",itemId:"defaultPublicPermission",layout:"hbox",width:496,height:34,style:"margin-left: 20px;",items:[{xtype:"component",html:"Public: ",width:60},{xtype:"checkbox",itemId:"read",boxLabel:"Read",checked:!1,editable:!0,style:"margin-right: 20px"},{xtype:"checkbox",itemId:"write",boxLabel:"Write",checked:!1,editable:!0}]}]}).show()},openCreateExternal:function(){var a=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.CLOUD_START_USING_EXTERNAL,cls:"ide-cloud-createexternal-window",
closable:!0,resizable:!1,layout:"vbox",modal:!0,width:580,height:400,defaults:{xtype:"container",layout:{type:"hbox",align:"middle"},height:100,style:"padding:20px 0; border-bottom: 1px solid #dedede;"},bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.close()}}],items:[{items:[{xtype:"image",src:"/img/new_ide/cloud/logo_nifty_mbaas.png"},{xtype:"component",html:"<h2>"+Forte.Resources.Text.NIFTY_CLOUD_MOBILE_BACKEND+'</h2><p class="expr">\u30cb\u30d5\u30c6\u30a3\u304c\u63d0\u4f9b\u3059\u308b\u3001\u30a2\u30d7\u30ea\u958b\u767a\u306b\u7279\u5316\u3057\u305f\u30b5\u30fc\u30d0\u30fc\u30b5\u30a4\u30c9\u6a5f\u80fd\u3092\u63d0\u4f9b\u3059\u308b\u30af\u30e9\u30a6\u30c9\u30b5\u30fc\u30d3\u30b9</p>'+
Forte.Resources.Text.CLOUD_EXTERNAL_BACKEND_DETAIL+'<a href="http://mb.cloud.nifty.com/" target="_blank">http://mb.cloud.nifty.com/</a>',style:"margin-left: 76px;",width:280},{xtype:"component",flex:1},{xtype:"cell.button",ui:"blue",text:Forte.Resources.Text.CLOUD_CREATE_ACCOUNT,width:"ja"===window.LANG?120:130,handler:function(){window.open("http://mb.cloud.nifty.com/signup.htm")}}]}]}).show()},openDeleteCollection:function(a){var b=this;"string"!=typeof a&&(a="");var c=Ext.create("Ext.data.Store",
{fields:["text"],data:b.collections}),e=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.CLOUD_COLLECTION_DELETE,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:400,height:354,bodyStyle:"padding-top: 30px;",bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){e.close()}},{xtype:"cell.button",ui:"red",width:100,text:Forte.Resources.Text.GENERAL_DELETE,handler:function(){var a=this,c=e.getComponent("colName").getValue();
Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.CLOUD_COLLECTION_DELETE_CONFIRM,function(h){"yes"==h&&(a.setDisabled(!0),Forte.API.postCloud("Collection.drop",{_id:c},function(){Forte.API.postCloud("Collection.list",null,b.onGetCollectionList);Ext.getCmp("component:mainpanel").closeTabById("cloud:collection-"+c);Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_COLLECTION_DELETE,Forte.Resources.Text.CLOUD_COLLECTION_DELETE_DONE);e.close()},function(b){a.setDisabled(!1);
Cell.LightMessageBox.alert({title:"Error ("+b.code+")",msg:b.message,minWidth:400,buttons:1})}))})}}],items:[{xtype:"component",html:Forte.Resources.Text.CLOUD_COLLECTION_NAME},{xtype:"cell.combo",itemId:"colName",store:c,editable:!1,value:a,width:320}]}).show()},onGetCollectionList:function(a){var b=Ext.getCmp("component:cloudpanel");b.collections=[];var c=b.getComponent("cloudpanel-cont").getComponent("tree-collection"),a=a.items,e=c.getRootNode().removeAll();if(null==a||0==a.length)b.add({xtype:"component",
itemId:"collectionempty",cls:"cell-collection-notify",html:Forte.Resources.Text.CLOUD_COLLECTION_LIST_EMPTY});else{var f=b.getComponent("collectionempty");f&&b.remove(f);for(f=0;f<a.length;f++){var g={text:a[f]._id,leaf:!0,icon:"/img/new_ide/cloud/ico_db.png"};b.collections.push({text:a[f]._id});e.appendChild(g)}c.reconfigure();c.doLayout();b.getComponent("cloudpanel-cont").doLayout()}},openjQueryDialog:function(a){Cell.LightMessageBox.show({title:Forte.Resources.Text.CLOUD_SELECT_BACKEND,msg:a,buttonUi:["blue",
"light"],buttons:Cell.LightMessageBox.YESNO,fn:function(a){"yes"===a&&MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_PLUGINS))}})}})})();(function(){Ext.define("Forte.CloudUserPanel",{extend:"Cell.panel.remoteGridTab",checkbox:!0,propertyNames:[],initComponent:function(){var a=this;a.storeFields=[{name:"_id",type:"string"},{name:"_username",type:"string"},{name:"_password",type:"string"},{name:"_createdAt",type:"date",dateFormat:"timestamp",convert:msUnixToText},{name:"_updatedAt",type:"date",dateFormat:"timestamp",convert:msUnixToText}];a.columns=a.columns||[{dataIndex:"_id",width:260},{dataIndex:"_username",width:140},{dataIndex:"_password",
width:140},{dataIndex:"_createdAt",width:160},{dataIndex:"_updatedAt",width:160}];for(var b=0;b<a.columns.length;b++)a.columns[b].header="_id"===a.columns[b].dataIndex?"Oid":"_username"===a.columns[b].dataIndex?Forte.Resources.Text.CLOUD_USERNAME:"_password"===a.columns[b].dataIndex?Forte.Resources.Text.CLOUD_PASSWORD:"_createdAt"===a.columns[b].dataIndex?Forte.Resources.Text.CLOUD_CREATED_AT:"_updatedAt"===a.columns[b].dataIndex?Forte.Resources.Text.CLOUD_UPDATED_AT:Ext.htmlEncode(a.columns[b].dataIndex);
Ext.apply(this,{id:"cloud:user",title:Forte.Resources.Text.MAIN_CLOUD_USER_TITLE,iconCls:"ide-setting-cloud-user-icon",dockedItems:[{xtype:"toolbar",dock:"top",itemId:"dockedtop",height:28,layout:"hbox",items:[{xtype:"cell.button",icon:"/img/new_ide/cloud/btn_user_add.png",ui:"embed",text:Forte.Resources.Text.CLOUD_USER_ADD_ITEM,style:"margin-left: 8px",scope:a,width:120,handler:a.openAddNewUser},{xtype:"cell.button",itemId:"deletebtn",icon:"/img/new_ide/cloud/btn_user_delete.png",ui:"embed",text:Forte.Resources.Text.CLOUD_USER_DELETE_ITEM,
disabled:!0,scope:a,width:120,handler:function(){a.openDeleteUser()}},"->",{xtype:"cell.button",cls:"cloud-toolbar-detail",ui:"mini",icon:"/img/new_ide/cloud/icn_col_permission.png",tooltip:Forte.Resources.Text.MAIN_DETAIL_TOOLTIP,scope:a,style:"margin-right: 8px",width:38,handler:a.onDetailMenu}]}]});a.callParent()},onBeforeRender:function(){var a=this,b=!1,c=function(c){b=!0;0<c.getSelection().length?a.down("#deletebtn").setDisabled(!1):a.down("#deletebtn").setDisabled(!0)};a.gridPanel.getSelectionModel().on({select:c,
deselect:c});a.gridPanel.on({itemclick:function(c,f){b?b=!1:a.openItemDetail(f)},itemcontextmenu:function(b,c,g,h,j){a.onItemContextMenu(a,c,g,h,j)}});a.callParent()},onAfterRender:function(){var a=this;Forte.API.postCloud("User.getPropertyNames",null,function(b){for(var c=0;c<b.names.length;c++)a.propertyNames.push({name:b.names[c],key:b.names[c]})});a.callParent()},reload:function(a,b,c,e){var f=this,g=f.reloadParams;g.page=f.page;g.itemsInPage=f.itemsInPage;g.propertyNames=[];"undefined"!==typeof a&&
$.extend(!0,g,a);for(a=0;a<f.columns.length;a++)"undefined"!==typeof f.columns[a].dataIndex&&!inArray(f.columns[a].dataIndex,["_id","_username","_password","_createdAt","_updatedAt"],!0)&&g.propertyNames.push(f.columns[a].dataIndex);"undefined"===typeof b&&(b=f.onListSuccess);Forte.API.postCloud("User.list",g,function(a){b(f,a)},c,e);Forte.API.postCloud("User.getPropertyNames",null,function(a){f.propertyNames=[];for(var b=0;b<a.names.length;b++)f.propertyNames.push({name:a.names[b],key:a.names[b]})})},
onDetailMenu:function(a){var b=this,a=a.getEl().getXY();a[0]-=80;a[1]+=20;(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},items:[{scope:this,text:Forte.Resources.Text.GENERAL_RELOAD,icon:"/img/new_ide/projectPanel/project_tree_reload_icon.png",handler:function(){b.page=1;b.reload()}},{scope:this,text:Forte.Resources.Text.GRIDTAB_ADDPROPERTY_TOOLTIP+"...",icon:"/img/new_ide/cloud/btn_property_show.png",handler:b.openDisplayProperty}]})).showAt(a)},
onItemContextMenu:function(a,b,c,e,f){var c=[f.browserEvent.clientX,f.browserEvent.clientY],g=b.data;f.preventDefault();(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},items:[{scope:a,text:Forte.Resources.Text.GENERAL_SHOWDETAIL,handler:function(){a.openItemDetail({data:g})}},{scope:a,text:Forte.Resources.Text.CLOUD_USER_DELETE_USER,handler:function(){a.openDeleteUser(g._id,g._username)}}]})).showAt(c)},openAddNewUser:function(){var a=this,
b=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.CLOUD_USER_ADD_HEADER,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:400,height:414,bodyStyle:"padding-top: 30px;",bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){b.close()}},{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_ADD,handler:function(){var c=this,e={},f=!1;c.setDisabled(!0);try{e=b.getComponent("properties").getValue()||"{}",
e=JSON.parse(e)}catch(g){c.setDisabled(!1);Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,msg:Forte.Resources.Text.CLOUD_JSON_PARSEERROR(g),minWidth:460,buttons:1});return}Forte.API.postCloud("User.create",{username:b.getComponent("username").getValue(),password:b.getComponent("password").getValue(),properties:e},function(){f=!0;a.reload();Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_USER_CREATED_TITLE,Forte.Resources.Text.CLOUD_USER_CREATED)},null,function(){c.setDisabled(!1);
f&&b.close()})}}],items:[{xtype:"component",html:Forte.Resources.Text.CLOUD_USERNAME+":"},{xtype:"textfield",itemId:"username",editable:!0,emptyText:Forte.Resources.Text.CLOUD_USERNAME_PLACEHOLDER,width:320,style:"margin-bottom: 20px;"},{xtype:"component",html:Forte.Resources.Text.CLOUD_PASSWORD+":"},{xtype:"textfield",itemId:"password",inputType:"password",editable:!0,width:320,style:"margin-bottom: 20px;"},{xtype:"component",html:Forte.Resources.Text.CLOUD_PROPERTIES+":"},{xtype:"cell.acefield",
itemId:"properties",editable:!0,highlightActiveLine:!1,mode:"json",gutter:!0,value:"{}",width:320,height:100,style:"margin-bottom: 20px;"}]}).show()},openDeleteUser:function(a,b){var c=this,e=[],f=Forte.Resources.Text.CLOUD_USER_DELETE_TITLE;if(a)e=[a],f=b?f+("\n"+b+" ("+a+")"):f+("\n"+a);else for(var g=c.gridPanel.getSelectionModel().getSelection(),h=0;h<g.length;h++)e.push(g[h].data._id),f+="\n"+g[h].data._username+" ("+g[h].data._id+")";Cell.LightMessageBox.confirm({buttons:6,buttonUi:["red","light"],
width:480,scope:c,title:Forte.Resources.Text.CLOUD_USER_DELETE_HEADER,msg:f,callback:function(a){"yes"==a&&Forte.API.postCloud("User.delete",{idList:e},function(){c.reload();c.down("#deletebtn").setDisabled(!0);Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_SUCCESS,Forte.Resources.Text.CLOUD_USER_DELETED)})}})},onListSuccess:function(a,b){for(var c=0;c<b.items.length;c++)b.items[c]._password="**********";a.superclass.onListSuccess(a,b);0===Object.keys(a.gridItems).length?a.getComponent("noitems")||
a.add(Ext.create("Ext.Component",{itemId:"noitems",cls:"tab-grid-empty",html:Forte.Resources.Text.CLOUD_USER_EMPTY})):(c=a.getComponent("noitems"))&&a.remove(c)},openItemDetail:function(a){var b=this,a=a.data._id,c=Ext.create("Cell.window.LightWindow",{_id:a,title:"Oid: "+a,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:576,height:464,bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){c.close()}},{xtype:"cell.button",ui:"blue",width:100,
text:Forte.Resources.Text.GENERAL_UPDATE,handler:function(){var a=this,f={},g=!1;a.setDisabled(!0);try{f=c.getComponent("itemdetail").getValue()||"{}",f=JSON.parse(f)}catch(h){a.setDisabled(!1);Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,msg:Forte.Resources.Text.CLOUD_JSON_PARSEERROR(h),minWidth:460,buttons:1});return}"**********"===f._password&&delete f._password;Forte.API.postCloud("User.update",{_id:c._id,user:f},function(){g=!0;b.reload();Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_SUCCESS,
Forte.Resources.Text.CLOUD_USER_UPDATED)},null,function(){a.setDisabled(!1);g&&c.close()})}}],items:[{xtype:"cell.acefield",itemId:"itemdetail",editable:!0,highlightActiveLine:!1,mode:"json",gutter:!0,width:496,height:300,style:"margin-top: 30px;",value:Forte.Resources.Text.CLOUD_USER_DATA_FETCHING},{xtype:"cell.button",ui:"light",hidden:"undefined"===typeof chrome||!chrome.app.isInstalled,text:Forte.Resources.Text.CLOUD_COLLECTION_COPY_TO_CLIPBOARD,handler:function(){c.getComponent("itemdetail").copyAll()}}]}).show();
Forte.API.postCloud("User.get",{_id:a},function(a){a.user._password="**********";c.getComponent("itemdetail").setValue(JSON.stringify(a.user,null," "))})},saveSettings:function(){for(var a=[],b=0;b<this.columns.length;b++){a[b]={};for(var c in this.columns[b])if("header"===c||"dataIndex"===c||"width"===c)a[b][c]=this.columns[b][c]}Forte.API.saveBackendSettings({userPanel:{display:a}})}})})();(function(){Ext.define("ItemPermissionCombo",{extend:"Ext.data.Model",fields:["_id","_username","text"]});Ext.define("Forte.CloudCollectionPanel",{extend:"Cell.panel.remoteGridTab",colName:null,colConfig:{},checkbox:!0,propertyNames:[],users:[],isItemBtnClicked:!1,initComponent:function(){var a=this;a.storeFields=[{name:"_id",type:"string"},{name:"_ownerUserOid",type:"string"},{name:"_ownerDeviceOid",type:"string"},{name:"_permission",convert:a.permissionStringify},{name:"_createdAt",type:"date",
dateFormat:"timestamp",convert:msUnixToText},{name:"_updatedAt",type:"date",dateFormat:"timestamp",convert:msUnixToText},{name:"permission"}];a.columns=a.columns||[{dataIndex:"_id",width:260},{dataIndex:"_ownerUserOid",width:140},{dataIndex:"_createdAt",width:160},{dataIndex:"_updatedAt",width:160}];for(var b=0;b<a.columns.length;b++)a.columns[b].header="_id"===a.columns[b].dataIndex?"Oid":"_ownerUserOid"===a.columns[b].dataIndex?Forte.Resources.Text.CLOUD_OWNER_USER:"_createdAt"===a.columns[b].dataIndex?
Forte.Resources.Text.CLOUD_CREATED_AT:"_updatedAt"===a.columns[b].dataIndex?Forte.Resources.Text.CLOUD_UPDATED_AT:Ext.htmlEncode(a.columns[b].dataIndex);"actioncolumn"===a.columns[a.columns.length-1].xtype&&a.columns.splice(a.columns.length-1,1);a.columns.push({xtype:"actioncolumn",draggable:!1,header:Forte.Resources.Text.CLOUD_PERMISSION,flex:1,stopSelection:!0,items:[{icon:"/img/new_ide/cloud/ico_item_permission.png",tooltip:Forte.Resources.Text.CLOUD_PERMISSION,scope:a,handler:a.openItemPermission}]});
Ext.apply(this,{id:"cloud:collection-"+a.colName,cls:"tab-grid cloud-collection",title:a.colName,iconCls:"ide-setting-cloud-db-icon",dockedItems:[{xtype:"toolbar",dock:"top",height:28,itemId:"dockedtop",layout:"hbox",items:[{xtype:"cell.button",icon:"/img/new_ide/cloud/btn_user_add.png",ui:"embed",text:Forte.Resources.Text.CLOUD_COLLECTION_ADD_ITEM,style:"margin-left: 8px",scope:a,width:120,handler:a.openAddNewItem},{xtype:"cell.button",itemId:"deletebtn",icon:"/img/new_ide/cloud/btn_user_delete.png",
ui:"embed",text:Forte.Resources.Text.CLOUD_COLLECTION_DELETE_ITEM,disabled:!0,scope:a,width:120,handler:function(){a.openDeleteItem()}},"->",{xtype:"cell.button",cls:"cloud-toolbar-detail",ui:"mini",icon:"/img/new_ide/cloud/icn_col_permission.png",tooltip:Forte.Resources.Text.MAIN_DETAIL_TOOLTIP,scope:a,style:"margin-right: 8px",width:38,handler:a.onDetailMenu}]}]});a.callParent()},onBeforeRender:function(){var a=this,b=!1,c=function(c){b=!0;0<c.getSelection().length?a.down("#deletebtn").setDisabled(!1):
a.down("#deletebtn").setDisabled(!0)};a.gridPanel.getSelectionModel().on({select:c,deselect:c});a.gridPanel.addColumn=function(b){var c=a.gridPanel.headerCt;c.insert(c.headerCounter-1,b)};a.gridPanel.on({itemclick:function(c,f,g){b?b=!1:a.isItemBtnClicked||a.openItemDetail(a,f,g)},itemcontextmenu:function(b,c,g,h,j){a.onItemContextMenu(a,c,g,h,j)}});a.gridPanel.headerCt.on({render:function(){a.gridPanel.headerCt.reorderer.dropZone.onNodeOver=function(b,c,g,h){c=this.getLocation(g,b);h.header.el.dom!==
b&&this.positionIndicator(h.header,b,g);c.header.getIndex()>=a.columns.length&&(this.valid=!1);return this.valid?this.dropAllowed:this.dropNotAllowed}}});a.callParent()},onAfterRender:function(){var a=this;Forte.API.postCloud("Collection.getPropertyNames",{_id:a.colName},function(b){for(var c=0;c<b.names.length;c++)a.propertyNames.push({name:b.names[c],key:b.names[c]})});a.callParent()},reload:function(a,b,c,e){var f=this,g=f.reloadParams;g.collectionName=f.colName;g.page=f.page;g.itemsInPage=f.itemsInPage;
g.propertyNames=[];"undefined"!==typeof a&&$.extend(!0,g,a);for(a=0;a<f.columns.length;a++)"undefined"!==typeof f.columns[a].dataIndex&&!inArray(f.columns[a].dataIndex,"_id _ownerUserOid _ownerDeviceOid _permission _createdAt _updatedAt".split(" "),!0)&&g.propertyNames.push(f.columns[a].dataIndex);"undefined"===typeof b&&(b=f.onListSuccess);Forte.API.postCloud("CollectionItem.list",g,function(a){b(f,a);if(Object.keys(f.gridItems).length===0)f.getComponent("noitems")||f.add(Ext.create("Ext.Component",
{itemId:"noitems",cls:"tab-grid-empty",html:Forte.Resources.Text.CLOUD_COLLECTION_EMPTY}));else(a=f.getComponent("noitems"))&&f.remove(a)},c,e);Forte.API.postCloud("Collection.getConfig",{_id:f.colName},function(a){f.colConfig=a.config});Forte.API.postCloud("Collection.getPropertyNames",{_id:f.colName},function(a){f.propertyNames=[];for(var b=0;b<a.names.length;b++)f.propertyNames.push({name:a.names[b],key:a.names[b]})})},onDetailMenu:function(a){var b=this,a=a.getEl().getXY();a[0]-=190;a[1]+=18;
(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},items:[{scope:this,icon:"/img/new_ide/projectPanel/project_tree_reload_icon.png",text:Forte.Resources.Text.GENERAL_RELOAD,handler:function(){b.page=1;b.reload()}},{scope:this,icon:"/img/new_ide/header/settings_icon.png",text:Forte.Resources.Text.CLOUD_COLLECTION_PERMISSION,handler:b.openCollectionPermission},{scope:this,text:Forte.Resources.Text.GRIDTAB_ADDPROPERTY_TOOLTIP+"...",icon:"/img/new_ide/cloud/btn_property_show.png",
handler:b.openDisplayProperty}]})).showAt(a)},onItemContextMenu:function(a,b,c,e,f){c=b.data;b=[f.browserEvent.clientX,f.browserEvent.clientY];f.preventDefault();(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},items:[{scope:a,text:Forte.Resources.Text.GENERAL_SHOWDETAIL,handler:function(){a.openItemDetail(a,{data:c})}},{scope:a,text:Forte.Resources.Text.CLOUD_COLLECTION_DELETE_THIS_ITEM,handler:function(){a.openDeleteItem(c._id)}}]})).showAt(b)},
openCollectionPermission:function(){Ext.create("Cell.window.CollectionSecurityWindow",{colName:this.colName,colConfig:this.colConfig}).show()},openItemPermission:function(a,b){var c=this,e=a.getStore().getAt(b).get("_id"),f=c.gridItems[e];c.isItemBtnClicked=!0;var g={xtype:"container",itemId:"permissions",layout:"vbox",width:495,height:30,defaults:{width:495,height:30},style:"margin-top: 30px;",items:[]};g.items.push(c.makePermissionField(Forte.Resources.Text.CLOUD_COLLECTION_ITEM_OWNER,"rw"));for(var h in f._permission)g.height+=
30,g.items.push(c.makePermissionField(h,f._permission[h])),"public"!==h&&Forte.API.postCloud("User.get",{_id:h},function(a){$(".plabel-"+a.user._id).attr("title",a.user._username)},function(){});var j=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.CLOUD_SET_PERMISSION_TITLE(e),cls:"cell-window-vscrollable",closable:!0,resizable:!1,layout:"vbox",modal:!0,width:576,height:382,listeners:{close:function(){c.isItemBtnClicked=!1}},bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,
handler:function(){j.close()}},{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_SAVE,handler:function(){var a=this,b={},f=j.down("#permissions"),g=!1;a.setDisabled(!0);for(var h=0;h<f.items.items.length;h++){var r=f.items.items[h],o="";r.Oid!==Forte.Resources.Text.CLOUD_COLLECTION_ITEM_OWNER&&(o+=r.items.items[1].checked?"r":"",o+=r.items.items[2].checked?"w":"",b[r.Oid]=o)}Forte.API.postCloud("CollectionItem.setPermission",{collectionName:c.colName,_id:e,permission:b},function(){g=
!0;c.reload();Cell.LightMessageBox.alert("Success",Forte.Resources.Text.CLOUD_COLLECTION_ITEM_UPDATED)},null,function(){a.setDisabled(!1);g&&j.close()})}}],items:[g,{xtype:"fieldset",title:Forte.Resources.Text.CLOUD_COLLECTION_ADD_NEW_PERMISSION,layout:"hbox",width:496,height:84,defaults:{style:"margin-right:15px; vartical-align: middle;"},items:[{xtype:"cell.remotecombo",itemId:"newuserid",valueField:"id",store:{fields:["id","_username","text"],data:[]},width:250,style:"margin: 0 15px 0 4px;",fetch:function(a,
b,c){Forte.API.postCloud("User.list",{page:1,itemsInPage:20,nameFilter:c},function(a){for(var c=[],e=0;e<a.items.length;e++)c.push(Ext.create("ItemPermissionCombo",{id:a.items[e]._id,_username:a.items[e]._username,text:Ext.htmlEncode(a.items[e]._username+" ("+a.items[e]._id+")")}));b(c)})}},{xtype:"checkbox",itemId:"newuserread",boxLabel:"read",editable:!0,style:"margin: 4px 15px 0 0;"},{xtype:"checkbox",itemId:"newuserwrite",boxLabel:"write",editable:!0,style:"margin: 4px 15px 0 0;"},{xtype:"cell.button",
text:Forte.Resources.Text.GENERAL_ADD,ui:"light",scope:c,style:"margin: 2px 0 0 0;",handler:function(){var a="",b=j.down("#permissions");j.down("#newuserread").getValue()&&(a+="r");j.down("#newuserwrite").getValue()&&(a+="w");var c=j.down("#newuserid"),e=c.store.getById(c.getValue()).data._username;b.add(this.makePermissionField(c.getValue(),a,e));b.setHeight(b.getHeight()+30)}}]}]}).show()},makePermissionField:function(a,b,c){c="undefined"!==typeof c?'title="'+c+'"':"";a=Ext.htmlEncode(a);return{xtype:"container",
layout:"hbox",Oid:a,items:[{xtype:"component",width:300,html:'<span class="plabel-'+a+'" '+c+">"+a+"</span>",style:"margin: 2px 15px 0 4px;"},{xtype:"checkbox",boxLabel:"read",checked:0<=b.indexOf("r"),disabled:a===Forte.Resources.Text.CLOUD_COLLECTION_ITEM_OWNER,editable:!0,style:"margin: 0 15px 0 0;"},{xtype:"checkbox",boxLabel:"write",checked:0<=b.indexOf("w"),disabled:a===Forte.Resources.Text.CLOUD_COLLECTION_ITEM_OWNER,editable:!0,style:"margin: 0 15px 0 0;"},{xtype:"button",ui:"embed",icon:"/img/new_ide/cloud/btn_user_delete.png",
width:24,height:24,hidden:a===Forte.Resources.Text.CLOUD_COLLECTION_ITEM_OWNER||"public"===a,handler:function(){var a=this.ownerCt.ownerCt;this.ownerCt.destroy();a.setHeight(a.getHeight()-30)}}]}},openItemDetail:function(a,b){var c=b.data._id,e=Ext.create("Cell.window.LightWindow",{_id:c,title:"Oid: "+c,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:576,height:464,bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){e.close()}},{xtype:"cell.button",
ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_UPDATE,handler:function(){var b=this,c={},h=!1;b.setDisabled(!0);try{c=e.getComponent("itemdetail").getValue()||"{}",c=JSON.parse(c)}catch(j){b.setDisabled(!1);Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,msg:Forte.Resources.Text.CLOUD_JSON_PARSEERROR(j),minWidth:460,buttons:1});return}for(var k in c)0===k.indexOf("_")&&delete c[k];Forte.API.postCloud("collectionItem.update",{collectionName:a.colName,_id:e._id,item:c},function(){h=
!0;a.reload();Cell.LightMessageBox.alert("Success",Forte.Resources.Text.CLOUD_COLLECTION_ITEM_UPDATED)},null,function(){b.setDisabled(!1);h&&e.close()})}}],items:[{xtype:"component",style:"margin: 20px 0;",html:Forte.Resources.Text.CLOUD_COLLECTION+": "+a.colName},{xtype:"component",style:"margin: 0 0 3px 0;",html:Forte.Resources.Text.CLOUD_COLLECTION_ITEM_EXPR},{xtype:"cell.acefield",itemId:"itemdetail",editable:!0,highlightActiveLine:!1,mode:"json",gutter:!0,value:Forte.Resources.Text.CLOUD_COLLECTION_ITEM_LOADING,
width:496,height:240,style:"margin-bottom: 5px;"},{xtype:"cell.button",ui:"light",hidden:"undefined"===typeof chrome||!chrome.app.isInstalled,text:Forte.Resources.Text.CLOUD_COLLECTION_COPY_TO_CLIPBOARD,handler:function(){e.getComponent("itemdetail").copyAll()}}]}).show();Forte.API.postCloud("CollectionItem.get",{collectionName:a.colName,_id:c},function(a){e.getComponent("itemdetail").setValue(JSON.stringify(a.item,null," "))})},openAddNewItem:function(){var a=this,b=this.colName,c=Ext.create("Cell.window.LightWindow",
{title:Forte.Resources.Text.CLOUD_COLLECTION_ADD_ITEM_TITLE,closable:!0,resizable:!1,layout:"vbox",modal:!0,width:500,height:500,bodyStyle:"padding-top: 20px;",bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){c.close()}},{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_ADD,handler:function(){var e=this,f={},g=!1;e.setDisabled(!0);try{f=c.getComponent("properties").getValue()||"{}",f=JSON.parse(f)}catch(h){e.setDisabled(!1);
Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,msg:Forte.Resources.Text.CLOUD_JSON_PARSEERROR(h),minWidth:460,buttons:1});return}Forte.API.postCloud("CollectionItem.create",{collectionName:b,item:f},function(){g=!0;a.reload();Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_COLLECTION_ITEM_CREATED_TITLE,Forte.Resources.Text.CLOUD_COLLECTION_ITEM_CREATED)},null,function(){e.setDisabled(!1);g&&c.close()})}}],items:[{xtype:"component",html:Forte.Resources.Text.CLOUD_COLLECTION+
": "+a.colName,style:"margin-bottom: 20px;"},{xtype:"component",html:Forte.Resources.Text.CLOUD_PROPERTIES+":"},{xtype:"cell.acefield",itemId:"properties",editable:!0,highlightActiveLine:!1,mode:"json",gutter:!0,value:"{}",width:420,height:310,style:"margin-bottom: 20px;"}]}).show()},openDeleteItem:function(a){var b=this,c=[],e=Forte.Resources.Text.CLOUD_COLLECTION_ITEM_DELETE_TITLE;if(a)c=[a],e+="\n"+a;else for(var a=b.gridPanel.getSelectionModel().getSelection(),f=0;f<a.length;f++)c.push(a[f].data._id),
e+="\n"+a[f].data._id;Cell.LightMessageBox.confirm({buttons:6,buttonUi:["red","light"],width:400,scope:b,title:Forte.Resources.Text.CLOUD_DELETE_ITEM,msg:e,callback:function(a){"yes"==a&&Forte.API.postCloud("CollectionItem.delete",{collectionName:b.colName,idList:c},function(){b.reload();b.down("#deletebtn").setDisabled(!0);Cell.LightMessageBox.alert("Success",Forte.Resources.Text.CLOUD_COLLECTION_ITEM_DELETED)})}})},permissionStringify:function(a){var b="{",c=0;for(key in a)0<c&&(b+=", "),b+=key+
":"+a[key],c++;return b+"}"},saveSettings:function(){for(var a=[],b=0;b<this.columns.length-1;b++){a[b]={};for(var c in this.columns[b])if("dataIndex"===c||"width"===c)a[b][c]=this.columns[b][c]}b={collectionPanel:{}};b.collectionPanel[this.colName]={display:a};Forte.API.saveBackendSettings(b)}})})();(function(){Ext.define("Forte.CloudPushHistoryPanel",{extend:"Cell.panel.remoteGridTab",checkbox:!1,propertyNames:[{name:Forte.Resources.Text.PUSH_HISTORY_DESTINATION,key:"is_debugger"},{name:Forte.Resources.Text.PUSH_HISTORY_STATUS,key:"status"},{name:Forte.Resources.Text.PUSH_HISTORY_DATE,key:"created_at"},{name:Forte.Resources.Text.PUSH_HISTORY_MESSAGE,key:"message"},{name:Forte.Resources.Text.PUSH_HISTORY_DEVICES,key:"devices"},{name:"JSON",key:"extra_json"},{name:Forte.Resources.Text.PUSH_HISTORY_TITLE,
key:"title"},{name:Forte.Resources.Text.PUSH_HISTORY_PLATFORM,key:"platform"},{name:Forte.Resources.Text.PUSH_HISTORY_BADGENUMBER,key:"badge_number"}],initComponent:function(){var a=this,b=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#fff",className:"spinner spinner-setting-load"})).spin();a.loadmask=new Ext.LoadMask(a,{msg:b.el.outerHTML});a.storeFields=[{name:"is_debugger",type:"boolean",convert:function(a){return a?"Debugger":"App"}},{name:"build_type",type:"string",convert:function(a){switch(a){case "debug":return Forte.Resources.Text.CLOUD_PUSH_BUILDTYPE_DEBUG;
case "adhoc":return Forte.Resources.Text.CLOUD_PUSH_BUILDTYPE_ADHOC;case "release":return Forte.Resources.Text.CLOUD_PUSH_BUILDTYPE_RELEASE;default:return Forte.Resources.Text.CLOUD_PUSH_STATUS_UNKNOWN}}},{name:"status",type:"string",convert:function(a){switch(a){case "new":return Forte.Resources.Text.CLOUD_PUSH_STATUS_NEW;case "process":return Forte.Resources.Text.CLOUD_PUSH_STATUS_PROCESS;case "finish":return Forte.Resources.Text.CLOUD_PUSH_STATUS_FINISH;case "refuse":return Forte.Resources.Text.CLOUD_PUSH_STATUS_REFUSE;
case "postpone":return Forte.Resources.Text.CLOUD_PUSH_STATUS_POSTPONE;default:return Forte.Resources.Text.CLOUD_PUSH_STATUS_UNKNOWN}}},{name:"created_at",type:"date",dateFormat:"timestamp",convert:unixToText},{name:"message",type:"string"},{name:"devices",type:"string"},{name:"extra_json",type:"string"},{name:"title",type:"string"},{name:"platform",type:"string",convert:function(a){switch(a){case "android":return"Android";case "ios":return"iOS";default:return a}}},{name:"has_badge",type:"boolean"},
{name:"badge_number",type:"int"}];a.columns=[{dataIndex:"is_debugger",header:Forte.Resources.Text.PUSH_HISTORY_DESTINATION,width:100},{dataIndex:"platform",header:Forte.Resources.Text.PUSH_HISTORY_PLATFORM,width:100},{dataIndex:"status",header:Forte.Resources.Text.PUSH_HISTORY_STATUS,width:100},{dataIndex:"created_at",header:Forte.Resources.Text.PUSH_HISTORY_DATE,width:160},{dataIndex:"devices",header:Forte.Resources.Text.PUSH_HISTORY_DEVICES,width:160},{dataIndex:"message",header:Forte.Resources.Text.PUSH_HISTORY_MESSAGE,
flex:1,minWidth:100}];Ext.apply(this,{id:"cloud:pushhistory",cls:"tab-grid cloud-push",title:Forte.Resources.Text.PUSH_APP_HISTORY,iconCls:"ide-setting-cloud-push-icon",dockedItems:[{xtype:"toolbar",dock:"top",height:28,itemId:"dockedtop",layout:"hbox",items:[{xtype:"cell.button",icon:"/img/new_ide/push/ico_send_new_push.png",ui:"embed",text:Forte.Resources.Text.PUSH_TO_APP,scope:a,width:160,margin:"0 0 0 4",handler:function(){a.openNewPushDialog(!1)}},"->",{xtype:"cell.button",ui:"mini",cls:"cloud-toolbar-reload",
text:Forte.Resources.Text.GENERAL_RELOAD,scope:a,icon:"/img/new_ide/projectPanel/project_tree_reload_icon.png",style:"margin-right: 15px;",handler:function(){this.page=1;this.reload()}},{xtype:"cell.button",cls:"cloud-toolbar-detail",ui:"mini",icon:"/img/new_ide/cloud/icn_col_permission.png",tooltip:Forte.Resources.Text.MAIN_DETAIL_TOOLTIP,scope:a,style:"margin-right: 8px",width:38,handler:a.onDetailMenu}]}]});a.callParent()},onBeforeRender:function(){var a=this,b=!1,c=function(){b=!0};a.gridPanel.getSelectionModel().on({select:c,
deselect:c});a.gridPanel.on({itemclick:function(c,f,g){b?b=!1:a.openItemDetail(a,f,g)},itemcontextmenu:function(b,c,g,h,j){a.onItemContextMenu(a,c,g,h,j)}});a.callParent()},reload:function(a,b,c,e){var f=this,a={is_debugger:-1,page:f.page,page_count:f.itemsInPage,sortProperty:f.reloadParams.sortProperty,sortOrder:"asc"===f.reloadParams.sortOrder?1:-1},b=b||f.onListSuccess,c=c||function(){},e=e||function(){};$.getJSON("/api/project/"+Forte.API.projectId+"/push/history/",Forte.API.addApiTokenToParams(a)).success(function(a){"ok"==
a.status?b(f,{items:a.result.queues,totalItems:a.result.queue_count}):c(a.code,a.message)}).error(function(){c()}).always(function(){e()})},onDetailMenu:function(a){a=a.getEl().getXY();a[0]-=190;a[1]+=18;(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},items:[{text:Forte.Resources.Text.PUSH_APP_CONFIG+"...",icon:"/img/new_ide/header/settings_icon.png",handler:function(){Ext.getCmp("component:mainpanel").createTabSettingCloud(1)}},{scope:this,
text:Forte.Resources.Text.GRIDTAB_ADDPROPERTY_TOOLTIP+"...",icon:"/img/new_ide/cloud/btn_property_show.png",handler:this.openDisplayProperty}]})).showAt(a)},onItemContextMenu:function(a,b,c,e,f){c=b.data;b=[f.browserEvent.clientX,f.browserEvent.clientY];f.preventDefault();(new Cell.menu.ContextMenu({closeAction:"destroy",style:{overflow:"visible"},listeners:{hide:this.destroy},items:[{scope:a,text:Forte.Resources.Text.GENERAL_SHOWDETAIL,handler:function(){a.openItemDetail(a,{data:c})}}]})).showAt(b)},
openCollectionPermission:function(){Ext.create("Cell.window.CollectionSecurityWindow",{colName:this.colName,colConfig:this.colConfig}).show()},openNewPushDialog:function(a){var b=this,c=[],c=a?[{text:"Android Debugger",value:"android_debugger_debug"},{text:"iOS Debugger",value:"ios_debugger_debug"}]:[{text:"Android App (Debug)",value:"android_app_debug"},{text:"Android App (Release)",value:"android_app_release"},{text:"iOS App (Debug)",value:"ios_app_debug"},{text:"iOS App (Adhoc)",value:"ios_app_adhoc"},
{text:"iOS App (Release)",value:"ios_app_release"}],e=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.PUSH_TO_DEBUGGER,isDebugger:a,cls:"cloud-window-new-push",closable:!0,resizable:!1,layout:"vbox",modal:!0,width:700,height:600,bodyStyle:"padding-top: 30px;",reqValidateTimer:null,listeners:{afterrender:function(a){a.isDebugger?a.setTitle(Forte.Resources.Text.PUSH_TO_DEBUGGER):a.setTitle(Forte.Resources.Text.PUSH_TO_APP);$(a.getEl().dom).on("change keyup","input,textarea",function(){a.reqValidateTimer&&
clearTimeout(a.reqValidateTimer);a.reqValidateTimer=setTimeout(function(){a.validate(a,a.getSerialized(a.getComponent("senddata"),a.getComponent("platform").getValue()))},500,a)})}},bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){e.close()}},{xtype:"cell.button",itemId:"submit",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_ADD,disabled:!0,handler:function(){var a=this;e.getComponent("senddata");a.setDisabled(!0);var c=this;Cell.LightMessageBox.confirm({title:Forte.Resources.Text.CLOUD_PUSH,
msg:Forte.Resources.Text.CLOUD_PUSH_SEND_CONFIRM,buttons:Cell.LightMessageBox.YESNO,buttonUi:["blue","light"],fn:function(a){"yes"==a&&c.submitPush()}});this.submitPush=function(){var c=b.loadmask.el.dom.style.zIndex,g=b.loadmask.el.dom.style.opacity;b.loadmask.el.dom.style.zIndex=99999;b.loadmask.el.dom.style.opacity=0.8;b.loadmask.show();$.ajax(Forte.API.getAPIUrl("/api/project/:project_id/push/saveQueue"),{type:"POST",data:{api_token:Forte.API.apiToken,form:e.getSerialized(e.getComponent("senddata"),
e.getComponent("platform").getValue())},dataType:"json"}).done(function(k){b.loadmask.el.dom.style.zIndex=c;b.loadmask.el.dom.style.opacity=g;b.loadmask.hide();"ok"==k.status?(Cell.LightMessageBox.alert(Forte.Resources.Text.CLOUD_PUSH,Forte.Resources.Text.CLOUD_PUSH_SEND_COMPLETE),b.reload(),a.setDisabled(!1),clearInterval(e.reqValidateTimer),e.close()):"needs-upgrade"==k.message?Ext.create("Cell.window.RestrictionDialog").showWindow("PUSH_NOTIFICATION"):(Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,
msg:k.message,minWidth:400,buttons:1}),a.setDisabled(!1))}).fail(function(e,m,n){b.loadmask.el.dom.style.zIndex=c;b.loadmask.el.dom.style.opacity=g;b.loadmask.hide();Cell.LightMessageBox.alert({title:Forte.Resources.Text.GENERAL_ERROR,msg:n?n:m,minWidth:400,buttons:1});a.setDisabled(!1)})}}}],items:[{xtype:"cell.combo",itemId:"platform",allowBlank:!0,editable:!1,emptyText:Forte.Resources.Text.PUSH_SELECT_PLATFORM,style:"margin-bottom: 30px;",valueField:"value",width:200,listeners:{change:function(a){var a=
a.getValue(),b=e.getComponent("recipients"),c=e.getComponent("senddata");c.setDisabled(!1);switch(a){case "android_debugger_debug":e.showRecipients(b,!0,"android","debug");c.getComponent("title").show();c.getComponent("badge").hide();break;case "ios_debugger_debug":e.showRecipients(b,!0,"ios","debug");c.getComponent("title").hide();c.getComponent("badge").show();break;case "android_app_debug":e.showRecipients(b,!1,"android","debug");c.getComponent("title").show();c.getComponent("badge").hide();break;
case "ios_app_debug":e.showRecipients(b,!1,"ios","debug");c.getComponent("title").hide();c.getComponent("badge").show();break;case "ios_app_adhoc":e.showRecipients(b,!1,"ios","adhoc");c.getComponent("title").hide();c.getComponent("badge").show();break;case "android_app_release":e.showRecipients(b,!1,"android","release");c.getComponent("title").show();c.getComponent("badge").hide();break;case "ios_app_release":e.showRecipients(b,!1,"ios","release"),c.getComponent("title").hide(),c.getComponent("badge").show()}}},
store:{fields:["text","value"],data:c}},{xtype:"fieldset",itemId:"senddata",disabled:!0,title:Forte.Resources.Text.CLOUD_PUSH_MESSAGE_DETAIL,width:620,defaults:{width:320},items:[{xtype:"textfield",itemId:"title",editable:!0,emptyText:Forte.Resources.Text.CLOUD_PUSH_TITLE_ANDROID,style:"margin-bottom: 15px;"},{xtype:"textarea",itemId:"message",editable:!0,emptyText:Forte.Resources.Text.CLOUD_PUSH_MESSAGE,style:"margin-bottom: 15px;"},{xtype:"container",itemId:"badge",hidden:!0,layout:"hbox",items:[{xtype:"checkbox",
itemId:"sendbadge",boxLabel:Forte.Resources.Text.CLOUD_PUSH_BADGE,boxLabelAlign:"after",style:"margin: 3px 8px 0 0;",listeners:{change:function(a,b){b?e.down("#badgenum").setDisabled(!1):e.down("#badgenum").setDisabled(!0)}}},{xtype:"textfield",itemId:"badgenum",margin:0,disabled:!0}]},{xtype:"cell.acefield",itemId:"extrajson",editable:!0,emptyText:Forte.Resources.Text.CLOUD_PUSH_JSON,fieldLabel:"JSON",labelAlign:"top",highlightActiveLine:!1,mode:"json",gutter:!0,value:"{}",height:140,style:"margin-bottom: 20px;"}]},
{xtype:"component",itemId:"errors",cls:"cell-error"},{xtype:"component",itemId:"recipients",cls:"cloud-push-recipients"}],getSerialized:function(a,b){var c,e,k;e=b.split("_");c=e[0];k="debugger"===e[1]?!0:!1;e=e[2];switch(c){case "android":return[{name:"is_debugger",value:k?1:0},{name:"platform",value:c},{name:"build_type",value:e},{name:"title",value:a.getComponent("title").getValue()},{name:"message",value:a.getComponent("message").getValue()},{name:"extra_json",value:a.getComponent("extrajson").getValue()}];
case "ios":var m=a.getComponent("badge");return[{name:"is_debugger",value:k?1:0},{name:"platform",value:c},{name:"build_type",value:e},{name:"has_badge",value:m.getComponent("sendbadge").getValue()?"1":"0"},{name:"badge_number",value:m.getComponent("badgenum").getValue()},{name:"message",value:a.getComponent("message").getValue()},{name:"extra_json",value:a.getComponent("extrajson").getValue()}]}},validate:function(a,b){$.ajax(Forte.API.getAPIUrl("/api/project/:project_id/push/validate"),{data:{api_token:Forte.API.apiToken,
form:b},dataType:"json",type:"POST"}).done(function(b){$field=$(a.getComponent("errors").getEl().dom);$field.empty();if(b.result.error){for(var c in b.result.errorMessages)$field.append(b.result.errorMessages[c]+"\n");a.down("#submit").setDisabled(!0)}else a.down("#submit").setDisabled(!1)})},showRecipients:function(a,b,c,e){$.ajax(Forte.API.getAPIUrl("/api/project/:project_id/push/recipients"),{data:{is_debugger:b,platform:c,build_type:e,api_token:Forte.API.apiToken},dataType:"json",type:"POST"}).done(function(c){var e=
$(a.getEl().dom);e.empty();e.text(Forte.Resources.Text.CLOUD_PUSH_RECIPIENTS_FOUND(c.result.recipientCount));if(b&&0<c.result.recipientCount){for(var h=$("<ul />"),j=0;j<c.result.recipients.length;j++){var l=c.result.recipients[j];h.append('<li><span class="recipient-name">- '+l.description+'</span><br><span class="recipient-date">('+(new Date(1E3*(l.updatedAt?l.updatedAt:l.registeredAt))).toLocaleString()+")</span></li>")}e.append(h)}})}}).show()},openItemDetail:function(a,b){var c="<table>",e;for(e in b.data){var f=
"";switch(e){case "has_badge":continue;case "is_debugger":f=Forte.Resources.Text.PUSH_HISTORY_DESTINATION;break;case "build_type":f=Forte.Resources.Text.CLOUD_PUSH_BUILDTYPE;break;case "status":f=Forte.Resources.Text.PUSH_HISTORY_STATUS;break;case "title":if(!b.data.title)continue;f=Forte.Resources.Text.PUSH_HISTORY_TITLE;break;case "message":f=Forte.Resources.Text.PUSH_HISTORY_MESSAGE;break;case "extra_json":f="JSON";break;case "devices":f=Forte.Resources.Text.PUSH_HISTORY_DEVICES;break;case "badge_number":if(!1===
b.data.has_badge)continue;f=Forte.Resources.Text.PUSH_HISTORY_BADGENUMBER;break;case "platform":f=Forte.Resources.Text.PUSH_HISTORY_PLATFORM;break;case "created_at":f=Forte.Resources.Text.PUSH_HISTORY_DATE;break;default:f=e}c+="<tr><th>"+f+":</th><td>"+b.data[e]+"</td></tr>"}var g=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.CLOUD_PUSH_HISTORY,cls:"cell-push-history-detail",closable:!0,resizable:!1,layout:"vbox",modal:!0,width:420,height:360,bbar:["->",{xtype:"cell.button",ui:"light",
width:100,text:Forte.Resources.Text.GENERAL_CLOSE,handler:function(){g.close()}}],items:[{xtype:"component",html:c+"</table>",width:496,height:240,style:"margin: 20px 0;"}]}).show()},saveSettings:function(){}})})();Ext.define("MailTemplateCombo",{extend:"Ext.data.Model",fields:"_id subject from bcc body createdAt updatedAt".split(" ")});
(function(){Ext.define("Forte.CloudMailTemplatePanel",{extend:"Ext.form.Panel",alias:"widget.cloudMailTemplatePanel",templates:{},initComponent:function(){var a=this;a.reload();Ext.apply(this,{id:"cloud:mailtemplate",title:Forte.Resources.Text.CLOUD_MAILTEMPLATE,closable:!0,iconCls:"ide-setting-cloud-mail-icon",layout:"vbox",flex:1,height:490,listeners:{afterRender:function(){Message.MainPanel.PopTabQueue.send()}},defaults:{xtype:"textfield",editable:!0,width:480,labelWidth:150,allowBlank:!0},items:[{xtype:"component",
cls:"cell-title",html:Forte.Resources.Text.CLOUD_MAILTEMPLATE},{xtype:"cell.combo",itemId:"templateName",fieldLabel:Forte.Resources.Text.CLOUD_MAILTEMPLATE_NAME,allowBlank:!0,displayField:"_id",store:{fields:"_id subject from bcc body createdAt updatedAt".split(" "),data:[]},width:340,labelWidth:150,style:"margin-right: 20px;",listeners:{afterrender:function(b){b.getEl().on("keyup",function(){var b=a.down("#submit"),e=a.down("#delete"),f=a.down("#templateName").getValue();null!==f?b.setDisabled(!1):
b.setDisabled(!0);f in a.templates?e.setDisabled(!1):e.setDisabled(!0)})},select:function(b,c){var e=a.templates[c[0].data._id];a.down("#submit").setDisabled(!1);a.getComponent("subject").setValue(e.subject);a.getComponent("from").setValue(e.from);a.getComponent("bcc").setValue(e.bcc);a.getComponent("body").setValue(e.body);a.down("#delete").setDisabled(!1)}}},{itemId:"subject",fieldLabel:Forte.Resources.Text.CLOUD_MAILTEMPLATE_SUBJECT},{itemId:"from",fieldLabel:"From"},{itemId:"bcc",fieldLabel:"Bcc"},
{xtype:"textarea",itemId:"body",fieldLabel:Forte.Resources.Text.CLOUD_MAILTEMPLATE_BODY,height:180},{xtype:"container",layout:{type:"hbox",align:"middle"},items:[{xtype:"component",width:314},{xtype:"cell.button",ui:"red",disabled:!0,itemId:"delete",text:Forte.Resources.Text.GENERAL_DELETE,scope:a,handler:function(){var a=this;Cell.LightMessageBox.confirm({title:"Delete",msg:Forte.Resources.Text.CLOUD_MAILTEMPLATE_DELETE_TITLE,buttons:Cell.LightMessageBox.YESNO,buttonUi:["red","light"],fn:function(c){"yes"==
c&&a.deleteTemplate()}})}},{xtype:"cell.button",itemId:"submit",cls:"cell-submit",disabled:!0,ui:"blue",text:Forte.Resources.Text.GENERAL_APPLY,width:"auto",scope:a,handler:a.submit}]}]});this.callParent()},deleteTemplate:function(){var a=this;Forte.API.postCloud("MailTemplate.delete",{_id:a.down("#templateName").getValue()},function(){a.down("#delete").setDisabled(!0);a.down("#templateName").setValue("");a.getComponent("subject").setValue("");a.getComponent("from").setValue("");a.getComponent("bcc").setValue("");
a.getComponent("body").setValue("");a.reload();Cell.LightMessageBox.alert("Success",Forte.Resources.Text.CLOUD_MAILTEMPLATE_DELETE_COMPLETE)})},submit:function(){var a=this,b=a.down("#submit"),c=a.getComponent("templateName").getValue();b.setDisabled(!0);c in a.templates?Forte.API.postCloud("MailTemplate.update",{_id:a.down("#templateName").getValue(),subject:a.getComponent("subject").getValue(),from:a.getComponent("from").getValue(),bcc:a.getComponent("bcc").getValue(),body:a.getComponent("body").getValue()},
function(){a.reload();a.down("#delete").setDisabled(!1);Cell.LightMessageBox.alert("Success",Forte.Resources.Text.CLOUD_MAILTEMPLATE_UPDATE_COMPLETE)},null,function(){b.setDisabled(!1)}):Forte.API.postCloud("MailTemplate.create",{_id:a.down("#templateName").getValue(),subject:a.getComponent("subject").getValue(),from:a.getComponent("from").getValue(),bcc:a.getComponent("bcc").getValue(),body:a.getComponent("body").getValue()},function(){a.reload();a.down("#delete").setDisabled(!1);Cell.LightMessageBox.alert("Success",
Forte.Resources.Text.CLOUD_MAILTEMPLATE_CREATE_COMPLETE)},null,function(){b.setDisabled(!1)})},reload:function(){var a=this;Forte.API.postCloud("MailTemplate.list",null,function(b){for(var c=[],e=a.getComponent("templateName"),f=0;f<b.items.length;f++)a.templates[b.items[f]._id]=b.items[f],c.push(Ext.create("MailTemplateCombo",b.items[f]));e.store.removeAll();e.store.add(c)})}})})();(function(){Ext.define("Forte.HeaderPanel.HeaderToolbar",{extend:"Cell.toolbar.TopToolbar",alias:"widget.headertoolbar",config:{buildControl:null,projectName:"",debuggerAutoReload:!0,foundDebuggers:0},showingMenu:!1,servicesWindow:null,servicesConstants:{PAGE_CI:1,PAGE_DEPLOY_SERVICE:2,PAGE_CORDOVA_PLUGINS:3,PAGE_WEB_COMPONENTS:4,PAGE_SERVICE_INTEGRATION:5,PAGE_ANDROID_BUILD:6,PAGE_IOS_BUILD:7,PAGE_WINDOWS_BUILD:8,PAGE_CHROME_BUILD:9,PAGE_ANDROID_APP_SETTINGS:10,PAGE_IOS_APP_SETTINGS:11,PAGE_WINDOWS_APP_SETTINGS:12,
PAGE_CHROME_APP_SETTINGS:13,PAGE_ANDROID_BUILD_SETTINGS:14,PAGE_IOS_BUILD_SETTINGS:15,PAGE_BUILD_RESULT:16,PAGE_ANDROID_BUILD_DEBUGGER:17,PAGE_IOS_BUILD_DEBUGGER:18},initComponent:function(){var a=this,b=detectWinMac(),c=new Forte.EnvironmentSettingControl;a.searchHist=Ext.create("Ext.data.Store",{fields:["text","time"],sorters:[{property:"time",direction:"DESC"}],data:[]});a.showingMenu=!1;Ext.apply(this,{title:Forte.Resources.Text.HEADER_TITLE,padding:"0",margin:"0",buttonAlign:"right",style:"border-bottom : 1px solid #ccc",
items:[{xtype:"cell.monaca",listeners:{click:function(){var a=document.getElementById("forte-dashboard"),b=angular.element(document.getElementById("dashboard-controller")).scope();if("on"===a.className)this.removeCls("on"),a.className="",a.style.height="",b.$apply(function(){b.MonacaUIService.showPlanDetail=!1;b.MonacaUIService.showNewProject=!1});else{this.addClass("on");var c=window.innerHeight-document.getElementById("component:header").clientHeight;a.style.height=c+"px";a.addEventListener("transitionend",
function(){a.className="on";a.removeEventListener("transitionend",arguments.callee)})}}}},{xtype:"cell.toolbarbutton",itemId:"file_menu",text:Forte.Resources.Text.HEADER_BUTTON_FILE,scope:this,menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{beforeshow:function(){var b=Ext.getCmp("component:projectpanel").selectedNode;flags=b?getEditableFlags(b):null;this.down("#new_file").setDisabled(null==flags||!flags.canCreateFile);this.down("#new_dir").setDisabled(null==flags||!flags.canCreateDir);this.down("#upload_file").setDisabled(null==
flags||!flags.canUploadTo);this.down("#delete_file").setDisabled(null==flags||!flags.canDelete);this.down("#rename_file").setDisabled(null==flags||!flags.canRename);this.down("#copy_file").setDisabled(null==flags||!flags.canCopy);this.down("#open_file").setDisabled(null==flags||!flags.canOpen);this.down("#history_file").setDisabled(null==flags||!flags.canViewHistory);a.showingMenu=!0},beforehide:function(){a.showingMenu=!1}},items:[{width:200,text:Forte.Resources.Text.HEADER_BUTTON_FILE_NEW,icon:"/img/cell/icon/document.png",
itemId:"new_file",handler:function(){var a=Ext.getCmp("component:projectpanel");a.createNewFile(a.currentDir)}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_MAKEDIR,icon:"/img/cell/icon/blue-folder-horizontal.png",itemId:"new_dir",handler:function(){var a=Ext.getCmp("component:projectpanel");a.createNewFolder(a.currentDir)}},{xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318S":"Ctrl+S",text:Forte.Resources.Text.HEADER_BUTTON_FILE_SAVE,icon:"/img/icon/disk.png",itemId:"save",disabled:!0,handler:function(){Message.MainPanel.SaveActiveEditorTab.send()}},
{text:Forte.Resources.Text.HEADER_BUTTON_FILE_SAVEALL,icon:"/img/icon/disk_multiple.png",itemId:"save_all",disabled:!0,handler:function(){Message.MainPanel.SaveAllEditorTab.send()}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_UPLOAD,icon:"/img/cell/icon/upload-cloud.png",itemId:"upload_file",disabled:!0,handler:a.onUpload},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_DELETE,itemId:"delete_file",icon:"/img/cell/icon/cross.png",disabled:!0,handler:function(){Ext.getCmp("component:projectpanel").onDeleteFile()}},
{text:Forte.Resources.Text.PAGES_CONTEXTMENU_RENAME,itemId:"rename_file",icon:"/img/icon/textfield.png",disabled:!0,handler:function(){var a=Ext.getCmp("component:projectpanel");a.onChangeNameInline(a,$(".x-grid-row-selected",a.getEl().dom)[0])}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_OPEN,itemId:"open_file",icon:"/img/icon/page_copy.png",disabled:!0,handler:function(){Ext.getCmp("component:projectpanel").onOpenFile()}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_COPY,itemId:"copy_file",icon:"/img/icon/page_copy.png",
disabled:!0,handler:function(){Ext.getCmp("component:projectpanel").onFileCopy()}},{text:Forte.Resources.Text.PAGES_CONTEXTMENU_HISTORY,itemId:"history_file",icon:"/img/icon/page_copy.png",disabled:!0,handler:function(){var a=Ext.getCmp("component:projectpanel").getSelectionModel().getSelection()[0];MessageHub.send(new Message.MainPanel.OpenHistoryTab({path:a.data.filepath,mime:a.data.mime}))}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_EXPORT,icon:"/img/icon/application_put.png",handler:function(){(new Message.MainPanel.OpenIFrameTab(Forte.Resources.Text.HEADER_BUTTON_FILE_EXPORT,
"/page/project/"+Forte.API.projectId+"/export?api_token="+Forte.API.apiToken)).send()}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_PUBLISH,icon:"/img/icon/application_share2.png",handler:function(){var a=angular.element(document.body).injector(),b=a.get("$uibModal"),a=a.get("$templateCache");b.open({template:a.get("share/ProjectPublishWindow.html"),controller:"ProjectPublishWindowController",windowClass:"project-share-window",backdrop:"static",resolve:{projectId:function(){return config.projectId}}}).result.then(function(){});
Forte.API.sendEventToGA("menu-publish","click")}},"-",{text:Forte.Resources.Text.HEADER_BUTTON_FILE_PREFERENCES,icon:"/img/new_ide/header/settings_icon.png",handler:function(){MessageHub.send(new Message.MainPanel.OpenEnvironmentTab({component:c.getSettingPanel(),tabId:"monaca:environment"}))}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_HTML5_PLUGIN,icon:"/img/icon/component.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_WEB_COMPONENTS)}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_CORDOVA_PLUGIN,
icon:"/img/icon/plugin.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_CORDOVA_PLUGINS)}},"-",{text:Forte.Resources.Text.HEADER_BUTTON_DOCS_ABOUT,handler:function(){Forte.Widgets.CreditWindow.showWindow()}}]})},{xtype:"cell.toolbarbutton",text:Forte.Resources.Text.HEADER_BUTTON_EDIT,listeners:{mouseover:function(){!0===a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=
!1}},items:[{width:200,xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318Z":"Ctrl+Z",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_UNDO,itemId:"menu-edit-undo",disabled:!0,handler:function(){MessageHub.send(Message.MainPanel.Undo)}},{xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318+Shift+Z":"Ctrl+Shift+Z",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_REDO,itemId:"menu-edit-redo",disabled:!0,handler:function(){MessageHub.send(Message.MainPanel.Redo)}},"-",{xtype:"widgets.menuitem.shortcut",
sctext:"mac"==b?"\u2318F":"Ctrl+F",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_SEARCH,icon:"/img/icon/find.png",itemId:"menu-edit-find",handler:function(){Message.HeaderToolbar.FocusSearchBox.send()}},{xtype:"widgets.menuitem.shortcut",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_SEARCH_NEXT,itemId:"menu-edit-find-next",handler:function(){Message.MainPanel.SearchActiveTabNext.send()}},{xtype:"widgets.menuitem.shortcut",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_SEARCH_BACK,itemId:"menu-edit-find-prev",
handler:function(){Message.MainPanel.SearchActiveTabPrev.send()}},{xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318+Option+R":"Ctrl+R",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_REPLACE,icon:"/img/icon/find.png",itemId:"menu-edit-replace",handler:function(){Message.MainPanel.ReplaceActiveTab.send()}},{xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318+Shift+Option+R":"Ctrl+Shift+R",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_REPLACE_ALL,itemId:"menu-edit-replace-all",handler:function(){Message.MainPanel.ReplaceActiveTabAll.send()}},
"-",{xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318K":"Ctrl+K",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_COMMENTIZE,itemId:"menu-edit-commentize",handler:function(){MessageHub.send(Message.MainPanel.Commentize)}},{xtype:"widgets.menuitem.shortcut",sctext:"mac"==b?"\u2318U":"Ctrl+U",text:Forte.Resources.Text.HEADER_BUTTON_EDIT_DECOMMENTIZE,id:"menu-edit-decommentize",itemId:"menu-edit-decommentize",handler:function(){MessageHub.send(Message.MainPanel.Decommentize)}}]})},{xtype:"cell.toolbarbutton",
itemId:"view_menu",text:Forte.Resources.Text.HEADER_BUTTON_VIEW,listeners:{mouseover:function(){!0===a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{beforeshow:function(){var a=Ext.getCmp("component:projectpanel-wrap"),b=Ext.getCmp("component:infopanel"),c=0;a.collapsed?(c++,this.down("#menu-view-projectpanel").setChecked(!1,!0),this.down("#menu-view-greppanel").setChecked(!1,!0),this.down("#menu-view-backendpanel").setChecked(!1,!0)):"component:projectpanel"===
a.getActiveTab().id?(this.down("#menu-view-projectpanel").setChecked(!0,!0),this.down("#menu-view-greppanel").setChecked(!1,!0),this.down("#menu-view-backendpanel").setChecked(!1,!0)):"component:greppanel"===a.getActiveTab().id?(this.down("#menu-view-projectpanel").setChecked(!1,!0),this.down("#menu-view-greppanel").setChecked(!0,!0),this.down("#menu-view-backendpanel").setChecked(!1,!0)):(this.down("#menu-view-projectpanel").setChecked(!1,!0),this.down("#menu-view-greppanel").setChecked(!1,!0),this.down("#menu-view-backendpanel").setChecked(!0,
!0));b.collapsed&&c++;2<=c&&!0===Ext.getCmp("component:utilpanel").hidden?this.down("#menu-view-allpanel").setChecked(!0,!0):this.down("#menu-view-allpanel").setChecked(!1,!0)},show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=!1}},items:[{xtype:"widgets.menuitem.shortcutcheck",width:230,sctext:"mac"==b?"\u2318+Shift+1":"Ctrl+Shift+1",text:Forte.Resources.Text.HEADER_BUTTON_VIEW_PROJECTPANEL,itemId:"menu-view-projectpanel",handler:function(b){var c=Ext.getCmp("component:projectpanel-wrap");
b.checked?(c.expand(),c.setActiveTab(Forte.ProjectPanel.PAGE_TREE)):"component:projectpanel"===c.getActiveTab().id?c.collapse():c.setActiveTab(Forte.ProjectPanel.PAGE_TREE);Ext.getCmp("component:root").fireEvent("resize");a.down("#view_menu").hideMenu()}},{xtype:"widgets.menuitem.shortcutcheck",sctext:"mac"==b?"\u2318+Shift+2":"Ctrl+Shift+2",text:Forte.Resources.Text.HEADER_BUTTON_VIEW_ALLPANEL,id:"menu-view-allpanel",itemId:"menu-view-allpanel",checkHandler:function(b){b.checked?(Ext.getCmp("component:projectpanel-wrap").collapse(),
Message.InfoPanel.forceCollapse.send(),Message.PreviewPanel.forceCollapse.send()):(Ext.getCmp("component:projectpanel-wrap").expand(),Message.InfoPanel.freeCollapse.send(),Message.PreviewPanel.freeCollapse.send());a.down("#view_menu").hideMenu()}},{width:230,xtype:"widgets.menuitem.shortcutcheck",sctext:"mac"==b?"\u2318+Shift+5":"Ctrl+Shift+3",text:Forte.Resources.Text.HEADER_BUTTON_VIEW_GREPPANEL,itemId:"menu-view-greppanel",checkHandler:function(b){var c=Ext.getCmp("component:projectpanel-wrap");
b.checked?(c.expand(),c.setActiveTab(Forte.ProjectPanel.PAGE_GREP)):"component:greppanel"===c.getActiveTab().id?c.collapse():c.setActiveTab(Forte.ProjectPanel.PAGE_GREP);Ext.getCmp("component:root").fireEvent("resize");a.down("#view_menu").hideMenu()}},{width:230,xtype:"widgets.menuitem.shortcutcheck",sctext:"mac"==b?"\u2318+Shift+6":"Ctrl+Shift+4",text:Forte.Resources.Text.HEADER_BUTTON_VIEW_BACKENDPANEL,itemId:"menu-view-backendpanel",checkHandler:function(b){var c=Ext.getCmp("component:projectpanel-wrap");
b.checked?(c.expand(),c.setActiveTab(Forte.ProjectPanel.PAGE_BACKEND)):"component:cloudpanel"===c.getActiveTab().id?c.collapse():c.setActiveTab(Forte.ProjectPanel.PAGE_BACKEND);Ext.getCmp("component:root").fireEvent("resize");a.down("#view_menu").hideMenu()}}]})},{xtype:"cell.toolbarbutton",text:Forte.Resources.Text.HEADER_BUTTON_DEBUGGER,listeners:{mouseover:function(){!0===a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{show:function(){a.showingMenu=!0},
beforehide:function(){a.showingMenu=!1}},items:[{itemId:"preview_menu",text:Forte.Resources.Text.HEADER_BUTTON_PREVIEW,icon:"/img/new_ide/header/preview_icon.png",handler:function(){Ext.getCmp("component:previewpanel").onPreviewBtn()}},{itemId:"run_menu",text:Forte.Resources.Text.HEADER_BUTTON_RUN,icon:"/img/new_ide/header/run_icon.png",disabled:!1,handler:function(a){a.disable();var b=Forte.Widgets.RunToast.showWindow();Forte.API.sendProjectRun().done(function(a){b.close();if(a&&a.result)if(0===
a.result.clientsCount)Forte.Widgets.RunFailDialog.showWindow();else{var a=a.result.clients,c="",e;for(e in a){c=a[e].clientName;break}var k=Forte.Widgets.RunSuccessToast.showWindow({clientName:c});setTimeout(function(){k.close()},1400)}});setTimeout(function(){a.enable()},4E3);Forte.API.sendEventToGA("menu-run","click")}},"-",{text:Forte.Resources.Text.HEADER_BUTTON_DEBUGGER_DEBUGGER,icon:"/img/debugger/ico-debugger-logo.png",handler:function(){Forte.Debugger.DebuggerDialog.showWindow()}}]})},{xtype:"cell.toolbarbutton",
text:Forte.Resources.Text.HEADER_BUTTON_BUILD,listeners:{mouseover:function(){!0===a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=!1}},items:[{text:Forte.Resources.Text.HEADER_BUTTON_BUILD_ANDROID,icon:"/img/cell/project_android_icon.png",width:260,handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_ANDROID_BUILD)}},{text:Forte.Resources.Text.HEADER_BUTTON_BUILD_IOS,icon:"/img/cell/project_ios_icon.png",
width:260,handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_IOS_BUILD)}},{text:Forte.Resources.Text.HEADER_BUTTON_BUILD_WIN8,icon:"/img/cell/project_winrt_icon.png",width:260,handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_WINDOWS_BUILD)}},"-",{text:Forte.Resources.Text.HEADER_BUTTON_BUILD_HISTORY,icon:"/img/build/icon_build_history.png",width:260,handler:function(){Ext.getCmp("component:mainpanel").openTabBuildHistory()}},{text:Forte.Resources.Text.HEADER_BUTTON_CI_HISTORY,
icon:"/img/build/icon_build_history.png",width:260,handler:function(){Ext.getCmp("component:mainpanel").openTabCiHistory()}}]})},{xtype:"cell.toolbarbutton",text:Forte.Resources.Text.HEADER_BUTTON_VCS,listeners:{mouseover:function(){!0===a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=!1},beforeshow:function(){var a=this;Forte.API.getJSON("/api/project/:project_id/vcs/info").then(function(b){b.result&&
b.result.local_environment&&b.result.github?(a.getComponent("vcs_commit_menu").setDisabled(!1),a.getComponent("vcs_push_menu").setDisabled(!1),a.getComponent("vcs_pull_menu").setDisabled(!1),a.getComponent("vcs_remote_history_menu").setDisabled(!1),a.getComponent("vcs_history_menu").setDisabled(!1)):(a.getComponent("vcs_commit_menu").setDisabled(!0),a.getComponent("vcs_push_menu").setDisabled(!0),a.getComponent("vcs_pull_menu").setDisabled(!0),a.getComponent("vcs_remote_history_menu").setDisabled(!0),
a.getComponent("vcs_history_menu").setDisabled(!0))})}},items:[{itemId:"vcs_commit_menu",xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_VCS_COMMIT,handler:function(){var a=angular.element(document.body).injector(),b=a.get("$uibModal"),a=a.get("$templateCache");b.open({template:a.get("vcs/VcsCommitDialog.html"),controller:"VcsCommitController",windowClass:"vcs-commit-window"})}},{xtype:"widgets.menuitem.icon",itemId:"vcs_push_menu",text:Forte.Resources.Text.HEADER_BUTTON_VCS_PUSH,
handler:function(){var a=angular.element(document.body).injector(),b=a.get("$uibModal"),a=a.get("$templateCache");b.open({template:a.get("vcs/VcsPushDialog.html"),controller:"VcsPushController",windowClass:"vcs-push-window"})}},{xtype:"widgets.menuitem.icon",itemId:"vcs_pull_menu",text:Forte.Resources.Text.HEADER_BUTTON_VCS_PULL,handler:function(){var a=angular.element(document.body).injector(),b=a.get("$uibModal"),a=a.get("$templateCache");b.open({template:a.get("vcs/VcsPullDialog.html"),controller:"VcsPullController",
windowClass:"vcs-pull-window"})}},"-",{xtype:"widgets.menuitem.icon",itemId:"vcs_remote_history_menu",text:Forte.Resources.Text.HEADER_BUTTON_VCS_HISTORY,handler:function(){var a=Forte.API.getAPIUrl("/api/project/:project_id/vcs/history");window.open(a)}},{xtype:"widgets.menuitem.icon",itemId:"vcs_history_menu",text:Forte.Resources.Text.HEADER_BUTTON_VCS_COMMIT_HISTORY,handler:function(){Ext.getCmp("component:mainpanel").openTabVcsCommitHistory()}},"-",{xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_VCS_CONFIGURE,
handler:function(){var a=angular.element(document.body).injector(),b=a.get("$uibModal"),a=a.get("$templateCache");Ext.getCmp("component:mainpanel").isDirty()?b.open({template:a.get("commonDialogs/AlertDialog.html"),controller:"AlertController",resolve:{title:function(){return Forte.Resources.Text.HEADER_BUTTON_VCS_ALERT_DIRTY_TITLE},message:function(){return Forte.Resources.Text.HEADER_BUTTON_VCS_ALERT_DIRTY_MESSAGE}}}):b.open({template:a.get("vcs/VcsConfigurationDialog.html"),controller:"VcsConfigurationController",
windowClass:"vcs-config-window"})}}]})},"-",{xtype:"cell.toolbarbutton",itemId:"save_menu",text:Forte.Resources.Text.HEADER_BUTTON_FILE_SAVE,icon:"/img/new_ide/header/disk_icon.png",disabled:!0,handler:function(){Message.MainPanel.SaveActiveEditorTab.send()}},{xtype:"cell.toolbarbutton",itemId:"preview_menu",text:Forte.Resources.Text.HEADER_BUTTON_PREVIEW,icon:"/img/new_ide/header/preview_icon.png",id:"ToolbarPreviewBtn",listeners:{click:function(a){if(Ext.getCmp("component:mainpanel").isCurrentTabEditable()){var b=
Ext.getCmp("component:previewpanel");b.isHiddenMode?a.addCls("selected"):a.removeCls("selected");b.onPreviewBtn()}},beforerender:function(a){a.addCls("selected")}}},{xtype:"cell.toolbarbutton",itemId:"run_menu",text:Forte.Resources.Text.HEADER_BUTTON_RUN,icon:"/img/new_ide/header/run_icon.png",disabled:!1,handler:function(a){a.disable();var b=Forte.Widgets.RunToast.showWindow();Forte.API.sendProjectRun().done(function(a){b.close();if(a&&a.result)if(0===a.result.clientsCount)Forte.Widgets.RunFailDialog.showWindow();
else{var a=a.result.clients,c="",e;for(e in a){c=a[e].clientName;break}var k=Forte.Widgets.RunSuccessToast.showWindow({clientName:c});setTimeout(function(){k.close()},1400)}});setTimeout(function(){a.enable()},4E3);Forte.API.sendEventToGA("menu-run","click")}},{xtype:"cell.toolbarbutton",id:"ToolbarTeamBtn",itemId:"team_menu",text:Forte.Resources.Text.HEADER_BUTTON_TEAM,icon:"/img/new_ide/header/icn_team.png",handler:function(){var a=angular.element(document.body).injector(),b=a.get("$uibModal"),
a=a.get("$templateCache");b.open({template:a.get("share/ProjectShareWindow.html"),controller:"ProjectShareWindowController",windowClass:"project-share-window",backdrop:"static",resolve:{projectId:function(){return config.projectId}}}).result.then(function(){});Forte.API.sendEventToGA("menu-team","click")}},{xtype:"cell.splitbutton",itemId:"config_menu",text:Forte.Resources.Text.HEADER_BUTTON_CONFIG,icon:"/img/new_ide/header/settings_icon.png",handler:function(a){a.showMenu()},listeners:{mouseover:function(){!0===
a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=!1}},items:[{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_APP_ANDROID,icon:"/img/cell/project_android_icon.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_ANDROID_APP_SETTINGS)}},{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_BUILD_ANDROID,icon:"/img/cell/project_android_icon.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_ANDROID_BUILD_SETTINGS)}},
"-",{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_APP_IOS,icon:"/img/cell/project_ios_icon.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_IOS_APP_SETTINGS)}},{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_BUILD_IOS,icon:"/img/cell/project_ios_icon.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_IOS_BUILD_SETTINGS)}},"-",{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_APP_WIN8,icon:"/img/cell/project_winrt_icon.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_WINDOWS_APP_SETTINGS)}},
"-",{text:Forte.Resources.Text.HEADER_BUTTON_FILE_CORDOVA_PLUGIN,icon:"/img/icon/plugin.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_CORDOVA_PLUGINS)}},{text:Forte.Resources.Text.HEADER_BUTTON_FILE_HTML5_PLUGIN,icon:"/img/icon/component.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_WEB_COMPONENTS)}},{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_INTEGRATION,icon:"/img/cell/icon/document-plus.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_SERVICE_INTEGRATION)}},
{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_CI,icon:"/img/cell/icon/document-plus.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_CI)}},{text:Forte.Resources.Text.HEADER_BUTTON_CONFIG_DEPLOY_SERVICE,icon:"/img/cell/icon/document-plus.png",handler:function(){a.openServicesWindow(a.servicesConstants.PAGE_DEPLOY_SERVICE)}},"-",{text:Forte.Resources.Text.HEADER_BUTTON_FILE_PREFERENCES,icon:"/img/new_ide/header/settings_icon.png",handler:function(){MessageHub.send(new Message.MainPanel.OpenEnvironmentTab({component:c.getSettingPanel(),
tabId:"monaca:environment"}))}}]})},"->",{xtype:"cell.toolbarbutton",text:Forte.Resources.Text.HEADER_BUTTON_DOCS,cls:"cell-top-toolbar-button-wide-margin",listeners:{mouseover:function(){!0===a.showingMenu&&this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{listeners:{show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=!1}},items:[{xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_HELP_TECH,handler:function(){window.open(Forte.Resources.URL.SUPPORT_TECH)}},
{xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_HELP_FORUM,handler:function(){window.open(Forte.Resources.URL.FORUM_MONACA)}},{xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_HELP_ISSUE,handler:function(){window.open(Forte.Resources.URL.SUPPORT_ISSUE)}},"-",{xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_HELP_PRICING,handler:function(){window.open(Forte.Resources.URL.SUPPORT_SERVICES)}},{xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_HELP_SERVICES,
handler:function(){window.open(Forte.Resources.URL.SUPPORT)}},"-",{width:250,xtype:"widgets.menuitem.icon",text:Forte.Resources.Text.HEADER_BUTTON_DOCS_HEADLINE,handler:function(){window.open(Forte.Resources.DocumentURL.HEADLINE)}},{xtype:"widgets.menuitem.icon",iconRight:"/img/icon/page_white_world.png",text:Forte.Resources.Text.HEADER_BUTTON_DOCS_TOP,icon:"/img/icon/bookmark_book_open.png",handler:function(){window.open(Forte.Resources.DocumentURL.TOP)}},{text:Forte.Resources.Text.HEADER_BUTTON_DOCS_BLOG,
handler:function(){window.open(Forte.Resources.DocumentURL.BLOG)}}]})},{xtype:"cell.toolbarbutton",itemId:"notification_icon",width:34,height:34,html:'<div id="notificaion-block" >&nbsp;</div>',listeners:{afterrender:function(){$("#notificaion-block").replaceWith($("#forte-notification"))}}},{xtype:"cell.toolbarbutton",text:'<img src="'+Forte.API.gravatar+'" class="cell-gravatar" alt="" />'+Forte.Resources.Text.HEADER_BUTTON_USER(Forte.API.userName),listeners:{mouseover:function(){!0===a.showingMenu&&
this.showMenu()}},menu:Ext.create("Cell.toolbar.TopToolbarMenu",{style:"margin-left: 9px;",listeners:{show:function(){a.showingMenu=!0},beforehide:function(){a.showingMenu=!1}},items:[{icon:"/img/icon/application_home.png",text:Forte.Resources.Text.HEADER_BUTTON_USER_MYPAGE_BACK,handler:function(){Cell.LightMessageBox.show({closable:!1,modal:!0,title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:Forte.Resources.Text.HEADER_BUTTON_MYPAGE_MESSAGE,buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"==
b&&(a.ownerCt.forceClose=!0,location.href=Forte.API.websiteHost+"/dashboard")}})}},{icon:"/img/icon/door.png",text:Forte.Resources.Text.HEADER_BUTTON_USER_LOGOUT,handler:function(){Cell.LightMessageBox.show({closable:!1,modal:!0,title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:Forte.Resources.Text.HEADER_BUTTON_LOGOUT_MESSAGE,buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"==b&&(a.ownerCt.forceClose=!0,location.href=Forte.API.websiteHost+"/logout")}})}},{text:Forte.Resources.Text.HEADER_BUTTON_SWITCH_LANGUAGE,
handler:function(){Cell.LightMessageBox.show({closable:!1,modal:!0,title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:Forte.Resources.Text.HEADER_BUTTON_SWITCH_LANGUAGE_MESSAGE,buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"==b&&(a.ownerCt.forceClose=!0,Forte.API.switchLanguage(a.getOtherLanguage()).success(function(){location.href=Forte.API.getAPIUrl("/project/:project_id")}))}})}}]})}]});MessageHub.subscribe(Message.UpdateEditorState,function(b){var c=a.down("#menu-edit-undo"),g=
a.down("#menu-edit-redo"),h=a.down("#save"),j=a.down("#save_menu"),k=a.down("#save_all"),m=a.down("#menu-edit-find"),n=a.down("#menu-edit-find-prev"),q=a.down("#menu-edit-find-next");b.isSaving()||b.isSavingAll()?(h.setDisabled(!0),j.setDisabled(!0),k.setDisabled(!0)):(h.setDisabled(!b.activeTabIsUnsaved()),j.setDisabled(!b.activeTabIsUnsaved()),k.setDisabled(!b.anyTabIsUnsaved()),c.setDisabled(!b.activeTabIsUnsaved()),g.setDisabled(!b.activeTabHasRedo()));m.setDisabled(!b.isAceTab());n.setDisabled(!b.isAceTab());
q.setDisabled(!b.isAceTab())});MessageHub.subscribe(Message.MainPanel.OpenAndroidAppConfig,function(){var b=angular.element(document.body).injector().get("Constant");a.onSettingTab(b.SETTING_PAGE_ANDROID)});MessageHub.subscribe(Message.MainPanel.OpenIOSAppConfig,function(){var b=angular.element(document.body).injector().get("Constant");a.onSettingTab(b.SETTING_PAGE_IOS)});MessageHub.subscribe(Message.HeaderToolbar.DisableMenuItem,function(b){var c=b.id;if(c instanceof Array)for(var g=0;g<c.length;g++){var h=
a.down("#"+c[g]);h&&h.setDisabled(b.disabled)}else(h=a.down("#"+c))&&h.setDisabled(b.disabled)});MessageHub.subscribe(Message.HeaderToolbar.MaximizePanel,function(){!0===Ext.getCmp("menu-view-allpanel").checked?Ext.getCmp("menu-view-allpanel").setChecked(!1):Ext.getCmp("menu-view-allpanel").setChecked(!0)});this.callParent()},openServicesWindow:function(a){var b=Forte.API.appHost+"/"+Forte.Resources.Language+"/services/"+Forte.API.projectId+"?hide_headerbar=1",c=!Ext.getCmp("iframe:"+b);Ext.getCmp("component:mainpanel").openTabServicesApp(b);
var e=$("iframe.cell-iframe-tab-content",Ext.getDom(Ext.getCmp("iframe:"+b).id))[0].contentWindow;if(c){var f=!1;window.addEventListener("message",function(a){/^(http|https):\/\/app.(s\d*\.)?monaca.[a-z]*$/.test(a.origin)&&a.data&&(f=!0,window.removeEventListener("message",arguments.callee))},!1);var g=setInterval(function(){f?(clearInterval(g),g=null):e.postMessage(a,"*")},200)}else e.postMessage(a,"*")},getOtherLanguage:function(){return"ja"==Forte.Resources.Language?"en":"ja"},updateClientList:function(){Forte.API.getClientList(function(a){var b=
[],c;for(c in a)a[c]&&"debugger"==a[c].clientType&&b.push(a[c]);if(0<b.length){Ext.getCmp("menu-toolbar-run-start").setDisabled(!1);a=Ext.getCmp("menu-toolbar-run");for(c in a.items.items)"undefined"!==typeof a.items.items[c].dataType&&"item"==a.items.items[c].dataType&&a.remove(a.items.items[c]);for(c in b)a.items.add(new Ext.menu.Item({id:b[c].clientId,text:b[c].clientName,xtype:"menuitem",order:100+c,dataType:"item",handler:function(){Forte.API.sendProjectRun()}}));a.items.sort("order","ASC");
Ext.getCmp("menu-toolbar-run-spinner").hide();a.doLayout()}else Ext.getCmp("menu-toolbar-run-start").setDisabled(!0),Ext.getCmp("menu-toolbar-run-spinner").hide(),Ext.getCmp("menu-toolbar-run").doLayout()})},onUpload:function(){Forte.Widgets.UploadWindow.showWindow(Ext.getCmp("component:projectpanel").currentDir,function(){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOAD_FILE,type:"report"})).send()})},onSettingTab:function(a){Ext.getCmp("component:mainpanel").openTabSettings();Ext.getCmp("component:infopanel").forceCollapse();
Ext.getCmp("component:previewpanel").forceCollapse();setTimeout(function(){var b=angular.element(document.getElementById("monaca:settings")).scope();b.page=a;b.$apply()})},addSearchHist:function(a){null==a||""==a||(a={text:a,time:new Date},-1==this.searchHist.findExact(a)&&this.searchHist.insert(0,a))}})})();(function(){Ext.define("Forte.InfoPanel.InfoPanel",{extend:"Ext.panel.Panel",alias:"widget.infopanel",infoPanelHeight:100,collapseInfoPanel:!1,forceCollapsed:!1,debugTabControlComponent:null,inspectorTabControlComponent:null,initComponent:function(){var a=this,b=Ext.create("Ext.panel.Panel",{title:Forte.Resources.Text.DEBUG_INSPECTOR_PANEL_TITLE,layout:"fit",html:'<div class="ide-iframemask ide-inspector-iframemask"></div><iframe id="ide-inspector-iframe" width="100%" height="100%" src="" style"width: 100%; height: 100%" onload="if (this.src.indexOf(Forte.API.inspectorUrl) != -1) { Forte.API.isInspectorLoaded = true; }"></iframe>',
id:"tab-inspector",iconCls:"ide-inspector-icon",preventHeader:!0,margin:"0",padding:"0",listeners:{afterRender:function(){setIframeMaskHandler()},resize:function(){Forte.API.sendToInspector({command:"resize"})}}});Ext.apply(this,{id:"component:infopanel",itemId:"info_panel",preventHeader:!0,region:"south",collapseMode:"mini",animCollapse:!1,ui:"mat",layout:"fit",margin:"0",padding:"0",split:!0,collapsible:!0,height:a.infoPanelHeight,collapsed:a.collapseInfoPanel,items:[b],listeners:{afterRender:function(){document.getElementById("ide-inspector-iframe").src=
Forte.API.inspectorUrl},collapse:function(){Ext.getCmp("component:root").fireEvent("resize");Ext.getCmp("mainpanel-collapse-inspector").addCls("collapsed")},expand:function(){Ext.getCmp("component:root").fireEvent("resize");Ext.getCmp("mainpanel-collapse-inspector").removeCls("collapsed")}}});MessageHub.subscribe(Message.MainPanel.ActivateSettingTab,function(){a.forceCollapse()});MessageHub.subscribe(Message.MainPanel.DeactivateSettingTab,function(){a.freeCollapse()});MessageHub.subscribe(Message.InfoPanel.forceCollapse,
function(){a.forceCollapse()});MessageHub.subscribe(Message.InfoPanel.freeCollapse,function(){a.freeCollapse()});this.callParent()},listeners:{collapse:function(){!0!==this.forceCollapsed&&this.sendIDEStatus()},expand:function(){!0!==this.forceCollapsed&&this.sendIDEStatus()}},sendIDEStatus:function(){MessageHub.send(new Message.SendIDEStatus("infoPanelHeight",this.getHeight()));MessageHub.send(new Message.SendIDEStatus("collapseInfoPanel",this.collapsed))},setTabPanel:function(){this.inspectorTabControlComponent.setTabPanel(this)},
forceCollapse:function(){if(!this.collapsed||this.forceCollapsed)this.forceCollapsed=!0,this.collapse()},freeCollapse:function(){!0===this.forceCollapsed&&(this.forceCollapsed=!1,this.expand())}})})();(function(){Ext.define("Forte.InfoPanel.DebugTabControl",{component:null,levelFilterInput:null,debugLogStore:null,debugDeviceStore:null,debugLevelStore:null,filter:null,LIMIT_LOG_NUM:200,disabledMessage:Forte.Resources.Text.DEBUG_DISABLED,constructor:function(){this.filter=new Forte.DebugLogFilter;this.debugLevelStore=Ext.create("Ext.data.Store",{fields:["text","value"],data:[{text:Forte.Resources.Text.DEBUG_ERROR,value:this.filter.text2level("error")},{text:Forte.Resources.Text.DEBUG_WARN,value:this.filter.text2level("warn")},
{text:Forte.Resources.Text.DEBUG_LOG,value:this.filter.text2level("log")},{text:Forte.Resources.Text.DEBUG_DEBUG,value:this.filter.text2level("debug")}]});var a=this;this.levelFilterInput=Ext.create("Cell.form.field.ComboBox",{width:100,margin:"0 1px",editable:!1,displayField:"text",valueField:"value",queryMode:"local",text:Forte.Resources.Text.DEBUG_LEVELFILTER,store:a.debugLevelStore,value:this.filter.text2level("log"),listeners:{select:function(b,c){a.filter.setLevel(c[0].data.value);a.filter.filter(a.debugLogStore)},
afterRender:function(){a.filter.setLevel(a.filter.text2level("log"));a.filter.filter(a.debugLogStore)}}});this.debugLogStore=Ext.create("Ext.data.Store",{fields:["type","timestamp","device_name","message"]});this.debugDeviceStore=Ext.create("Ext.data.Store",{fields:["value","display"],data:[{value:"",display:Forte.Resources.Text.DEBUG_ALL_DEVICE}]});MessageHub.subscribe(Message.InfoPanel.ReceiveDebugLog,function(b){a.debugLogStore.getCount()>=a.LIMIT_LOG_NUM&&a.debugLogStore.removeAt(0);a.debugLogStore.add({type:b.getType(),
device_name:b.getDeviceName(),timestamp:b.getTimestamp(),message:b.getMessage()});-1==a.debugDeviceStore.find("value",b.getDeviceName())&&a.debugDeviceStore.add({value:b.getDeviceName(),display:b.getDeviceName()});a.filter.filter(a.debugLogStore);a.scrollToBottom()});this.component=this.createComponent()},getComponent:function(){return this.component},createComponent:function(){var a=this;a.gridComponent=Ext.create("Cell.grid.GridPanel",{border:0,disabled:!1,itemId:"log",scroll:"auto",cls:"debuglog-gridpanel",
id:"DebugLogGridPanel",listeners:{afterRender:function(){var b=a.gridComponent.getView();b.addListener("afterrender",function(){b.getEl().dom.innerHTML=Forte.Resources.Text.DEBUG_WAIT})}},selType:"cellmodel",plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1})],store:this.debugLogStore,columns:[{header:"Type",dataIndex:"type",width:45,sortable:!1},{header:"Date",dataIndex:"timestamp",width:120,sortable:!1,field:"textfield"},{header:"Device",dataIndex:"device_name",width:120,sortable:!1,
field:"textfield"},{header:"Message",dataIndex:"message",flex:9,sortable:!1,field:"textfield",renderer:function(a){return Ext.util.Format.htmlEncode(a)}}]});return Ext.create("Ext.panel.Panel",{title:Forte.Resources.Text.DEBUG_LOG_PANEL_TITLE,layout:"fit",itemId:"debugLogPanel",bodyCls:"debuglog-panel-body",iconCls:"ide-debug-log-icon",dockedItems:{dock:"top",xtype:"toolbar",baseCls:"none",padding:3,style:"background-color : #E3E3E3",items:[{xtype:"cell.button",itemId:"deleteLogButton",cls:"ide-info-debug-button",
text:Forte.Resources.Text.DEBUG_LOG_PANEL_CLEAR,disabled:!1,handler:function(){a.debugLogStore.removeAll()}},{xtype:"checkboxfield",boxLabel:Forte.Resources.Text.DEBUG_LOG_AUTO_SCROLL,checked:!0,id:"AutoScrollCheckbox",margin:"0 0 0 10"},"->",this.levelFilterInput]},items:a.gridComponent})},scrollToBottom:function(){!0==Ext.getCmp("AutoScrollCheckbox").getValue()&&$("#DebugLogGridPanel .x-grid-view").scrollTop(9999999)}});Ext.define("Forte.DebugLogFilter",{filterLevelTable:{debug:1,log:2,warn:3,warning:3,
error:4},level:0,device:"",setLevel:function(a){this.level=a},setDevice:function(a){this.device=a},filter:function(a){if(1<this.level){var b=this;a.filterBy(function(a){return b.text2level(a.data.type)>=b.level})}else a.clearFilter()},text2level:function(a){return this.filterLevelTable[a]||0}})})();(function(){Ext.define("Forte.Build.BuildControl",{isBuilding:!1,queue_id:null,checkStatusInterval:null,constructor:function(){},getStatus:function(a,b,c){var e=this;Forte.API.buildStatus(this.queue_id,function(f){f=f.result;!0===f.finished?Forte.API.buildResult(e.queue_id,function(c){clearInterval(e.checkStatusInterval);var f=c.result;"finish"==f.status?setTimeout(function(){a(f,e.queue_id)},500):b(f,e.queue_id)}):c(f,e.queue_id)})},build:function(a,b,c,e,f,g){if(this.isBuilding)Cell.LightMessageBox.alert(Forte.Resources.Text.WARNING_TITLE,
Forte.Resources.Text.WARNING_BUILD_STARTED_TEXT);else{this.isBuilding=!0;var h=function(a){this.queue_id=a&&a.result&&a.result.queue_id?a.result.queue_id:!1;("ok"!==a.status||!this.queue_id)&&e(a.result);this.checkStatusInterval=setInterval(this.getStatus.bind(k,c,e,f),4E3)},j=function(a){try{var b=JSON.parse(a.responseText);b.message&&(result.build_log=b.message)}catch(c){}e({build_log:"Unknown error."})},k=this;Forte.API.build(a,b,function(a){h.call(k,a)},g).fail(function(a){j.call(k,a)})}}})})();(function(){Ext.define("Forte.Build.AndroidDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.androiddialog",singleton:!0,modal:!1,buildType:"",hasDevCert:!1,hasDistCert:!1,hasKeystore:!1,showedBuildlog:!1,dataStore:Ext.create("Ext.data.Store",{fields:["alias"],data:{}}),forceClose:!1,webViewEngine:null,aliases:null,selectedAlias:null,pluginInAppUpdater:null,pluginAssetsEncrypt:null,pluginCrossWalk:null,buildAndroidAppInfo:null,buildControl:null,initComponent:function(){var a=this,b=[580,
600],c=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#000",className:"spinner spinner-setting-load"})).spin();a.loadmask=new Ext.LoadMask(Ext.getBody(),{msg:c.el.outerHTML});Ext.apply(this,{id:"component:buildandroid",cls:"ide-build-window",title:Forte.Resources.Text.BUILD_ANDROID_TITLE,width:b[0],height:b[1],closeAction:"hide",closable:!0,resizable:!1,layout:"card",activeItem:0,listeners:{show:function(){a.down("#ide-build-android-waitnext").show();a.down("#ide-build-android-nextbutton").setDisabled(!0);
$(".ide-build-selectbox").removeClass("selected");$(".icon-build-type").removeClass("selected");Forte.API.readProjectSetting(function(b){a.aliases=b.project.android.alias_android_list;a.selectedAlias=b.project.android.alias_android;a.down("#ide-build-android-waitnext").hide();a.down("#ide-build-android-nextbutton").show();a.webViewEngine=a.pluginCrossWalk.isInstalled&&parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE?"crosswalk":b.config.android.preference["monaca:WebViewEngine"]||
"default"});Forte.API.sendEventToGA("build","show","android")},close:function(){try{clearInterval(this.buildControl.checkStatusInterval)}catch(a){}}},bbar:["->",{xtype:"cell.button",itemId:"ide-build-android-cancelbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){clearInterval(a.buildControl.checkStatusInterval);a.forceClose=!0;a.close()}},{xtype:"cell.button",itemId:"ide-build-android-backbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_PREV,handler:function(){a.getLayout().prev()}},
{xtype:"component",itemId:"ide-build-android-waitnext",html:Forte.Resources.Text.BUILD_ANDROID_WAITFORCONFIG+" <img src='/img/loading-icon3.gif' />"},{xtype:"cell.button",itemId:"ide-build-android-nextbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_NEXT,disabled:!0,hidden:!0,handler:function(){switch(a.items.indexOf(a.getLayout().getActiveItem())){case Forte.Build.AndroidDialog.PAGE_METHOD:if(a.buildType===Forte.Build.AndroidDialog.METHOD_DEBUG&&("undefined"===typeof a.webViewEngine||
"default"===a.webViewEngine))a.getLayout().setActiveItem(Forte.Build.AndroidDialog.PAGE_PROGRESS),a.build(Forte.Build.AndroidDialog.METHOD_DEBUG);else if(a.buildType===Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER)a.getLayout().setActiveItem(Forte.Build.AndroidDialog.PAGE_PROGRESS),a.build(Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER);else if(a.buildType===Forte.Build.AndroidDialog.METHOD_DEBUGGER){var b=Forte.Debugger.AndroidDialog.PAGE_PROGRESS;"string"===typeof a.webViewEngine&&"crosswalk"===
a.webViewEngine&&(b=Forte.Debugger.AndroidDialog.PAGE_BUILDOPTION);Forte.Debugger.AndroidDialog.showWindow({activeItem:b,isFromBuildDialog:!0,webViewEngine:a.webViewEngine});a.close()}else a.dataStore.removeAll(),a.dataStore.add(a.aliases),a.selectedAlias&&(a.down("#alias_android").setValue(a.selectedAlias),a.down("#password_android").setValue("********")),a.getLayout().setActiveItem(Forte.Build.AndroidDialog.PAGE_CONFIG);break;case Forte.Build.AndroidDialog.PAGE_CONFIG:b={android:{}},b.android.alias_android=
a.down("#alias_android").getValue(),"********"!=a.down("#password_android").getValue()&&(b.android.password_android=a.down("#password_android").getValue()),Forte.API.saveProjectSetting(b,function(){a.getLayout().setActiveItem(Forte.Build.AndroidDialog.PAGE_PROGRESS);a.build(a.buildType)},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)})}}},{xtype:"cell.button",itemId:"ide-build-android-open-plugin-config-button",ui:"light",width:150,text:Forte.Resources.Text.BUILD_ANDROID_OPEN_PLUGIN_CONFIG,
handler:function(){var b=Ext.getCmp("maintab");b?(b.setActiveTab(0),Ext.getCmp("monaca:settings").setActiveItem(Forte.Setting.PAGE_CORDOVA_PLUGINS),Ext.getCmp("monaca:settings").setActivePanel(Forte.Setting.PAGE_CORDOVA_PLUGINS)):MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_CORDOVA_PLUGINS));a.close()}}],items:[{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-android-cancelbutton").hide();a.down("#ide-build-android-backbutton").hide();
a.down("#ide-build-android-open-plugin-config-button").hide();a.down("#ide-build-android-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT)}},items:[{xtype:"component",cls:"ide-build-flow-1",html:"<ul><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_HEADER+"</li></ul>",style:"margin-bottom: 30px",width:b[0]-80},{xtype:"container",cls:"ide-build-description",width:b[0]-80,height:90,
layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_H1+"</h1><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_SENTENCE+"</p>"}]},{xtype:"container",border:!1,height:300,width:b[0]-80,layout:"vbox",items:[{xtype:"panel",id:"ide-build-android-step1-debug",itemId:"debugBox",cls:"ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){$(".ide-build-selectbox").removeClass("selected");$(".icon-build-type").removeClass("selected");
$("#ide-build-android-step1-debug").addClass("selected");$(".ide-build-android-step1-debug").addClass("selected");a.checkBuildType("debug-build");a.buildType=Forte.Build.AndroidDialog.METHOD_DEBUG;a.down("#ide-build-android-nextbutton").setText("string"===typeof a.webViewEngine&&"crosswalk"===a.webViewEngine?Forte.Resources.Text.GENERAL_NEXT:Forte.Resources.Text.BUILD_STARTBUILD)})}},items:[{xtype:"container",layout:"hbox",height:70,width:b[0]-80,items:[{xtype:"radio",cls:"radio-button",name:"debug-build",
itemId:"debug-build",width:43},{xtype:"component",cls:"ide-build-android-step1-debug icon-build-type",width:80,height:70},{xtype:"component",id:"android-debug-build-text",cls:"ide-build-selectbox-text",width:b[0]-224,height:70}]}]},{xtype:"panel",id:"releaseBoxId",itemId:"releaseBox",cls:"ide-build-android-step1-release ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){a.hasKeystore&&($(".ide-build-selectbox").removeClass("selected"),
$(".icon-build-type").removeClass("selected"),$(".ide-build-android-step1-release").addClass("selected"),$("#ide-build-android-step1-release").addClass("selected"),a.buildType=Forte.Build.AndroidDialog.METHOD_RELEASE,a.checkBuildType("release-build"),a.down("#ide-build-android-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT))})}},items:[{xtype:"container",layout:"hbox",height:70,width:b[0]-80,items:[{xtype:"radio",name:"release-build",itemId:"release-build",cls:"radio-button",width:43},{xtype:"component",
cls:"ide-build-android-step1-release icon-build-type",width:80,height:80},{xtype:"component",id:"android-release-build-text",cls:"ide-build-selectbox-text",width:b[0]-224,height:80}]}]},{xtype:"panel",itemId:"debuggerBox",cls:"ide-build-android-step1-debugger ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){$(".ide-build-selectbox").removeClass("selected");$(".icon-build-type").removeClass("selected");$(".ide-build-android-step1-debugger").addClass("selected");
a.buildType=Forte.Build.AndroidDialog.METHOD_DEBUGGER;a.checkBuildType(Forte.Build.AndroidDialog.METHOD_DEBUGGER);a.down("#ide-build-android-nextbutton").setText("string"===typeof a.webViewEngine&&"crosswalk"===a.webViewEngine?Forte.Resources.Text.GENERAL_NEXT:Forte.Resources.Text.BUILD_STARTBUILD)})}},items:[{xtype:"radio",name:"debugger",itemId:"debugger",cls:"radio-button",width:40},{xtype:"component",cls:"ide-build-android-step1-debugger icon-build-type",width:80,height:70},{xtype:"component",
cls:"ide-build-selectbox-text",width:b[0]-224,html:'<h3 class="build-type-title">'+Forte.Resources.Text.BUILD_ANDROID_STEP1_DEBUGGER+"</h3><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_DEBUGGER_SENTENCE+"</p>"}]},{xtype:"panel",id:"inAppUpdaterBox",itemId:"inAppUpdaterItemId",cls:"ide-build-android-step1-inAppUpdater ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){a.pluginInAppUpdater.isInstalled&&($(".ide-build-selectbox").removeClass("selected"),
$(".icon-build-type").removeClass("selected"),$(".ide-build-android-step1-inAppUpdater").addClass("selected"),$("#ide-build-android-step1-inAppUpdater").addClass("selected"),a.buildType=Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER,a.checkBuildType("inapp-updater"),a.down("#ide-build-android-nextbutton").setText(Forte.Resources.Text.BUILD_STARTBUILD))})}},items:[{xtype:"container",layout:"hbox",height:70,width:b[0]-80,items:[{xtype:"radio",cls:"radio-button",name:"inapp-updater",itemId:"inapp-updater",
width:43},{xtype:"component",cls:"ide-build-android-step1-inAppUpdater icon-build-type",width:80,height:70},{xtype:"component",id:"android-inapp-updater-text",cls:"ide-build-selectbox-text",width:b[0]-224,height:70}]}]}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-android-cancelbutton").hide();a.down("#ide-build-android-open-plugin-config-button").hide();a.down("#ide-build-android-backbutton").show();a.down("#ide-build-android-nextbutton").show();
a.buildType===Forte.Build.AndroidDialog.METHOD_DEBUG?a.down("#options_alias").hide():a.down("#options_alias").show();"undefined"===typeof a.webViewEngine||"default"===a.webViewEngine?(a.down("#options_arch").hide(),a.down("#architecture_android").hide()):(a.down("#options_arch").show(),a.down("#architecture_android").show())}},items:[{xtype:"component",cls:"ide-build-flow-1",html:"<ul><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_HEADER+
"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_HEADER+"</li></ul>",width:b[0]-80},{xtype:"container",cls:"ide-build-description",width:b[0]-80,height:86,layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_H1+"</h1><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_SENTENCE+"</p>"}]},{xtype:"container",itemId:"options_alias",items:[{xtype:"component",html:"<h2>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_H2+"</h2>"},{xtype:"cell.combobox",name:"alias_android",
itemId:"alias_android",emptyText:Forte.Resources.Text.SETTING_ANDROID_ALIAS_EMPTY,fieldLabel:Forte.Resources.Text.BUILD_ANDROID_STEP2_1,store:a.dataStore,queryMode:"local",displayField:"alias",valueField:"alias",labelWidth:180,editable:!1,size:40,style:"margin-bottom: 3px;",forceSelection:!0,listeners:{change:function(){a.down("#password_android").setValue("");a.down("#ide-build-android-nextbutton").setDisabled(!0)}}},{xtype:"textfield",name:"password_android",itemId:"password_android",inputType:"password",
fieldLabel:Forte.Resources.Text.BUILD_ANDROID_STEP2_2,size:40,labelWidth:180,listeners:{change:function(){""!=a.down("#alias_android").getValue()&&""!=a.down("#password_android").getValue()&&a.down("#ide-build-android-nextbutton").setDisabled(!1)}}}]},{xtype:"container",itemId:"options_arch",items:[{xtype:"component",html:Forte.Resources.Text.BUILD_ANDROID_ARCH_DESC}]},{xtype:"radiogroup",itemId:"architecture_android",emptyText:Forte.Resources.Text.SETTING_ANDROID_ALIAS_EMPTY,fieldLabel:Forte.Resources.Text.BUILD_ANDROID_ARCH,
width:500,labelWidth:200,columns:3,style:"margin-bottom: 0;",items:[{boxLabel:"ARM",name:"architecture_android",inputValue:"arm",checked:!0},{boxLabel:"x86",name:"architecture_android",inputValue:"x86"}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-android-cancelbutton").show();a.down("#ide-build-android-backbutton").hide();a.down("#ide-build-android-nextbutton").hide();a.down("#ide-build-android-open-plugin-config-button").hide()},beforeshow:function(){"build"!==
Forte.API.ideMode&&"debugger"!==Forte.API.ideMode&&(Ext.getCmp("component:mainpanel").openTabBuildHistory(),a.close())}},items:[{xtype:"component",cls:"ide-build-flow-2",html:"<ul><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_HEADER+"</li></ul>",width:b[0]-80},{xtype:"component",cls:"ide-build-building",html:"<h1>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_1+"<h1><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_2+
"</p>"},{xtype:"component",height:60,width:b[0]-80,style:"text-align : center; vertical-align : middle",html:'<img src="/img/loading.gif"/>'},{xtype:"label",itemId:"ide-build-progress",style:"text-align: center",text:Forte.Resources.Text.BUILD_PREPARING}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-android-open-plugin-config-button").show();setTimeout(function(){a.down("#ide-build-android-nextbutton").hide()},400)}},items:[{xtype:"component",cls:"ide-build-flow-1",
html:"<ul><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_HEADER+"</li></ul>",width:b[0]-80},{xtype:"container",cls:"ide-build-description",width:b[0]-80,height:90,layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_H1+"</h1><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_SENTENCE+"</p>"}]},{xtype:"container",cls:"ide-build-warningbox",height:280,
width:b[0]-100,layout:"vbox",style:"margin-left: 10px;",items:[{xtype:"component",html:"<h2>"+Forte.Resources.Text.BUILD_ANDROID_ERROR_H2+"</h2><p>"+Forte.Resources.Text.BUILD_ERROR_PlUGIN_1+"</p>"},{xtype:"component",cls:"ide-build-error-itemize",html:Forte.Resources.Text.BUILD_ERROR_PlUGIN_2},{xtype:"component",cls:"ide-build-error-itemize",html:Forte.Resources.Text.BUILD_ERROR_PlUGIN_3}]}]}]});this.callParent()},build:function(a){var b=this;b.down("#ide-build-progress").setText(Forte.Resources.Text.BUILD_PREPARING);
b.buildControl=new Forte.Build.BuildControl;var c={};Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO&&(c.androidWebView=b.webViewEngine);"crosswalk"===b.webViewEngine&&(c.androidArch=b.down("#architecture_android").getValue().architecture_android);b.buildControl.build("android",a,function(c,f){if(b.forceClose!=true&&!(Forte.API.ideMode!=="build"&&Forte.API.ideMode!=="debugger")){b.close();Ext.create("Forte.Build.AndroidSuccessDialog",{binaryUrl:c.binary_url,fileName:c.package_info.package_name,
build_log:c.build_log,purpose:a,queue_id:f,modal:b.modal}).show()}},function(c,f){if(b.forceClose!=true&&!(Forte.API.ideMode!=="build"&&Forte.API.ideMode!=="debugger")){b.close();Ext.create("Forte.Build.BuildFailDialog",{target:"android",purpose:a,build_log:c.build_log,queue_id:f,modal:b.modal}).show()}},function(a){b.down("#ide-build-progress").setText(a.description)},c)},showWindow:function(a){var b=this;b.modal=a&&a.modal?a.modal:!1;b.loadmask.show();b.resetBuildTypeDescription();b.resetDisabledCheckBoxAndIcon();
b.setTitle(Forte.Resources.Text.BUILD_ANDROID_TITLE);b.confirmExcludedSubjects(function(){Forte.API.listCordovaPlugin(function(a){b.pluginInAppUpdater=window.findObjectByKey(Forte.IDE.PLUGIN_INAPP_UPDATER,a,"@")||{};b.pluginAssetsEncrypt=window.findObjectByKey(Forte.IDE.PLUGIN_ASSETS_ENCRYPTION,a,"@")||{};b.pluginCrossWalk=window.findObjectByKey(Forte.IDE.PLUGIN_CROSSWALK,a,"@")||{};b.pluginInAppUpdater.canUsed?b.pluginInAppUpdater.isInstalled||(b.down("#android-inapp-updater-text").update(Forte.Build.AndroidDialog.MSG_INAPP_UPDATER_DISABLED),
b.down("#inapp-updater").setDisabled(!0),b.down("#inAppUpdaterItemId").addCls("disabled")):(b.down("#android-inapp-updater-text").update(Forte.Build.AndroidDialog.MSG_INAPP_UPDATER_CANNOT_USE),b.down("#inapp-updater").setDisabled(!0),b.down("#inAppUpdaterItemId").addCls("disabled"));3.5>=parseFloat(Forte.API.cordovaVersion)&&b.down("#android-inapp-updater-text").update(Forte.Build.AndroidDialog.BUILD_INFO_NEED_TO_UPGRADE_CORDOVA_VERSION);Forte.API.canBuildAndroidApp(function(a){b.loadmask.hide();
b.buildAndroidAppInfo=a;if(a.has_remaining_slot==false){b.close();Ext.create("Cell.window.RestrictionDialog").showWindow("BUILD")}else if(a.is_start_file_exist===false){b.close();Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.ERROR_START_FILE_NOT_FOUND)}else if(a.manifest_error&&parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_SIX){b.close();Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.ERROR_ANDROID_MANIFEST+
a.manifest_error)}else if(a.has_assets_encrypt_password==false&&b.pluginAssetsEncrypt.isInstalled){b.close();Cell.LightMessageBox.alert(Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_TITLE,Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_NOT_EXISTS,function(){Forte.Widgets.AssetsEncryptPasswordWindow.show()})}else{a.has_assets_encrypt_password==true&&b.pluginAssetsEncrypt.isInstalled&&b.setTitle(Forte.Resources.Text.BUILD_ANDROID_TITLE_ENCRYPTION_PLUGIN_ENABLED);if(Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO&&
a.is_versionname_valid===false){b.close();Cell.LightMessageBox.alert(Forte.Resources.Text.BUILD_ANDROID_STEP1_ERROR_SETTINGS_TITLE,Forte.Resources.Text.BUILD_ANDROID_STEP1_ERROR_SETTINGS,function(){MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_ANDROID))})}else{b.buildAndroidAppInfo.has_cordovaio_registry_plugins&&Forte.API.getInstalledCordovaRegistryIoPlugins(function(a){b.getLayout().setActiveItem(Forte.Build.AndroidDialog.PAGE_CORDOVA_REGISTRY_DOWN);var c=$("#component\\:buildandroid .plugin-list");
c.empty();$.each(a,function(a,b){$("<li/>").appendTo(c).text(b)})});if(b.pluginInAppUpdater.isInstalled&&!a.has_inapp_updater_setting){b.close();Cell.LightMessageBox.alert(Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_TITLE,Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_NOT_EXISTS,function(){Forte.Widgets.InAppUpdaterSettingWindow.show()})}else b.show(null,function(){b.forceClose=false;b.showedBuildlog=false;if(a.has_keystore)b.hasKeystore=true;else{b.hasKeystore=false;b.down("#release-build").setDisabled(true);
b.down("#releaseBox").addCls("disabled");b.down("#android-release-build-text").update(Forte.Build.AndroidDialog.MSG_KEY_STORE_NOT_EXISTS)}b.checkBuildType();b.getLayout().setActiveItem(Forte.Build.AndroidDialog.PAGE_METHOD)})}}}).error(function(a){b.loadmask.hide();Forte.API.convertFail(Forte.API.showProjectSettingError,a)})})})},resetDisabledCheckBoxAndIcon:function(){this.down("#releaseBox").removeCls("disabled");this.down("#release-build").setDisabled(!1);this.down("#inAppUpdaterItemId").removeCls("disabled");
this.down("#inapp-updater").setDisabled(!1)},resetBuildTypeDescription:function(){this.down("#android-debug-build-text").update(Forte.Build.AndroidDialog.METHOD_DEBUG_TEXT);this.down("#android-release-build-text").update(Forte.Build.AndroidDialog.METHOD_RELEASE_TEXT);this.down("#android-inapp-updater-text").update(Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER_TEXT)},checkBuildType:function(a){this.down("#debug-build").setValue(!1);this.down("#release-build").setValue(!1);this.down("#inapp-updater").setValue(!1);
this.down("#debugger").setValue(!1);"undefined"!==typeof a&&(this.down("#"+a).setValue(!0),this.down("#ide-build-android-nextbutton").setDisabled(!1))},confirmExcludedSubjects:function(a){var b=this;Forte.API.tree().then(function(c){c=b.getExcludedSubjects(c.result.items);1>c.length||Forte.Widgets.ConfirmExcludedBuildFileDialog.getIsHiddenDialog()?a():(Forte.Widgets.ConfirmExcludedBuildFileDialog.setCallBack(a),Forte.Widgets.ConfirmExcludedBuildFileDialog.setDisplaySubjects(c),Forte.Widgets.ConfirmExcludedBuildFileDialog.showDailog(),
b.loadmask.hide())})},getExcludedSubjects:function(a){var b={dir:"^.svn$ ^.git$ ^CSV$ ^thumbs.db$ ^picasa.ini$ ^.scc$ ^\\. ^_ ~$".split(" "),file:"^.svn$ ^.git$ ^CSV$ ^thumbs.db$ ^picasa.ini$ ^.scc$ ^\\. ~$".split(" ")},c=[];Object.keys(a).forEach(function(e){if(e.match(/^\/www\/.*/)&&!e.match(/^\/www\/components\/.*/)){var f=a[e].type,g=e.replace(/^.*[\\\/]/,"");b[f].forEach(function(a){if(g.match(RegExp(a)))return c.push(e),!0})}});return c}})})();Forte.Build.AndroidDialog.PAGE_METHOD=0;
Forte.Build.AndroidDialog.PAGE_CONFIG=1;Forte.Build.AndroidDialog.PAGE_PROGRESS=2;Forte.Build.AndroidDialog.PAGE_CORDOVA_REGISTRY_DOWN=3;Forte.Build.AndroidDialog.METHOD_DEBUG="debug";Forte.Build.AndroidDialog.METHOD_RELEASE="release";Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER="inapp_updater";Forte.Build.AndroidDialog.METHOD_DEBUGGER="debugger";
Forte.Build.AndroidDialog.METHOD_DEBUG_TEXT="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_1+"</h3><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_1_SENTENCE+"</p>";Forte.Build.AndroidDialog.METHOD_RELEASE_TEXT="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_2+"</h3><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_2_SENTENCE+"</p>";Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER_TEXT="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_3+"</h3><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_3_SENTENCE+"</p>";
Forte.Build.AndroidDialog.MSG_KEY_STORE_NOT_EXISTS="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_2+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_ANDROID_STEP1_2_SENTENCE_ERROR+"</p>";Forte.Build.AndroidDialog.MSG_INAPP_UPDATER_CANNOT_USE="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_3+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_ANDROID_STEP1_3_SENTENCE_ERROR+"</p>";
Forte.Build.AndroidDialog.MSG_INAPP_UPDATER_DISABLED="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_3+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_ANDROID_STEP1_3_SENTENCE_ERROR_PLUGIN_DISABLE+"</p>";Forte.Build.AndroidDialog.BUILD_INFO_NEED_TO_UPGRADE_CORDOVA_VERSION="<h3>"+Forte.Resources.Text.BUILD_ANDROID_STEP1_3+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_INFO_NEED_TO_UPGRADE_CORDOVA_VERSION+"</p>";(function(){Ext.define("Forte.Build.AndroidSuccessDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.androidsuccess",binaryUrl:null,fileName:null,build_log:null,showedBuildlog:!1,queue_id:null,initComponent:function(){var a=this,b=[580,520];Ext.apply(this,{cls:"ide-build-window",title:Forte.Resources.Text.BUILD_SUCCESS_WINDOW_TITLE,width:b[0],height:b[1],closable:!0,resizable:!1,layout:"vbox",items:[{xtype:"container",id:"android-success-dialog-description",cls:"ide-build-description ide-build-description-"+
a.purpose,width:b[0]-80,style:"margin-top: 30px",html:"<h1>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS+"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS_MESSAGE+"</p>"},{xtype:"textarea",itemId:"buildlog",cls:"ide-build-success-buildlog",width:b[0]-160,height:130,hidden:!0,style:"margin-left: 40px;",listeners:{afterrender:function(a){$("textarea",a.getEl().dom).click(function(){$(this).select();copyToClipboard()})}}},{xtype:"container",height:250,layout:"hbox",
items:[{xtype:"component",width:~~((b[0]-80)/3),height:250,border:!1,cls:"ide-build-success-qr ide-build-success-button",hidden:a.hideElForInAppUpSuccess(),html:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON1+'<img style="margin:40px 0 0 0" src="'+Forte.API.qrcode(a.binaryUrl)+'"/>'},{xtype:"component",id:"localDownload",width:~~((b[0]-80)/3),height:250,cls:"ide-build-success-local ide-build-success-button",html:"<span style='font-size: 14px;font-weight: bold;'>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+
"</span>",listeners:{afterRender:function(b){if(a.hideElForInAppUpSuccess()){a.down("#localDownload").addCls("only-when-inapp-updater");$("#localDownload").css("margin","15px 0 0 150px");var e="<h1>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS+"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS_MESSAGE_FOR_IN_APP_UPDATER+"</p>";a.down("#android-success-dialog-description").update(e)}b.getEl().on("click",function(){window.open(a.binaryUrl)})}}},{xtype:"component",width:~~((b[0]-
80)/3),height:250,cls:"ide-build-success-mail ide-build-success-button",html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON3+"</span>",hidden:a.hideElForInAppUpSuccess(),listeners:{afterRender:function(b){b.getEl().on("click",function(){Cell.LightMessageBox.show({title:Forte.Resources.Text.GENERAL_MONACAIDE,msg:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL_COMFIRM,buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"===b&&Forte.API.sendApp(a.queue_id,function(){Cell.LightMessageBox.alert(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,
Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL)})}})})}}}]}],listeners:{beforedestroy:function(){MessageHub.send(new Message.SetOnUnloadStatus(!0))},afterRender:function(){$(".btn-buildlog-success").click(function(){if(!a.showedBuildlog){var b=a.down("#buildlog");b.setValue(htmlEscape(a.build_log));b.show();a.setHeight(a.getHeight()+130);a.showedBuildlog=!0}})}}});this.callParent()},hideElForInAppUpSuccess:function(){return this.purpose===Forte.Build.AndroidDialog.METHOD_INAPP_UPDATER}})})();(function(){Ext.define("Forte.Build.IOSDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.iosdialog",singleton:!0,modal:!1,buildType:"",hasDevCert:!1,hasDistCert:!1,showedBuildlog:!1,forceClose:!1,canBuildResults:null,hasUploaded:null,pluginInAppUpdater:null,pluginAssetsEncrypt:null,initComponent:function(){var a=this,b=[600,630];a.hasUploaded={};var c={xtype:"checkbox",name:"reuse_provisioning",id:"ReuseProvisioningCheckbox",checked:!0,inputValue:"1",uncheckedValue:"0",width:b[0]-80,style:"margin-bottom: 7px;",
boxLabel:Forte.Resources.Text.BUILD_IOS_REUSE_PROV,listeners:{change:function(b,c){var e=!1;!1==c&&!a.hasUploaded[a.buildType]?e=!1:!0==c&&(e=!0);a.down("#ide-build-ios-nextbutton").setDisabled(!e);Ext.getCmp("ProvisioningFileField").setDisabled(!0==c)}}},e=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#000",className:"spinner spinner-setting-load"})).spin();a.loadmask=new Ext.LoadMask(Ext.getBody(),{msg:e.el.outerHTML});Ext.apply(this,{id:"component:buildios",cls:"ide-build-window",title:Forte.Resources.Text.BUILD_IOS_TITLE,
width:b[0],height:b[1],closeAction:"hide",closable:!0,resizable:!1,layout:"card",activeItem:0,listeners:{show:function(){a.down("#ide-build-ios-nextbutton").setDisabled(!0);Forte.API.sendEventToGA("build","show","ios")},close:function(){try{clearInterval(control.checkStatusInterval)}catch(a){}}},bbar:["->",{xtype:"cell.button",itemId:"ide-build-ios-openconfigbutton",ui:"light",width:150,text:Forte.Resources.Text.BUILD_IOS_OPEN_BUILD_CONFIG,handler:function(){var b=Ext.getCmp("maintab");b?(b.setActiveTab(0),
Ext.getCmp("monaca:settings").setActiveItem(Forte.Setting.PAGE_IOSUSER),Ext.getCmp("monaca:settings").setActivePanel(Forte.Setting.PAGE_IOSUSER)):MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_IOSUSER));a.close()}},{xtype:"cell.button",itemId:"ide-build-ios-open-plugin-config-button",ui:"light",width:150,text:Forte.Resources.Text.BUILD_IOS_OPEN_PLUGIN_CONFIG,handler:function(){var b=Ext.getCmp("maintab");b?(b.setActiveTab(0),Ext.getCmp("monaca:settings").setActiveItem(Forte.Setting.PAGE_CORDOVA_PLUGINS),
Ext.getCmp("monaca:settings").setActivePanel(Forte.Setting.PAGE_CORDOVA_PLUGINS)):MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_CORDOVA_PLUGINS));a.close()}},{xtype:"cell.button",itemId:"ide-build-ios-cancelbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){clearInterval(control.checkStatusInterval);a.forceClose=!0;a.close()}},{xtype:"cell.button",itemId:"ide-build-ios-backbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_PREV,
handler:function(){a.getLayout().prev()}},{xtype:"cell.button",ui:"light",itemId:"ide-build-ios-nextbutton",disabled:!0,width:100,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){var b=a.items.indexOf(a.getLayout().getActiveItem());if(b===Forte.Build.IOSDialog.PAGE_METHOD){if("debugger"===a.buildType){Forte.Debugger.IOSDialog.showWindow({activeItem:1,isFromBuildDialog:!0});a.close();return}if("inapp-updater"!==a.buildType){Forte.API.canBuildIOSApp(function(b){var c=Ext.getCmp("ReuseProvisioningCheckbox");
!0==b[{itunes:"has_dev_provisioning",adhoc:"has_adhoc_provisioning",appstore:"has_release_provisioning"}[a.buildType]]?(a.setReuseCheckboxVisible(!0),c.setValue(!0),Ext.getCmp("ProvisioningFileField").setDisabled(!0),a.down("#ide-build-ios-nextbutton").setDisabled()):(a.setReuseCheckboxVisible(!1),c.setValue(!1),Ext.getCmp("ProvisioningFileField").setDisabled(!1),Ext.getCmp("ProvisioningFileField").value="",a.down("#ide-build-ios-nextbutton").setDisabled(!0));Ext.getCmp("ProvisioningFileField").setRawValue("");
Ext.getCmp("ProvisioningFileField").reset();a.down("#uploadedBox").update("")},function(){a.down("#ide-build-ios-nextbutton").setDisabled(!0)});return}}if(b===Forte.Build.IOSDialog.PAGE_CONFIG||b===Forte.Build.IOSDialog.PAGE_METHOD&&"inapp-updater"===a.buildType){a.getLayout().setActiveItem(Forte.Build.IOSDialog.PAGE_PROGRESS);var c;switch(a.buildType){case "itunes":c="debug";break;case "adhoc":c="adhoc";break;case "appstore":c="release";break;case "inapp-updater":c="inapp_updater"}a.down("#ide-build-progress").setText(Forte.Resources.Text.BUILD_PREPARING);
control=new Forte.Build.BuildControl;control.build("ios",c,function(b,e){!0!=a.forceClose&&!("build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode)&&(a.close(),Ext.create("Forte.Build.IOSSuccessDialog",{binaryUrl:b.binary_url,fileName:b.package_info.package_name,build_log:b.build_log,ios_network_install_url:b.ios_network_install_url,ios_package_publish_url:b.ios_package_publish_url,paidForAppUpload:b.paidForAppUpload,isProjectOwner:b.isProjectOwner,proceedToAppUpload:b.proceedToAppUpload,hasAppUploadSupport:b.hasAppUploadSupport,
purpose:c,queue_id:e,modal:a.modal}).show())},function(b,e){!0!=a.forceClose&&!("build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode)&&(a.close(),Ext.create("Forte.Build.BuildFailDialog",{target:"ios",purpose:c,error_message:b.error_message,build_log:b.build_log,queue_id:e,modal:a.modal}).show())},function(b){a.down("#ide-build-progress").setText(b.description)})}}}],items:[{layout:"vbox",width:b[0],height:b[1],listeners:{activate:function(){a.down("#ide-build-ios-open-plugin-config-button").hide();
a.down("#ide-build-ios-openconfigbutton").show();a.down("#ide-build-ios-cancelbutton").hide();a.down("#ide-build-ios-backbutton").hide();a.down("#ide-build-ios-nextbutton").hide()}},items:[{xtype:"component",cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.BUILD_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-100,style:"margin-left: 10px;"},
{xtype:"component",cls:"ide-build-description",width:b[0]-80,height:130,html:"<h1>"+Forte.Resources.Text.BUILD_IOS_STEP1_H1+"</h1><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_SENTENCE+"</p>"},{xtype:"container",cls:"ide-build-warningbox",height:220,width:b[0]-100,layout:"vbox",style:"margin-left: 10px;",items:[{xtype:"component",html:"<h2>"+Forte.Resources.Text.BUILD_IOS_ERROR_H2+"</h2><p>"+Forte.Resources.Text.BUILD_IOS_ERROR_1+"</p>"},{xtype:"component",cls:"ide-build-error-itemize",html:"<ul><li>"+
Forte.Resources.Text.BUILD_IOS_ERROR_2+"</li><li>"+Forte.Resources.Text.BUILD_IOS_ERROR_3+"</li></ul>"}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-ios-open-plugin-config-button").hide();a.down("#ide-build-ios-openconfigbutton").hide();a.down("#ide-build-ios-cancelbutton").hide();a.down("#ide-build-ios-backbutton").hide();a.down("#ide-build-ios-nextbutton").show();a.down("#ide-build-ios-nextbutton").disable();a.down("#ide-build-ios-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT)}},
items:[{xtype:"component",cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.BUILD_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-100,style:"margin-left: 10px; margin-bottom: 20px;"},{xtype:"component",cls:"ide-build-description",width:b[0]-80,height:96,html:"<h1>"+Forte.Resources.Text.BUILD_IOS_STEP1_H1+"</h1><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_SENTENCE+
"</p>"},{xtype:"container",layout:"vbox",height:350,items:[{id:"itunesBoxId",itemId:"itunesBox",cls:"ide-build-ios-step1-itunes ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){a.hasDevCert&&($(".ide-build-selectbox").removeClass("selected"),$(".icon-build-type").removeClass("selected"),$(".ide-build-ios-step1-itunes").addClass("selected"),$("#ide-build-ios-step1-itunes").addClass("selected"),a.checkBuildType("itunes"),$(a.down("#provisioningType").getEl().dom).html(Forte.Resources.Text.BUILD_IOS_STEP2_1_ITUNES_SENTENCE),
a.down("#ide-build-ios-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT))})}},items:[{xtype:"radio",name:"itunes",itemId:"itunes",cls:"radio-button",width:40},{xtype:"component",cls:"ide-build-ios-step1-itunes icon-build-type",width:80,height:70},{xtype:"component",id:"ios-debug-build-text",cls:"ide-build-selectbox-text",width:b[0]-224}]},{id:"adhocBoxId",itemId:"adhocBox",cls:"ide-build-ios-step1-adhoc ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",
function(){a.hasDistCert&&($(".ide-build-selectbox").removeClass("selected"),$(".icon-build-type").removeClass("selected"),$(".ide-build-ios-step1-adhoc").addClass("selected"),$("#ide-build-ios-step1-adhoc").addClass("selected"),a.checkBuildType("adhoc"),$(a.down("#provisioningType").getEl().dom).html(Forte.Resources.Text.BUILD_IOS_STEP2_1_ADHOC_SENTENCE),a.down("#ide-build-ios-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT))})}},items:[{xtype:"radio",name:"adhoc",itemId:"adhoc",cls:"radio-button",
width:40},{xtype:"component",cls:"ide-build-ios-step1-adhoc icon-build-type",width:80,height:70},{xtype:"component",id:"ios-adhoc-build-text",cls:"ide-build-selectbox-text",width:b[0]-224}]},{id:"appstoreBoxId",xtype:"panel",itemId:"appstoreBox",cls:"ide-build-ios-step1-appstore ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){a.hasDistCert&&($(".ide-build-selectbox").removeClass("selected"),$(".icon-build-type").removeClass("selected"),
$(".ide-build-ios-step1-appstore").addClass("selected"),$("#ide-build-ios-step1-appstore").addClass("selected"),a.checkBuildType("appstore"),$(a.down("#provisioningType").getEl().dom).html(Forte.Resources.Text.BUILD_IOS_STEP2_1_APPSTORE_SENTENCE),a.down("#ide-build-ios-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT))})}},items:[{xtype:"radio",name:"appstore",itemId:"appstore",cls:"radio-button",width:40},{xtype:"component",cls:"ide-build-ios-step1-appstore icon-build-type",width:80,height:70},
{xtype:"component",id:"ios-release-build-text",cls:"ide-build-selectbox-text",width:b[0]-224}]},{itemId:"debuggerBox",cls:"ide-build-ios-step1-debugger ide-build-selectbox",layout:"hbox",width:b[0]-80,height:70,listeners:{render:function(b){b.getEl().on("click",function(){a.hasDevCert&&($(".ide-build-selectbox").removeClass("selected"),$(".icon-build-type").removeClass("selected"),$(".ide-build-ios-step1-debugger").addClass("selected"),a.checkBuildType("debugger"),a.down("#ide-build-ios-nextbutton").setText(Forte.Resources.Text.GENERAL_NEXT))})}},
items:[{xtype:"radio",name:"debugger",itemId:"debugger",cls:"radio-button",width:40},{xtype:"component",cls:"ide-build-ios-step1-debugger icon-build-type",width:80,height:70},{xtype:"component",cls:"ide-build-selectbox-text",width:b[0]-224,html:'<h3 class="build-type-title">'+Forte.Resources.Text.BUILD_IOS_STEP1_DEBUGGER+"</h3><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_DEBUGGER_SENTENCE+"</p>"}]},{id:"inAppUpdaterBoxId",xtype:"panel",itemId:"inAppUpdaterBox",cls:"ide-build-ios-step1-inAppUpdater ide-build-selectbox",
layout:"hbox",width:b[0]-80,height:70,hidden:!1,listeners:{render:function(b){b.getEl().on("click",function(){a.pluginInAppUpdater.isInstalled&&($(".ide-build-selectbox").removeClass("selected"),$(".icon-build-type").removeClass("selected"),$(".ide-build-ios-step1-inAppUpdater").addClass("selected"),$("#ide-build-ios-step1-inAppUpdater").addClass("selected"),a.checkBuildType("inapp-updater"),$(a.down("#provisioningType").getEl().dom).html(Forte.Resources.Text.BUILD_IOS_STEP2_1_APPSTORE_SENTENCE),
a.down("#ide-build-ios-nextbutton").setText(Forte.Resources.Text.BUILD_STARTBUILD))})}},items:[{xtype:"radio",itemId:"inapp-updater",cls:"radio-button",width:40},{xtype:"component",cls:"ide-build-ios-step1-inAppUpdater icon-build-type",width:80,height:70},{xtype:"component",id:"ios-inapp-updater-text",cls:"ide-build-selectbox-text",width:b[0]-224}]}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-ios-open-plugin-config-button").hide();a.down("#ide-build-ios-openconfigbutton").hide();
a.down("#ide-build-ios-cancelbutton").hide();a.down("#ide-build-ios-backbutton").show();a.down("#ide-build-ios-nextbutton").show();var b=["BUILD_IOS_STEP2_5","BUILD_IOS_STEP2_5_SENTENCE"];"appstore"==a.buildType?b.forEach(function(a){$(Ext.getDom(a)).parent().hide()}):b.forEach(function(a){$(Ext.getDom(a)).parent().show()})}},items:[{xtype:"component",cls:"ide-build-flow-2of4",html:"<ul><li>"+Forte.Resources.Text.BUILD_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP2_HEADER+"</li><li>"+
Forte.Resources.Text.BUILD_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-100,style:"margin-left: 10px;"},{xtype:"component",cls:"ide-build-description",width:b[0]-80,height:150,html:"<h1>"+Forte.Resources.Text.BUILD_IOS_STEP2_H1+"</h1><p>"+Forte.Resources.Text.BUILD_IOS_STEP2_SENTENCE+"</p>"},{xtype:"component",html:'<h2 class="ide-build-table-title">'+Forte.Resources.Text.BUILD_IOS_STEP2_H2+"</h2>"},{cls:"ide-build-table",width:b[0]-82,height:150,
layout:{type:"table",columns:2},defaults:{xtype:"component"},items:[{width:180,html:Forte.Resources.Text.BUILD_IOS_STEP2_1},{itemId:"provisioningType",html:Forte.Resources.Text.BUILD_IOS_STEP2_1_ITUNES_SENTENCE},{html:Forte.Resources.Text.BUILD_IOS_STEP2_2},{html:Forte.Resources.Text.BUILD_IOS_STEP2_2_SENTENCE},{html:Forte.Resources.Text.BUILD_IOS_STEP2_3},{html:Forte.Resources.Text.BUILD_IOS_STEP2_3_SENTENCE},{html:Forte.Resources.Text.BUILD_IOS_STEP2_4},{html:Forte.Resources.Text.BUILD_IOS_STEP2_4_SENTENCE+
' <a href="'+Forte.Resources.DocumentURL.MANUAL+'build/ios/build_ios/#configure-ios-app" target="_blank"><img src="/img/icon/help.png"/></a>'},{id:"BUILD_IOS_STEP2_5",html:Forte.Resources.Text.BUILD_IOS_STEP2_5},{id:"BUILD_IOS_STEP2_5_SENTENCE",html:Forte.Resources.Text.BUILD_IOS_STEP2_5_SENTENCE}]},c,{height:50,layout:"hbox",fieldLabel:Forte.Resources.Text.BUILD_IOS_STEP2_PROV,labelAlign:"top",width:520,height:60,bodyStyle:"margin-top:0;",items:[{xtype:"filefield",name:"provisioning",width:400,name:"provisioning_ios",
buttonText:Forte.Resources.Text.GENERAL_BROWSE,buttonWidth:100,fieldLabel:Forte.Resources.Text.BUILD_IOS_STEP2_PROV,labelAlign:"top",id:"ProvisioningFileField",listeners:{change:function(){var b="";switch(a.buildType){case "itunes":b="devProvisioning_ios";break;case "adhoc":b="adhocProvisioning_ios";break;case "appstore":b="releaseProvisioning_ios"}a.down("#uploadedBox").update('<img src="/img/loading-icon3.gif" width="16" "/>');var c=Forte.SettingPreviewComponentModels[b];Forte.API.uploadSetting(c.filePath,
b,c.isProject,function(b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b.message);a.down("#ide-build-ios-nextbutton").setDisabled(!1);a.down("#uploadedBox").update('<img src="/img/icon/doc_tag.png" width="16" />');a.hasUploaded[a.buildType]=!0},function(b,c){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,c);a.down("#uploadedBox").update("");a.down("#ide-build-ios-nextbutton").setDisabled(!0)},"provisioning_ios")}}},{style:"padding:3px 0 0 9px; font-size:10px; color:#333;",
xtype:"component",itemId:"uploadedBox",style:"margin-top:21px; margin-left: 5px;",width:25,html:""}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-ios-open-plugin-config-button").hide();a.down("#ide-build-ios-openconfigbutton").hide();a.down("#ide-build-ios-cancelbutton").show();a.down("#ide-build-ios-backbutton").hide();a.down("#ide-build-ios-nextbutton").hide()},beforeshow:function(){"build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode&&(Ext.getCmp("component:mainpanel").openTabBuildHistory(),
a.close())}},items:[{xtype:"component",cls:"ide-build-flow-3of4",html:"<ul><li>"+Forte.Resources.Text.BUILD_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-100,style:"margin-left: 10px;"},{xtype:"component",cls:"ide-build-building",html:"<h1>"+Forte.Resources.Text.BUILD_IOS_STEP3_1+"</h1><p>"+Forte.Resources.Text.BUILD_IOS_STEP3_2+"</p>"},
{xtype:"component",width:b[0]-80,height:60,style:"text-align : center; vertical-align : middle",html:'<img src="/img/loading.gif"/>'},{xtype:"label",itemId:"ide-build-progress",style:"text-align: center",text:Forte.Resources.Text.BUILD_PREPARING}]},{layout:"vbox",width:b[0],height:b[1],listeners:{activate:function(){a.down("#ide-build-ios-open-plugin-config-button").show();a.down("#ide-build-ios-openconfigbutton").hide();a.down("#ide-build-ios-cancelbutton").hide();a.down("#ide-build-ios-backbutton").hide();
a.down("#ide-build-ios-nextbutton").hide()}},items:[{xtype:"component",cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.BUILD_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.BUILD_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-100,style:"margin-left: 10px;"},{xtype:"component",cls:"ide-build-description",width:b[0]-80,height:130,html:"<h1>"+Forte.Resources.Text.BUILD_IOS_STEP1_H1+
"</h1><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_SENTENCE+"</p>"},{xtype:"container",cls:"ide-build-warningbox",height:280,width:b[0]-100,layout:"vbox",style:"margin-left: 10px;",items:[{xtype:"component",html:"<h2>"+Forte.Resources.Text.BUILD_IOS_ERROR_H2+"</h2><p>"+Forte.Resources.Text.BUILD_ERROR_PlUGIN_1+"</p>"},{xtype:"component",cls:"ide-build-error-itemize",html:Forte.Resources.Text.BUILD_ERROR_PlUGIN_2},{xtype:"component",cls:"ide-build-error-itemize",html:Forte.Resources.Text.BUILD_ERROR_PlUGIN_3}]}]}]});
this.callParent()},setReuseCheckboxVisible:function(a){this.getLayout().setActiveItem(Forte.Build.IOSDialog.PAGE_CONFIG);a?this.down("#ReuseProvisioningCheckbox").show():this.down("#ReuseProvisioningCheckbox").hide()},showWindow:function(a){var b=this;b.modal=a&&a.modal?a.modal:!1;b.loadmask.show();b.resetBuildTypeDescription();b.resetDisabledCheckBoxAndIcon();b.setTitle(Forte.Resources.Text.BUILD_IOS_TITLE);Forte.API.listCordovaPlugin(function(a){b.pluginInAppUpdater=window.findObjectByKey(Forte.IDE.PLUGIN_INAPP_UPDATER,
a,"@")||{};b.pluginAssetsEncrypt=window.findObjectByKey(Forte.IDE.PLUGIN_ASSETS_ENCRYPTION,a,"@")||{};Forte.API.canBuildIOSApp(function(a){b.loadmask.hide();b.canBuildResults=a;b.hasDevCert=a.has_dev_certificate&&null==a.dev_certificate_error;b.hasDistCert=a.has_certificate&&null==a.certificate_error;!1==a.has_remaining_slot?(b.close(),Ext.create("Cell.window.RestrictionDialog").showWindow("BUILD")):!1===a.is_start_file_exist?(b.close(),Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
Forte.Resources.Text.ERROR_START_FILE_NOT_FOUND)):a.info_plist_error&&parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_SIX?(b.close(),Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.ERROR_IOS_INFO_PLIST+a.info_plist_error)):!1==a.has_splash_and_icons?(b.close(),Cell.LightMessageBox.alert(Forte.Resources.Text.BUILD_INFO_NO_IOS_IMAGES_TITLE,Forte.Resources.Text.BUILD_INFO_NO_IOS_IMAGES_MSG,function(){MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_IOS))})):
!1==a.has_assets_encrypt_password&&b.pluginAssetsEncrypt.isInstalled?(b.close(),Cell.LightMessageBox.alert(Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_TITLE,Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_NOT_EXISTS,function(){Forte.Widgets.AssetsEncryptPasswordWindow.show()})):(!0==a.has_assets_encrypt_password&&b.pluginAssetsEncrypt.isInstalled&&b.setTitle(Forte.Resources.Text.BUILD_IOS_TITLE_ENCRYPTION_PLUGIN_ENABLED),b.pluginInAppUpdater.isInstalled&&!a.has_inapp_updater_setting?(b.close(),Cell.LightMessageBox.alert(Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_TITLE,
Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_NOT_EXISTS,function(){Forte.Widgets.InAppUpdaterSettingWindow.show()})):(b.canBuildResults.has_cordovaio_registry_plugins&&Forte.API.getInstalledCordovaRegistryIoPlugins(function(a){b.show();b.getLayout().setActiveItem(Forte.Build.IOSDialog.PAGE_CORDOVA_REGISTRY_DOWN);var c=$("#component\\:buildios .plugin-list");c.empty();$.each(a,function(a,b){$("<li/>").appendTo(c).text(b)})}),b.hasDevCert||b.hasDistCert?(b.show(null,function(){b.forceClose=!1;
b.showedBuildlog=!1;b.hasDevCert||($(".ide-build-ios-step1-itunes").addClass("ide-build-ios-step1-itunes-disabled"),b.down("#ios-debug-build-text").update(Forte.Build.IOSDialog.MSG_NOT_HAS_DEV_CERT),b.down("#itunes").setDisabled(!0),b.down("#itunesBox").addCls("disabled"));b.hasDistCert||(b.down("#ios-adhoc-build-text").update(Forte.Build.IOSDialog.MSG_NOT_HAS_DIST_CERT_ADHOC),b.down("#ios-release-build-text").update(Forte.Build.IOSDialog.MSG_NOT_HAS_DIST_CERT_RELEASE),$(".ide-build-ios-step1-adhoc").addClass("ide-build-ios-step1-adhoc-disabled"),
$(".ide-build-ios-step1-appstore").addClass("ide-build-ios-step1-appstore-disabled"),b.down("#adhocBox").addCls("disabled"),b.down("#appstoreBox").addCls("disabled"),b.down("#adhoc").setDisabled(!0),b.down("#appstore").setDisabled(!0))}),$(".ide-build-selectbox").removeClass("selected"),$(".icon-build-type").removeClass("selected"),b.getLayout().setActiveItem(Forte.Build.IOSDialog.PAGE_METHOD),b.pluginInAppUpdater.canUsed?b.pluginInAppUpdater.isInstalled||(b.down("#ios-inapp-updater-text").update(Forte.Build.AndroidDialog.MSG_INAPP_UPDATER_DISABLED),
b.down("#inapp-updater").setDisabled(!0),b.down("#inAppUpdaterBox").addCls("disabled")):(b.down("#ios-inapp-updater-text").update(Forte.Build.AndroidDialog.MSG_INAPP_UPDATER_CANNOT_USE),b.down("#inapp-updater").setDisabled(!0),b.down("#inAppUpdaterBox").addCls("disabled")),3.5>=parseFloat(Forte.API.cordovaVersion)&&b.down("#ios-inapp-updater-text").update(Forte.Build.AndroidDialog.BUILD_INFO_NEED_TO_UPGRADE_CORDOVA_VERSION),b.checkBuildType()):(b.show(),b.getLayout().setActiveItem(Forte.Build.IOSDialog.PAGE_ERROR))))}).error(function(a){b.loadmask.hide();
Forte.API.convertFail(Forte.API.showProjectSettingError,a)})})},resetDisabledCheckBoxAndIcon:function(){this.down("#itunesBox").removeCls("disabled");this.down("#adhocBox").removeCls("disabled");this.down("#appstoreBox").removeCls("disabled");this.down("#inAppUpdaterBox").removeCls("disabled");this.down("#itunes").setDisabled(!1);this.down("#adhoc").setDisabled(!1);this.down("#appstore").setDisabled(!1);this.down("#inapp-updater").setDisabled(!1)},resetBuildTypeDescription:function(){this.down("#ios-debug-build-text").update(Forte.Build.IOSDialog.METHOD_DEBUG_TEXT);
this.down("#ios-adhoc-build-text").update(Forte.Build.IOSDialog.METHOD_ADHOC_TEXT);this.down("#ios-release-build-text").update(Forte.Build.IOSDialog.METHOD_RELEASE_TEXT);this.down("#ios-inapp-updater-text").update(Forte.Build.IOSDialog.METHOD_INAPP_UPDATER_TEXT)},checkBuildType:function(a){this.down("#itunes").setValue(!1);this.down("#adhoc").setValue(!1);this.down("#appstore").setValue(!1);this.down("#inapp-updater").setValue(!1);this.down("#debugger").setValue(!1);"undefined"!==typeof a&&(this.down("#"+
a).setValue(!0),this.buildType=a,this.down("#ide-build-ios-nextbutton").setDisabled(!1))}})})();Forte.Build.IOSDialog.PAGE_ERROR=0;Forte.Build.IOSDialog.PAGE_METHOD=1;Forte.Build.IOSDialog.PAGE_CONFIG=2;Forte.Build.IOSDialog.PAGE_PROGRESS=3;Forte.Build.IOSDialog.PAGE_CORDOVA_REGISTRY_DOWN=4;Forte.Build.IOSDialog.METHOD_DEBUG_TEXT='<h3 class="build-type-title">'+Forte.Resources.Text.BUILD_IOS_STEP1_1+"</h3><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_1_SENTENCE+"</p>";
Forte.Build.IOSDialog.METHOD_ADHOC_TEXT='<h3 class="build-type-title">'+Forte.Resources.Text.BUILD_IOS_STEP1_2+"</h3><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_2_SENTENCE+"</p>";Forte.Build.IOSDialog.METHOD_RELEASE_TEXT="<h3>"+Forte.Resources.Text.BUILD_IOS_STEP1_3+"</h3><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_3_SENTENCE+"</p>";Forte.Build.IOSDialog.METHOD_INAPP_UPDATER_TEXT="<h3>"+Forte.Resources.Text.BUILD_IOS_STEP1_4+"</h3><p>"+Forte.Resources.Text.BUILD_IOS_STEP1_4_SENTENCE+"</p>";
Forte.Build.IOSDialog.MSG_NOT_HAS_DEV_CERT="<h3>"+Forte.Resources.Text.BUILD_IOS_STEP1_1+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_IOS_STEP1_1_SENTENCE_ERROR+"</p>";Forte.Build.IOSDialog.MSG_NOT_HAS_DIST_CERT_ADHOC="<h3>"+Forte.Resources.Text.BUILD_IOS_STEP1_2+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_IOS_STEP1_2_SENTENCE_ERROR+"</p>";
Forte.Build.IOSDialog.MSG_NOT_HAS_DIST_CERT_RELEASE="<h3>"+Forte.Resources.Text.BUILD_IOS_STEP1_3+'</h3><p style="color:#900">'+Forte.Resources.Text.BUILD_IOS_STEP1_2_SENTENCE_ERROR+"</p>";(function(){Ext.define("Forte.Build.IOSSuccessDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.iossuccess",binaryUrl:null,fileName:null,build_log:null,ios_network_install_url:null,showedBuildlog:!1,queue_id:null,initComponent:function(){var a=this,b=[580,520];Ext.apply(this,{id:"component:buildios-success",cls:"ide-build-window",title:Forte.Resources.Text.BUILD_SUCCESS_WINDOW_TITLE,layout:"vbox",width:b[0],height:b[1],closable:!0,resizable:!1,items:[{xtype:"container",id:"ios-success-dialog-description",
cls:"ide-build-description ide-build-description-"+a.purpose,width:b[0]-80,style:"margin-top: 30px",html:"<h1>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS+"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS_MESSAGE+"</p>"},{xtype:"textarea",itemId:"buildlog",cls:"ide-build-success-buildlog",width:b[0]-160,height:130,hidden:!0,style:"margin-left: 40px;",listeners:{afterrender:function(a){$("textarea",a.getEl().dom).click(function(){$(this).select();copyToClipboard()})}}},
{xtype:"container",height:264,layout:"hbox",items:function(){switch(a.purpose){case "debug":return a.setDebugPanel(a);case "adhoc":return a.setTestPanel(a);case "release":return a.isProjectOwner?a.setReleasePanel(a):a.setReleasePanelWithoutUpload(a);case "inapp_updater":return a.setInAppUpdaterPanel(a)}}()}],listeners:{beforedestroy:function(){MessageHub.send(new Message.SetOnUnloadStatus(!0))},afterRender:function(){$(".btn-buildlog-success").click(function(){if(!a.showedBuildlog){var b=a.down("#buildlog");
b.setValue(htmlEscape(a.build_log));b.show();a.setHeight(a.getHeight()+130);a.showedBuildlog=!0}})}}});this.callParent()},setDebugPanel:function(a){return[{width:185,height:264,border:!1,bodyCls:"ide-build-ios-success-local-left",html:'<div class="ide-build-success-button" style="left:40px; text-align: center;">'+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON4+"</div>",listeners:{afterRender:function(b){b.body.on("click",function(){window.open(a.binaryUrl)})}}},{xtype:"panel",width:352,height:264,
border:!1,html:'<div class="ide-build-ios-success-panel ide-build-ios-itunes" style="background-image: url(/img/build/ios/info-area-itunes-install.png)">'+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON5+"</div>"}]},setTestPanel:function(a){var b=[580,600];return[{xtype:"container",width:~~((b[0]-80)/3),height:250,border:!1,cls:"ide-build-ios-success-qr ide-build-success-button",html:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON1+'<img style="margin:20px 0 0 0" src="'+Forte.API.qrcode(a.ios_network_install_url)+
'"/>'},{xtype:"container",width:~~((b[0]-80)/3),height:250,cls:"ide-build-ios-success-local ide-build-success-button",border:!1,html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){window.open(a.binaryUrl)})}}},{xtype:"container",width:~~((b[0]-80)/3),height:250,border:!1,cls:"ide-build-ios-success-mail ide-build-success-button",html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON3+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",
function(){Cell.LightMessageBox.show({title:Forte.Resources.Text.GENERAL_MONACAIDE,msg:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL_COMFIRM,buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"===b&&Forte.API.sendApp(a.queue_id,function(){Cell.LightMessageBox.alert(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL)})}})})}}}]},setReleasePanel:function(a){return[{xtype:"container",width:186,height:250,border:!1,cls:"ide-build-ios-success-local-left ide-build-success-button",
html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){window.open(a.binaryUrl)})}}},{xtype:"container",width:313,height:250,border:!1,cls:"ide-build-ios-success-panel ide-build-success-button",html:'<div class="ide-build-ios-title">'+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON_ITUNES_CONNECT_TITLE+'</div><div class="ide-build-ios-note">'+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON_ITUNES_CONNECT_NOTE+
"</div>",listeners:{afterRender:function(b){b.getEl().on("click",function(){if(a.proceedToAppUpload)-1<window.location.href.indexOf("build")?Forte.API.getSessionUrl(a.ios_package_publish_url).success(function(b){window.open(b.result.url);a.close()}):(window.open(a.ios_package_publish_url),-a.close()),Forte.API.sendEventToGA("iosPublish","execute",{proceedToAppUpload:a.proceedToAppUpload,paidForAppUpload:a.paidForAppUpload,hasAppUploadSupport:a.hasAppUploadSupport});else{var b=Ext.create("Cell.window.LightWindow",
{id:"component:appupload-plan",layout:"vbox",width:430,height:a.hasAppUploadSupport?418:279,closable:!0,resizable:!1,draggable:!0,title:Forte.Resources.Text.BUILD_CONTROL_APPUPLOAD_TITLE,defaults:{width:390},items:[{xtype:"component",cls:"monthly-plan",html:'<div class="monthly-plan-title">'+Forte.Resources.Text.BUILD_CONTROL_APPUPLOAD_MONTHLY_TITLE+'</div><div class="monthly-plan-subtitle">'+Forte.Resources.Text.BUILD_CONTROL_APPUPLOAD_MONTHLY_BODY+'</div><div class="monthly-plan-details"><img src="/img/build/ios/txt_benefits_'+
LANG+'.png" /></div>'},{xtype:"container",cls:"monthly-plan-upgrade",items:[{xtype:"component",html:'<img src="/img/build/ios/txt_fee_'+LANG+'.png" />'},{xtype:"cell.button",ui:"blue",text:Forte.Resources.Text.GENERAL_UPGRADE,handler:function(){window.open(Forte.API.websiteHost+"/plan/change");Forte.API.sendEventToGA("iosPublish","upgrade",{proceedToAppUpload:a.proceedToAppUpload,paidForAppUpload:a.paidForAppUpload,hasAppUploadSupport:a.hasAppUploadSupport})}}]},{xtype:"button",cls:"onetime",hidden:!a.hasAppUploadSupport,
html:'<img src="/img/build/ios/txt_onetime_'+LANG+'.png" />',width:430,handler:function(){window.open(a.ios_package_publish_url);b.close();a.close();Forte.API.sendEventToGA("iosPublish","execute",{proceedToAppUpload:a.proceedToAppUpload,paidForAppUpload:a.paidForAppUpload,hasAppUploadSupport:a.hasAppUploadSupport})}}]});b.show()}})}}}]},setReleasePanelWithoutUpload:function(a){return[{xtype:"container",width:186,height:250,border:!1,cls:"ide-build-ios-success-local-left ide-build-success-button",
html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){window.open(a.binaryUrl)})}}}]},setInAppUpdaterPanel:function(a){var b=[600,610];return[{layout:{type:"vbox",align:"center"},width:b[0]-80,height:b[1],items:[{xtype:"component",width:185,height:264,style:"margin:15px",border:!1,cls:"ide-build-ios-success-inapp-updater",html:'<div style="margin-left: 31px;font-size: 14px;font-weight: bold;">'+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+
"</div>",listeners:{afterRender:function(b){var e="<h1>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS+"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS_MESSAGE_FOR_IN_APP_UPDATER+"</p>";a.down("#ios-success-dialog-description").update(e);b.getEl().on("click",function(){window.open(a.binaryUrl)})}}}]}]}})})();(function(){Ext.define("Forte.Build.WinrtDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.winrtdialog",singleton:!0,modal:!1,buildType:"",hasDevCert:!1,hasDistCert:!1,showedBuildlog:!1,dataStore:Ext.create("Ext.data.Store",{fields:["alias"],data:{}}),forceClose:!1,listeners:{show:function(){Forte.API.sendEventToGA("build","show","win")},close:function(){try{clearInterval(control.checkStatusInterval)}catch(a){}}},initComponent:function(){var a=this,b=[600,320];Ext.apply(this,{id:"component:buildwinrt",
cls:"ide-build-window",title:Forte.Resources.Text.BUILD_WINRT_TITLE,width:b[0],height:b[1],closeAction:"hide",closable:!0,resizable:!1,layout:"card",activeItem:0,bbar:["->",{xtype:"cell.button",itemId:"ide-build-winrt-cancelbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){clearInterval(control.checkStatusInterval);a.forceClose=!0;a.close()}},{xtype:"cell.button",itemId:"ide-build-winrt-nextbutton",ui:"light",width:100,text:Forte.Resources.Text.BUILD_STARTBUILD,
handler:function(){a.buildType="debug";"debug"==a.buildType&&(a.getLayout().setActiveItem(1),a.down("#ide-build-progress").setText(Forte.Resources.Text.BUILD_PREPARING),control=new Forte.Build.BuildControl,control.build("winrt","debug",function(b,e){!0!=a.forceClose&&!("build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode)&&(a.close(),Ext.create("Forte.Build.WinrtSuccessDialog",{binaryUrl:b.binary_url,fileName:b.package_info.package_name,build_log:b.build_log,purpose:"debug",queue_id:e,modal:a.modal}).show())},
function(b,e){!0!=a.forceClose&&!("build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode)&&(a.close(),Ext.create("Forte.Build.BuildFailDialog",{target:"winrt",purpose:"debug",build_log:b.build_log,queue_id:e,modal:a.modal}).show())},function(b){a.down("#ide-build-progress").setText(b.description)}))}}],items:[{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-winrt-cancelbutton").hide();a.down("#ide-build-winrt-nextbutton").show()}},items:[{xtype:"container",
cls:"ide-build-description",width:b[0]-80,height:140,layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.BUILD_WINRT_STEP1_H1+"</h1><p>"+Forte.Resources.Text.BUILD_WINRT_STEP1_SENTENCE+"</p>"},{xtype:"component",id:"ide-build-winrt-script",hidden:!0,html:'<p style="font:12px;color: #EE0000;">'+Forte.Resources.Text.BUILD_CORDOVA6_NOTIFICATION+"</p>"}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-winrt-cancelbutton").show();a.down("#ide-build-winrt-nextbutton").hide()},
beforeshow:function(){"build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode&&(Ext.getCmp("component:mainpanel").openTabBuildHistory(),a.close())}},items:[{xtype:"component",cls:"ide-build-building",width:b[0]-80,height:147,html:"<h1>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_1+"<h1><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_2+"</p>"},{xtype:"component",width:b[0]-80,height:40,style:"text-align : center; vertical-align : middle",html:'<img src="/img/loading.gif"/>'},{xtype:"label",itemId:"ide-build-progress",
style:"text-align: center",text:Forte.Resources.Text.BUILD_PREPARING}]}]});this.callParent()},showWindow:function(a){var b=this;b.modal=a&&a.modal?a.modal:!1;b.show(null,function(){b.forceClose=!1;b.showedBuildlog=!1});b.getLayout().setActiveItem(0)}})})();(function(){Ext.define("Forte.Build.ChromeDialog",{extend:"Cell.window.LightWindow",showedBuildlog:!1,modal:!1,singleton:!0,forceClose:!1,listeners:{show:function(){Forte.API.sendEventToGA("build","show","chrome")},close:function(){try{clearInterval(control.checkStatusInterval)}catch(a){}}},initComponent:function(){var a=this,b=[600,300];Ext.apply(this,{id:"component:buildchrome",cls:"ide-build-window",title:Forte.Resources.Text.BUILD_CHROME_TITLE,width:b[0],height:b[1],closeAction:"hide",closable:!0,
resizable:!1,layout:"card",activeItem:0,bbar:["->",{xtype:"cell.button",itemId:"ide-build-chrome-cancelbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){clearInterval(control.checkStatusInterval);a.forceClose=!0;a.close()}},{xtype:"cell.button",itemId:"ide-build-chrome-nextbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){a.getLayout().setActiveItem(1);a.down("#ide-build-progress").setText(Forte.Resources.Text.BUILD_PREPARING);
control=new Forte.Build.BuildControl;control.build("chrome","release",function(b,e){!0!=a.forceClose&&!("build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode)&&(a.close(),Ext.create("Forte.Build.ChromeSuccessDialog",{binaryUrl:b.binary_url,fileName:b.package_info.package_name,build_log:b.build_log,queue_id:e,modal:a.modal}).show())},function(b,e){!0!=a.forceClose&&(a.close(),"build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode||Ext.create("Forte.Build.BuildFailDialog",{target:"chrome",
purpose:"release",build_log:b.build_log,queue_id:e,modal:a.modal}).show())},function(b){a.down("#ide-build-progress").setText(b.description)})}}],items:[{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_SIX?(a.down("#ide-build-chrome-cancelbutton").hide(),a.down("#ide-build-chrome-nextbutton").hide(),a.down("#ide-build-chrome-descript").show()):(a.down("#ide-build-chrome-cancelbutton").hide(),a.down("#ide-build-chrome-nextbutton").show())}},
items:[{xtype:"container",cls:"ide-build-description",width:b[0]-80,height:125,style:"margin-top: 45px;",layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.BUILD_CHROME_STEP1_H1+"</h1><p>"+Forte.Resources.Text.BUILD_CHROME_DESCRIPTION+"</p>"},{xtype:"component",id:"ide-build-chrome-descript",hidden:!0,html:'<p style="font: 12px;color: #EE0000;">'+Forte.Resources.Text.BUILD_CORDOVA6_NOTIFICATION+"</p>"}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-build-chrome-cancelbutton").show();
a.down("#ide-build-chrome-nextbutton").hide()},beforeshow:function(){"build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode&&(Ext.getCmp("component:mainpanel").openTabBuildHistory(),a.close())}},items:[{xtype:"component",cls:"ide-build-building",width:b[0]-80,height:137,html:"<h1>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_1+"<h1><p>"+Forte.Resources.Text.BUILD_ANDROID_STEP3_2+"</p>"},{xtype:"component",width:b[0]-80,height:34,style:"text-align : center; vertical-align : middle",html:'<img src="/img/loading.gif"/>'},
{xtype:"label",itemId:"ide-build-progress",style:"text-align: center",text:Forte.Resources.Text.BUILD_PREPARING}]}]});this.callParent()},showWindow:function(a){var b=this;b.modal=a&&a.modal?a.modal:!1;b.show(null,function(){b.forceClose=!1;b.showedBuildlog=!1});b.getLayout().setActiveItem(0)}})})();(function(){Ext.define("Forte.Build.WinrtSuccessDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.winrtsuccess",binaryUrl:null,fileName:null,build_log:null,showedBuildlog:!1,queue_id:null,initComponent:function(){var a=this,b=[580,520];Ext.apply(this,{cls:"ide-build-window",title:Forte.Resources.Text.BUILD_SUCCESS_WINDOW_TITLE,width:b[0],height:b[1],closable:!0,resizable:!1,layout:"vbox",items:[{xtype:"container",cls:"ide-build-description ide-build-description-"+a.purpose,width:b[0]-
80,style:"margin-top: 30px",html:"<h1>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS+"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS_MESSAGE+"</p>"},{xtype:"textarea",itemId:"buildlog",cls:"ide-build-success-buildlog",width:b[0]-160,height:130,hidden:!0,style:"margin-left: 40px;",listeners:{afterrender:function(a){$("textarea",a.getEl().dom).click(function(){$(this).select();copyToClipboard()})}}},{xtype:"container",height:250,layout:"hbox",items:[{xtype:"component",
cls:"ide-build-success-qr ide-build-success-button",width:~~((b[0]-80)/3),height:250,html:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON1+'<img style="margin:40px 0 0 0" src="'+Forte.API.qrcode(a.binaryUrl)+'"/>'},{xtype:"component",cls:"ide-build-success-local ide-build-success-button",width:~~((b[0]-80)/3),height:250,html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){window.open(a.binaryUrl)})}}},{xtype:"component",
cls:"ide-build-success-mail ide-build-success-button",width:~~((b[0]-80)/3),height:250,html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON3+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){Cell.LightMessageBox.show({title:Forte.Resources.Text.GENERAL_MONACAIDE,msg:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL_COMFIRM,buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"===b&&Forte.API.sendApp(a.queue_id,function(){Forte.MessageBox.alert(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,
Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL)})}})})}}}]}],listeners:{beforedestroy:function(){MessageHub.send(new Message.SetOnUnloadStatus(!0))},afterRender:function(){$(".btn-buildlog-success").click(function(){if(!a.showedBuildlog){var b=a.down("#buildlog");b.setValue(htmlEscape(a.build_log));b.show();b.setHeight(130);a.setHeight(a.getHeight()+130);a.showedBuildlog=!0}})}}});this.callParent()}})})();(function(){Ext.define("Forte.Build.ChromeSuccessDialog",{extend:"Cell.window.LightWindow",binaryUrl:null,fileName:null,build_log:null,showedBuildlog:!1,queue_id:null,initComponent:function(){var a=this,b=[580,520];Ext.apply(this,{cls:"ide-build-window",title:Forte.Resources.Text.BUILD_SUCCESS_WINDOW_TITLE,width:b[0],height:b[1],closable:!0,resizable:!1,layout:"vbox",items:[{xtype:"container",cls:"ide-build-description",width:b[0]-80,style:"margin-top: 30px",html:"<h1>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS+
"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_CONGRATULATIONS_MESSAGE+"</p>"},{xtype:"textarea",itemId:"buildlog",cls:"ide-build-success-buildlog",width:b[0]-160,height:130,hidden:!0,style:"margin-left: 40px;",listeners:{afterrender:function(a){$("textarea",a.getEl().dom).click(function(){$(this).select();copyToClipboard()})}}},{xtype:"container",height:250,layout:"hbox",items:[{xtype:"component",cls:"ide-build-success-local ide-build-success-button",width:~~((b[0]-80)/3),height:250,html:"<span>"+
Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON2+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){window.open(a.binaryUrl)})}}},{xtype:"component",cls:"ide-build-success-mail ide-build-success-button",width:~~((b[0]-80)/3),height:250,html:"<span>"+Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON3+"</span>",listeners:{afterRender:function(b){b.getEl().on("click",function(){Cell.LightMessageBox.show({title:Forte.Resources.Text.GENERAL_MONACAIDE,msg:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL_COMFIRM,
buttons:Cell.LightMessageBox.YESNO,fn:function(b){"yes"===b&&Forte.API.sendApp(a.queue_id,function(){Cell.LightMessageBox.alert(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.BUILD_CONTROL_SUCCESS_SENDMAIL)})}})})}}}]}],listeners:{beforedestroy:function(){MessageHub.send(new Message.SetOnUnloadStatus(!0))},afterRender:function(){$(".btn-buildlog-success").click(function(){if(!a.showedBuildlog){var b=a.down("#buildlog");b.setValue(htmlEscape(a.build_log));b.show();b.setHeight(130);
a.setHeight(a.getHeight()+130);a.showedBuildlog=!0}})}}});this.callParent()}})})();(function(){Ext.define("Forte.Build.BuildFailDialog",{extend:"Cell.window.LightWindow",alias:"widget.build.buildfaildialog",build_log:null,error_message:null,target:null,title:Forte.Resources.Text.BUILD_ERROR_TITLE,closeAction:"hide",cls:"ide-build-window-fail",closable:!0,resizable:!1,layout:"vbox",width:580,height:540,bbar:["->",{xtype:"cell.button",ui:"light",itemId:"nextButton1",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){this.ownerCt.ownerCt.close()}}],items:[{xtype:"component",
itemId:"fail-reason",cls:"ide-build-description ide-build-error-itemize",width:497,height:200},{xtype:"textarea",itemId:"buildlog",cls:"ide-build-buildlog",width:417,height:160,listeners:{afterrender:function(a){$("textarea",a.getEl().dom).click(function(){$(this).select();copyToClipboard()})}}}],initComponent:function(){void 0===this.build_log&&(this.build_log="");this.on("beforedestroy",function(){MessageHub.send(new Message.SetOnUnloadStatus(true))});this.on("beforerender",function(){var a="";
if(this.target==="ios")a=Forte.Resources.Text.BUILD_CONTROL_ERROR_IOS;else if(this.target==="android")a=Forte.Resources.Text.BUILD_CONTROL_ERROR_ANDROID;this.getComponent("fail-reason").update("<h1>"+Forte.Resources.Text.BUILD_CONTROL_ERROR_H1+"</h1><p>"+Forte.Resources.Text.BUILD_CONTROL_ERROR_SENTENCE+"</p>"+a);this.getComponent("buildlog").setValue(htmlEscape(this.build_log))});this.callParent()}})})();(function(){Ext.define("Forte.Debugger.DebuggerDialog",{extend:"Cell.window.LightWindow",id:"component:debuggerdialog",cls:"ide-debugger-window",title:Forte.Resources.Text.DEBUGGER_ANDROID_TITLE,layout:"card",closable:!0,closeAction:"hide",resizable:!1,singleton:!0,modal:!1,OS_IOS:"ios",OS_ANDROID:"android",OS_CHROME:"chrome",TYPE_STORE:"store",TYPE_BUILD:"build",PAGE_HOME:0,PAGE_IOS:1,PAGE_IOS_STORE:2,PAGE_ANDROID:3,PAGE_ANDROID_STORE:4,PAGE_CONNECT:5,PAGE_CONNECT_FINISH:6,platform:{os:null,type:null},
androidWebViewEngine:null,listeners:{show:function(){var a=this;Forte.Debugger.AndroidDialog.close();Forte.Debugger.IOSDialog.close();Forte.API.readProjectSetting(function(b){parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE?Forte.API.listCordovaPlugin(function(b){for(id in b)if(0==id.indexOf(Forte.IDE.PLUGIN_CROSSWALK,0)){a.androidWebViewEngine=b[id].isInstalled?"crosswalk":"default";break}a.down("#android-wait").hide();a.down("#android-build").enable()}):(a.androidWebViewEngine=
b.config.android.preference["monaca:WebViewEngine"]||"default",a.down("#android-wait").hide(),a.down("#android-build").enable());a.down("#android-error").hide()},function(b,c){a.down("#android-wait").hide();a.down("#android-build").disable();a.down("#android-error").show().update(c)});$("#android-build-ver").text(Forte.API.androidCustomDebuggerVer);Forte.API.getDebuggerVersion("android",function(a){$("#android-store-ver").text(a)});$("#ios-build-ver").text(Forte.API.iosCustomDebuggerVer);Forte.API.getDebuggerVersion("ios",
function(a){$("#ios-store-ver").text(a)})}},initComponent:function(){var a=this,b=[580,610];Ext.apply(this,{width:b[0],height:b[1],defaults:{layout:"vbox",width:b[0]-80,height:b[1],defaults:{xtype:"component"}},bbar:[{xtype:"cell.button",itemId:"homebutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,handler:function(){a.getLayout().setActiveItem(Forte.Debugger.DebuggerDialog.PAGE_HOME)}},{xtype:"cell.button",itemId:"backbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,
handler:function(){a.getLayout().prev()}},"->",{xtype:"cell.button",itemId:"toconnectbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){a.getLayout().setActiveItem(Forte.Debugger.DebuggerDialog.PAGE_CONNECT)}}],items:[{listeners:{activate:function(){a.down("#homebutton").hide();a.down("#backbutton").hide();a.down("#toconnectbutton").hide();a.setTitle(Forte.Resources.Text.DEBUGGER_NAV_HEADER_TITLE)}},items:[{cls:"ide-debugger-title",html:Forte.Resources.Text.DEBUGGER_NAV_TITLE,
style:"padding-top: 30px; margin-bottom: 0;"},{cls:"ide-debugger-description icon monaca",style:"margin: 0 0 15px;",html:Forte.Resources.Text.DEBUGGER_NAV_BODY},{xtype:"container",cls:"ide-debugger-platforms",html:Forte.Resources.Text.DEBUGGER_NAV_SUBTITLE,layout:"hbox",pack:"center",height:280,defaults:{width:166,height:240},items:[{xtype:"button",flex:1,text:Forte.Resources.Text.DEBUGGER_NAV_BTN_ANDROID,icon:"/img/debugger/general/icon_android.png",handler:function(){a.platform.os=Forte.Debugger.DebuggerDialog.OS_ANDROID;
a.getLayout().setActiveItem(Forte.Debugger.DebuggerDialog.PAGE_ANDROID)}},{xtype:"button",flex:1,text:Forte.Resources.Text.DEBUGGER_NAV_BTN_IOS,icon:"/img/debugger/general/icon_ios.png",handler:function(){a.platform.os=Forte.Debugger.DebuggerDialog.OS_IOS;a.getLayout().setActiveItem(Forte.Debugger.DebuggerDialog.PAGE_IOS)}}]}]},{listeners:{activate:function(){a.down("#homebutton").show();a.down("#backbutton").hide();a.down("#toconnectbutton").hide();a.setTitle(Forte.Resources.Text.DEBUGGER_NAV_IOS_HEADER_TITLE);
$(".ide-debugger-btn-vertical a",a.el.dom).off().click(function(a){window.open($(this).attr("href"),"_blank");a.stopPropagation();return!1})}},items:[{cls:"ide-debugger-description",html:Forte.Resources.Text.DEBUGGER_NAV_IOS_TITLE,style:"padding-top: 30px;"},{xtype:"button",cls:"ide-debugger-btn-vertical ios-store",html:Forte.Resources.Text.DEBUGGER_NAV_IOS_STORE,handler:function(){a.platform.type=Forte.Debugger.DebuggerDialog.TYPE_STORE;a.getLayout().setActiveItem(Forte.Debugger.DebuggerDialog.PAGE_IOS_STORE)}},
{xtype:"button",cls:"ide-debugger-btn-vertical ios-build",html:Forte.Resources.Text.DEBUGGER_NAV_IOS_BUILD,handler:function(){var b=new Forte.HeaderPanel.HeaderToolbar;b.openServicesWindow(b.servicesConstants.PAGE_IOS_BUILD_DEBUGGER);a.close()}}]},{listeners:{activate:function(){a.down("#homebutton").hide();a.down("#backbutton").show();a.down("#toconnectbutton").show().disable();a.down("#ide-debugger-ios-checkbox").setValue(!1);a.setTitle(Forte.Resources.Text.DEBUGGER_NAV_IOS_HEADER_TITLE)}},items:[a.createProgressTracker(1,
3),{cls:"ide-debugger-description icon small monaca",html:Forte.Resources.Text.DEBUGGER_NAV_IOS_STORE_TITLE},{xtype:"component",width:500,height:150,style:"text-align: center; padding-left: 30px;",html:"<p><a href='http://itunes.apple.com/"+LANG.replace("ja","jp")+"/app/monaca/id550941371?mt=8' target='_blank'><img src='/img/debugger/general/qr_ios.gif' /><br />"+Forte.Resources.Text.DEBUGGER_NAV_IOS_AT_STORE+"</a></p>"},{html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_INSTRUCTION},{xtype:"checkbox",
itemId:"ide-debugger-ios-checkbox",boxLabel:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_CHECK,style:"margin-top: 10px;",listeners:{change:function(b,e){e?a.down("#toconnectbutton").enable():a.down("#toconnectbutton").disable()}}}]},{listeners:{activate:function(){a.down("#homebutton").show();a.down("#backbutton").hide();a.down("#toconnectbutton").hide();a.setTitle(Forte.Resources.Text.DEBUGGER_NAV_ANDROID_HEADER_TITLE);$(".ide-debugger-btn-vertical a",a.el.dom).off().click(function(a){window.open($(this).attr("href"),
"_blank");a.stopPropagation();return!1})}},items:[{cls:"ide-debugger-description",html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_TITLE,style:"padding-top: 30px;"},{xtype:"button",cls:"ide-debugger-btn-vertical android-store",html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE,handler:function(){a.platform.type=Forte.Debugger.DebuggerDialog.TYPE_STORE;a.getLayout().setActiveItem(Forte.Debugger.DebuggerDialog.PAGE_ANDROID_STORE)}},{xtype:"button",itemId:"android-build",cls:"ide-debugger-btn-vertical android-build",
disabled:!0,html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_BUILD,handler:function(){var b=new Forte.HeaderPanel.HeaderToolbar;b.openServicesWindow(b.servicesConstants.PAGE_ANDROID_BUILD_DEBUGGER);a.close()}},{itemId:"android-wait",cls:"ide-debugger-android-wait",html:Forte.Resources.Text.BUILD_ANDROID_WAITFORCONFIG+" <img src='/img/loading-icon3.gif' width='16' height='16' />"},{itemId:"android-error",cls:"ide-debugger-android-error",html:""}]},{listeners:{activate:function(){a.down("#homebutton").hide();
a.down("#backbutton").show();a.down("#toconnectbutton").show().disable();a.down("#ide-debugger-android-checkbox").setValue(!1);a.setTitle(Forte.Resources.Text.DEBUGGER_NAV_ANDROID_HEADER_TITLE);Forte.API.getDebuggerVersion("android",function(a){document.getElementById("android-store-ver").textContent=a})}},items:[a.createProgressTracker(1,3),{cls:"ide-debugger-description icon small monaca",html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_TITLE},{xtype:"container",cls:"ide-debugger-android-qr",
layout:"absolute",height:160,width:500,defaults:{xtype:"container",width:200,height:140},items:[{x:174,y:0,html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_QR}]},{html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_INSTRUCTION},{xtype:"checkbox",itemId:"ide-debugger-android-checkbox",boxLabel:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_CHECK,style:"margin-top: 10px;",listeners:{change:function(b,e){e?a.down("#toconnectbutton").enable():a.down("#toconnectbutton").disable()}}}]},{cls:"debugger-connect",
layout:{type:"vbox",align:"center"},listeners:{activate:function(){a.resetConnectPage(a);a.getClientList(a)},show:function(){var b=a.down("#connect-flow");b.removeAll();a.platform.type===Forte.Debugger.DebuggerDialog.TYPE_STORE?b.add(a.createProgressTracker(2,3)):b.add(a.createProgressTracker(3,4))}},items:[{xtype:"container",itemId:"connect-flow",width:500,height:73},{xtype:"component",cls:"welcome-title",itemId:"welcome-title",height:50,style:"margin-top: 20px",html:Forte.Resources.Text.DEBUGGER_NAV_CONNECT_TITLE},
{itemId:"welcome-description",cls:"welcome-description",height:60,html:Forte.Resources.Text.DEBUGGER_NAV_CONNECT},{html:"<img src='/img/debugger/general/connect_pc.png' class='pc' /><span class='line'></span><img src='/img/debugger/general/connect_device.png' class='device' /><p class='txt-pc'>"+Forte.Resources.Text.WELCOME_YOUR_PC+"</p><p id='connect-txt-devicename'><img src='/img/loading-icon3.gif' alt='' /> "+Forte.Resources.Text.DEBUGGER_NAV_CONNECT_SEARCHING+"</p>"},{xtype:"container",layout:{type:"hbox",
pack:"left",align:"middle"},height:370,width:400,items:[{xtype:"cell.button",ui:"light",itemId:"connect-back",cls:"connect-back",disabled:!0,text:Forte.Resources.Text.DEBUGGER_NAV_CONNECT_BACK,handler:function(){if(a.platform.type===Forte.Debugger.DebuggerDialog.TYPE_BUILD)switch(a.platform.os){case Forte.Debugger.DebuggerDialog.OS_IOS:Forte.Debugger.IOSDialog.on("show",function f(){Forte.Debugger.IOSDialog.un("show",f,!1);a.close()});Forte.Debugger.IOSDialog.showWindow({activeItem:3});break;case Forte.Debugger.DebuggerDialog.OS_ANDROID:Forte.Debugger.AndroidDialog.on("show",
function g(){Forte.Debugger.AndroidDialog.un("show",g,!1);a.close()}),Forte.Debugger.AndroidDialog.showWindow({activeItem:Forte.Debugger.AndroidDialog.PAGE_SUCCESS,webViewEngine:a.androidWebViewEngine})}switch(a.platform.os){case Forte.Debugger.DebuggerDialog.OS_IOS:var b=Forte.Debugger.DebuggerDialog.PAGE_IOS_STORE;break;case Forte.Debugger.DebuggerDialog.OS_ANDROID:b=Forte.Debugger.DebuggerDialog.PAGE_ANDROID_STORE}a.resetConnectPage(a);a.getLayout().setActiveItem(b)}},{xtype:"cell.button",ui:"blue",
itemId:"connect-search",cls:"connect-search",disabled:!0,text:Forte.Resources.Text.DEBUGGER_NAV_CONNECT_SEARCH,handler:function(){a.resetConnectPage(a);a.getClientList(a)}}]},{xtype:"cell.button",ui:"blue",cls:"connect-run",itemId:"connect-run",hidden:!0,disabled:!0,text:Forte.Resources.Text.DEBUGGER_NAV_RUN,handler:function(){var b=this;b.disable();a.runProject().then(function(){$(".debugger-connect",a.el.dom).removeClass("fail").addClass("ran");$(".debugger-connect .welcome-title",a.el.dom).text(Forte.Resources.Text.DEBUGGER_NAV_RUN_SUCCESS_TITLE);
$(".debugger-connect .welcome-description",a.el.dom).text(Forte.Resources.Text.DEBUGGER_NAV_RUN_SUCCESS_BODY).show();a.down("#welcome-title").setHeight(50);a.down("#connect-search").hide();a.down("#connect-back").hide();a.down("#connect-run").hide();a.down("#connect-close").show();a.platform.type===Forte.Debugger.DebuggerDialog.TYPE_STORE?$(a.down("#connect-flow").el.dom).find(".x-component").removeClass("ide-build-flow-2").addClass("ide-build-flow-3"):$(a.down("#connect-flow").el.dom).find(".x-component").removeClass("ide-build-flow-3of4").addClass("ide-build-flow-4of4")}).fail(function(){b.enable()})}},
{xtype:"cell.button",ui:"light",itemId:"connect-close",cls:"connect-close",hidden:!0,text:Forte.Resources.Text.GENERAL_CLOSE,handler:function(){a.close()}}]}]});this.callParent()},createProgressTracker:function(a,b){var b=4===parseInt(b)?4:3,c="ide-build-flow-"+a,e="";3===b?e="<ul><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP2+"</li><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP3+"</li><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP4+"</li></ul>":(c+="of4",e="<ul><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP1+
"</li><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP2+"</li><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP3+"</li><li>"+Forte.Resources.Text.DEBUGGER_NAV_STEP4+"</li></ul>");return{xtype:"component",cls:c,html:e}},resetConnectPage:function(a){a.down("#homebutton").hide();a.down("#backbutton").hide();a.down("#toconnectbutton").hide();a.down("#connect-close").hide();a.down("#connect-run").disable().hide();a.down("#welcome-description").update(Forte.Resources.Text.DEBUGGER_NAV_CONNECT);$(".debugger-connect",
a.el.dom).removeClass("fail ran connected");$(".debugger-connect .welcome-title",a.el.dom).text(Forte.Resources.Text.DEBUGGER_NAV_CONNECT_TITLE);$("#connect-txt-devicename",a.el.dom).removeClass("android ios winrt chrome").html("<img src='/img/loading-icon3.gif' alt='' /> "+Forte.Resources.Text.DEBUGGER_NAV_CONNECT_SEARCHING);a.down("#connect-back").show().disable();a.down("#connect-search").show().disable();switch(a.platform.os){case Forte.Debugger.DebuggerDialog.OS_IOS:var b=Forte.Resources.Text.DEBUGGER_NAV_IOS_HEADER_TITLE;
break;case Forte.Debugger.DebuggerDialog.OS_ANDROID:b=Forte.Resources.Text.DEBUGGER_NAV_ANDROID_HEADER_TITLE;break;default:b=Forte.Resources.Text.DEBUGGER_NAV_CONNECT_HEADER_TITLE}a.setTitle(b)},getClientList:function(a){Forte.API.getClientList(function(b){if(Object.keys(b).length)for(var c in b){$(".debugger-connect",a.el.dom).addClass("connected");$(".debugger-connect .welcome-title",a.el.dom).text(b[c].clientName+Forte.Resources.Text.WELCOME_IS_CONNECTED);$("#connect-txt-devicename",a.el.dom).addClass(b[c].clientInfo.os).text(b[c].clientName);
a.down("#welcome-description").update(Forte.Resources.Text.WELCOME_IS_CONNECTED_DESCRIPTION);a.down("#connect-search").hide();a.down("#connect-back").hide();a.down("#connect-run").show().enable();break}else $(".debugger-connect",a.el.dom).addClass("fail"),$(".debugger-connect .welcome-title",a.el.dom).text(Forte.Resources.Text.DEBUGGER_NAV_CONNECT_FAIL_TITLE),$("#connect-txt-devicename",a.el.dom).text(Forte.Resources.Text.DEBUGGER_NAV_CONNECT_FAIL_DEVICENAME),a.down("#welcome-description").update(Forte.Resources.Text.DEBUGGER_NAV_CONNECT_FAIL_BODY),
a.down("#connect-search").enable(),a.down("#connect-back").enable()})},runProject:function(){var a=$.Deferred(),b=Forte.Widgets.RunToast.showWindow();Forte.API.sendProjectRun().done(function(c){b.close();c.result&&0===c.result.clientsCount?(Forte.Widgets.RunFailDialog.showWindow(),a.reject()):a.resolve()});return a.promise()},showWindow:function(a){var b=this;b.platform.os=null;b.platform.type=null;b.modal=a&&a.modal?a.modal:!1;if(a&&a.activeItem){var c=parseInt(a.activeItem);b.down("#connect-back").disable()}else c=
0;a&&a.platform&&(b.platform.os=a.platform.os,b.platform.type=a.platform.type);b.show(null,function(){b.getLayout().setActiveItem(c)})},closeWindow:function(){this.close()}})})();(function(){Ext.define("Forte.Debugger.BuildControl",{isBuilding:!1,constructor:function(){},build:function(a,b,c,e){if(this.isBuilding)return Cell.LightMessageBox.alert(Forte.Resources.Text.WARNING_TITLE,Forte.Resources.Text.WARNING_BUILD_STARTED_TEXT),!1;"undefined"===typeof b&&(b={});this.isBuilding=!0;return Forte.API.buildDebugger(a,function(a){self.isBuilding=!1;a.result.build_log&&(new Message.InfoPanel.AddBuildlog({buildlog:a.result.build_log})).send();"finish"==a.result.status?(setTimeout(function(){c(a.result)},
500),MessageHub.send(new Message.SetOnUnloadStatus(!1))):(e(a.result),(new Message.Notify({message:Forte.Resources.Text.BUILD_FAILURE,type:"warning"})).send())},b).error(function(){self.isBuilding=!1})}})})();(function(){Ext.define("Forte.Debugger.IOSDialog",{extend:"Cell.window.LightWindow",alias:"widget.debugger.iosdialog",singleton:!0,modal:!1,buildType:"",hasDevCert:!1,hasDistCert:!1,showedBuildlog:!1,forceClose:!1,canBuild:!1,initComponent:function(){var a=this,b=[580,632];Ext.apply(this,{id:"component:debuggerios",cls:"ide-debugger-window",title:Forte.Resources.Text.DEBUGGER_IOS_TITLE,width:b[0],height:b[1],closeAction:"hide",closable:!0,resizable:!1,layout:"card",activeItem:0,bbar:[{xtype:"cell.button",
itemId:"ide-debugger-ios-backbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,handler:function(){a.getLayout().prev()}},{xtype:"cell.button",itemId:"ide-debugger-ios-platformbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,handler:function(){a.items.indexOf(a.getLayout().getActiveItem());a.isFromBuildDialog?(Forte.Build.IOSDialog.showWindow({activeItem:Forte.Build.AndroidDialog.PAGE_METHOD}),a.close()):Forte.Debugger.DebuggerDialog.showWindow({activeItem:Forte.Debugger.DebuggerDialog.PAGE_IOS,
platform:{os:Forte.Debugger.DebuggerDialog.OS_IOS,type:Forte.Debugger.DebuggerDialog.TYPE_BUILD}})}},"->",{xtype:"cell.button",itemId:"ide-debugger-ios-openbutton",ui:"light",width:150,text:Forte.Resources.Text.DEBUGGER_IOS_OPEN_CONFIG,handler:function(){MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_IOSUSER));a.close()}},{xtype:"cell.button",itemId:"ide-debugger-ios-closebutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){a.close()}},{xtype:"cell.button",
itemId:"ide-debugger-ios-startbutton",ui:"light",width:120,text:Forte.Resources.Text.DEBUGGER_START_BUILD,handler:function(){a.canBuild?a.getLayout().setActiveItem(1):a.getLayout().setActiveItem(0)}},{xtype:"cell.button",itemId:"ide-debugger-ios-nextbutton",ui:"light",width:100,disabled:!0,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){a.getLayout().setActiveItem(2);(new Forte.Debugger.BuildControl).build("ios",{},function(b){!0!=a.forceClose&&(a.getLayout().setActiveItem(3),a.binaryUrl=
b.binary_url,a.build_log=b.build_log)},function(b){!0!=a.forceClose&&(a.getLayout().setActiveItem(4),a.build_log=b.build_log)})}},{xtype:"cell.button",itemId:"ide-debugger-ios-cancelbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.forceClose=!0;a.close()}},{xtype:"cell.button",itemId:"ide-debugger-ios-toconnectbutton",ui:"light",width:100,disabled:!0,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){Forte.Debugger.DebuggerDialog.showWindow({activeItem:Forte.Debugger.DebuggerDialog.PAGE_CONNECT,
platform:{os:Forte.Debugger.DebuggerDialog.OS_IOS,type:Forte.Debugger.DebuggerDialog.TYPE_BUILD}});a.close()}}],items:[{layout:"vbox",width:b[0],height:b[1],listeners:{activate:function(){a.down("#ide-debugger-ios-openbutton").show();a.down("#ide-debugger-ios-closebutton").hide();a.down("#ide-debugger-ios-backbutton").hide();a.down("#ide-debugger-ios-startbutton").hide();a.down("#ide-debugger-ios-nextbutton").hide();a.down("#ide-debugger-ios-cancelbutton").hide();a.down("#ide-debugger-ios-toconnectbutton").hide();
"debugger"===Forte.API.ideMode?a.down("#ide-debugger-ios-platformbutton").hide():a.down("#ide-debugger-ios-platformbutton").show()}},items:[{xtype:"container",cls:"ide-debugger-description",width:b[0]-80,style:"margin-top: 40px",layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.DEBUGGER_IOS_STEP0_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_IOS_STEP0_SENTENCE1+Forte.Resources.Text.DEBUGGER_IOS_STEP1_1_URL+Forte.Resources.Text.DEBUGGER_IOS_STEP0_SENTENCE2+"</p>"}]},{xtype:"container",
cls:"ide-build-warningbox",height:220,layout:"vbox",style:"margin-left: 10px;",width:b[0]-100,items:[{xtype:"component",html:"<h2>"+Forte.Resources.Text.DEBUGGER_IOS_ERROR_H2+"</h2><p>"+Forte.Resources.Text.DEBUGGER_IOS_ERROR_1+"</p>"},{xtype:"component",cls:"ide-build-error-itemize",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_IOS_ERROR_2+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_ERROR_3+"</li></ul>"}]}]},{layout:"vbox",width:b[0],height:b[1],listeners:{activate:function(){a.down("#ide-debugger-ios-openbutton").hide();
a.down("#ide-debugger-ios-closebutton").hide();a.down("#ide-debugger-ios-backbutton").hide();a.down("#ide-debugger-ios-startbutton").hide();a.down("#ide-debugger-ios-nextbutton").show();a.down("#ide-debugger-ios-cancelbutton").hide();a.down("#ide-debugger-ios-toconnectbutton").hide();"debugger"===Forte.API.ideMode?a.down("#ide-debugger-ios-platformbutton").hide():a.down("#ide-debugger-ios-platformbutton").show()}},items:[{xtype:"component",cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP1_HEADER+
"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-80},{xtype:"component",cls:"ide-debugger-description",width:b[0]-80,height:140,html:"<h1>"+Forte.Resources.Text.DEBUGGER_IOS_STEP2_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_IOS_STEP2_SENTENCE+"</p>"},{xtype:"component",html:'<h2 class="ide-build-table-title">'+Forte.Resources.Text.DEBUGGER_IOS_STEP2_H2+
"</h2>"},{xtype:"panel",width:b[0]-82,height:208,cls:"ide-build-table",layout:{type:"table",columns:2},defaults:{xtype:"component"},items:[{width:180,html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_1},{itemId:"provisioningType",html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_1_ITUNES_SENTENCE},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_2},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_2_SENTENCE},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_3},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_3_SENTENCE},
{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_4},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_4_SENTENCE},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_5},{html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_5_SENTENCE}]},{xtype:"component",width:b[0]-80,height:20,html:Forte.Resources.Text.DEBUGGER_IOS_STEP2_PROV},{height:40,width:b[0]-80,layout:"hbox",items:[{xtype:"filefield",name:"debugProvisioning_ios",buttonText:Forte.Resources.Text.GENERAL_BROWSE,buttonWidth:100,width:b[0]-200,listeners:{change:function(){a.down("#uploadedBox").update('<img src="/img/loading-icon3.gif" width="16" />');
var b=Forte.SettingPreviewComponentModels.debugProvisioning_ios;Forte.API.uploadSetting(b.filePath,"debugProvisioning_ios",b.isProject,function(b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b.message);a.down("#ide-debugger-ios-nextbutton").setDisabled(!1);a.down("#uploadedBox").update('<img src="/img/icon/doc_tag.png" width="16" />')},function(b,c){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,c);a.down("#uploadedBox").update("");a.down("#ide-debugger-ios-nextbutton").setDisabled(!0)})}}},
{style:"padding:3px 0 0 9px; font-size:10px; color:#333;",xtype:"component",itemId:"uploadedBox",width:25,html:""}]}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-debugger-ios-openbutton").hide();a.down("#ide-debugger-ios-closebutton").hide();a.down("#ide-debugger-ios-platformbutton").hide();a.down("#ide-debugger-ios-backbutton").hide();a.down("#ide-debugger-ios-startbutton").hide();a.down("#ide-debugger-ios-nextbutton").hide();a.down("#ide-debugger-ios-cancelbutton").show();
a.down("#ide-debugger-ios-toconnectbutton").hide()},beforeshow:function(){"build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode&&(Ext.getCmp("component:mainpanel").openTabBuildHistory(),a.close())}},items:[{xtype:"component",cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_HEADER+"</li></ul>",
width:b[0]-80},{xtype:"component",cls:"ide-build-building",html:"<h1>"+Forte.Resources.Text.DEBUGGER_IOS_STEP3_1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_IOS_STEP3_2+"</p>"},{xtype:"component",width:b[0]-80,height:60,style:"text-align : center; vertical-align : middle",html:'<img src="/img/loading.gif"/>'}]},{layout:"vbox",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-debugger-ios-openbutton").hide();a.down("#ide-debugger-ios-closebutton").hide();a.down("#ide-debugger-ios-backbutton").hide();
a.down("#ide-debugger-ios-startbutton").hide();a.down("#ide-debugger-ios-nextbutton").hide();a.down("#ide-debugger-ios-cancelbutton").hide();"debugger"===Forte.API.ideMode?(a.down("#ide-debugger-ios-toconnectbutton").hide(),a.down("#ide-debugger-ios-toconnectcheck").hide()):a.down("#ide-debugger-ios-toconnectbutton").show()},afterRender:function(){$(".btn-buildlog-success").click(function(){var b=Ext.create("Forte.Widgets.BuildLog");b.setLog(a.buildLog);b.show()})}},items:[{xtype:"component",cls:"ide-build-flow-2of4",
html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-80},{xtype:"component",cls:"ide-debugger-description",width:b[0]-80,height:100,layout:"vbox",html:"<h1>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_SENTENCE+"</p>"},{height:244,layout:"hbox",
items:[{xtype:"container",width:185,height:264,cls:"ide-build-ios-success-local-left ide-build-success-button",html:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON4,listeners:{afterRender:function(b){b.getEl().on("click",function(){location.href=a.binaryUrl})}}},{xtype:"component",cls:"ide-build-ios-success-panel",width:352,height:264,html:Forte.Resources.Text.BUILD_CONTROL_SUCCESS_BUTTON5}]},{html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_INSTRUCTION},{xtype:"checkbox",itemId:"ide-debugger-ios-toconnectcheck",
boxLabel:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_CHECK,style:"margin-top: 10px;",listeners:{change:function(b,e){e?a.down("#ide-debugger-ios-toconnectbutton").enable():a.down("#ide-debugger-ios-toconnectbutton").disable()}}}]},{layout:"vbox",cls:"ide-build-window-fail",width:b[0]-80,height:b[1],listeners:{activate:function(){a.down("#ide-debugger-ios-openbutton").hide();a.down("#ide-debugger-ios-closebutton").show();a.down("#ide-debugger-ios-platformbutton").hide();a.down("#ide-debugger-ios-backbutton").hide();
a.down("#ide-debugger-ios-startbutton").hide();a.down("#ide-debugger-ios-nextbutton").hide();a.down("#ide-debugger-ios-cancelbutton").hide();a.down("#ide-debugger-ios-toconnectbutton").hide()},afterRender:function(){$(".btn-buildlog-fail").click(function(){if(!a.showedBuildlog){var b=a.down("#buildlog2");b.setValue(a.build_log);b.show();a.showedBuildlog=!0}})}},items:[{xtype:"component",cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP2_HEADER+
"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_HEADER+"</li></ul>",width:b[0]-80},{xtype:"component",cls:"ide-debugger-description",width:b[0]-80,html:"<h1>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_SENTENCE+"</p>"},{xtype:"textarea",itemId:"buildlog2",hidden:!0,width:b[0]-84,height:120},{height:224,width:b[0]-80,xtype:"container",border:!1,layout:"vbox",items:[{xtype:"component",
width:b[0]-80,html:"<h2>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_H2+"</h2>"},{xtype:"component",width:b[0]-80,cls:"ide-build-error-itemize",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_1+"</li><li>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_2+"</li></ul>"},{xtype:"component",width:b[0]-80,html:Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_3}]}]}]});this.callParent()},showWindow:function(a){var b=this;this.modal=a&&a.modal?a.modal:!1;b.isFromBuildDialog=a&&a.isFromBuildDialog?
a.isFromBuildDialog:!1;a&&a.binaryUrl&&(b.binaryUrl=a.binaryUrl);a&&a.build_log&&(b.buildLog=a.build_log);Forte.API.canBuildIOSApp(function(c){b.forceClose=false;b.hasDevCert=c.has_dev_certificate;b.hasDistCert=c.has_certificate;if(b.hasDevCert||b.hasDistCert){b.show(null,function(){var c=a&&a.activeItem?a.activeItem:1;b.showedBuildlog=false;b.getLayout().setActiveItem(c)});b.canBuild=true}else b.show(null,function(){b.getLayout().setActiveItem(0)})}).error(function(a){Forte.API.convertFail(Forte.API.showProjectSettingError,
a)})}})})();(function(){Ext.define("Forte.Debugger.AndroidDialog",{extend:"Cell.window.LightWindow",id:"component:debuggerandroid",cls:"ide-debugger-window",title:Forte.Resources.Text.DEBUGGER_ANDROID_TITLE,layout:"card",closable:!0,closeAction:"hide",resizable:!1,singleton:!0,modal:!1,showedBuildlog:!1,forceClose:!1,webViewEngine:null,isFromBuildDialog:!1,initComponent:function(){var a=this,b=[580,610];Ext.apply(this,{width:b[0],height:b[1],defaults:{layout:"vbox",width:b[0]-80,height:b[1],defaults:{xtype:"component"}},
bbar:["->",{xtype:"cell.button",itemId:"ide-debugger-android-openbutton",ui:"light",width:150,text:Forte.Resources.Text.DEBUGGER_IOS_OPEN_CONFIG,handler:function(){MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_IOSUSER));a.close()}},{xtype:"cell.button",itemId:"ide-debugger-android-closebutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){a.close()}},{xtype:"cell.button",itemId:"ide-debugger-android-backbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,
handler:function(){a.getLayout().prev()}},{xtype:"component",itemId:"ide-debugger-android-waitnext",html:Forte.Resources.Text.BUILD_ANDROID_WAITFORCONFIG+" <img src='/img/loading-icon3.gif' width='16' height='16' />"},{xtype:"cell.button",itemId:"ide-debugger-android-platformbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,handler:function(){var b=a.items.indexOf(a.getLayout().getActiveItem());a.isFromBuildDialog&&b===Forte.Debugger.AndroidDialog.PAGE_BUILDOPTION?(Forte.Build.AndroidDialog.showWindow({activeItem:Forte.Build.AndroidDialog.PAGE_METHOD}),
a.close()):Forte.Debugger.DebuggerDialog.showWindow({activeItem:Forte.Debugger.DebuggerDialog.PAGE_ANDROID,platform:{os:Forte.Debugger.DebuggerDialog.OS_ANDROID,type:Forte.Debugger.DebuggerDialog.TYPE_BUILD}})}},{xtype:"cell.button",itemId:"ide-debugger-android-nextbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){a.getLayout().setActiveItem(Forte.Debugger.AndroidDialog.PAGE_PROGRESS);a.build(a.down("#architecture_android").getValue().architecture_android)}},{xtype:"cell.button",
itemId:"ide-debugger-android-cancelbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.getLayout().setActiveItem(Forte.Debugger.AndroidDialog.PAGE_METHOD);a.forceClose=!0;a.close()}},{xtype:"cell.button",itemId:"ide-debugger-android-toconnectbutton",ui:"light",width:100,disabled:!0,text:Forte.Resources.Text.GENERAL_NEXT,handler:function(){Forte.Debugger.DebuggerDialog.showWindow({activeItem:Forte.Debugger.DebuggerDialog.PAGE_CONNECT,platform:{os:Forte.Debugger.DebuggerDialog.OS_ANDROID,
type:Forte.Debugger.DebuggerDialog.TYPE_BUILD}});a.close()}}],items:[{listeners:{activate:function(){a.down("#ide-debugger-android-openbutton").hide();a.down("#ide-debugger-android-closebutton").hide();a.down("#ide-debugger-android-platformbutton").hide();a.down("#ide-debugger-android-backbutton").hide();a.down("#ide-debugger-android-nextbutton").hide();a.down("#ide-debugger-android-startbutton").show();a.down("#ide-debugger-android-cancelbutton").hide();a.down("#ide-debugger-android-toconnectbutton").hide();
a.down("#store-qr-normal").update('<a href="'+Forte.Resources.URL.DEBUGGER_ANDROID+'" target="_blank"><img src="'+Forte.API.qrcode(Forte.Resources.URL.DEBUGGER_ANDROID,100)+'" alt="Google Play" /><br />'+Forte.Resources.Text.DEBUGGER_ANDROID_STORE_CAPTION+"</a>");a.down("#store-qr-crosswalk").update('<a href="'+Forte.Resources.URL.DEBUGGER_ANDROID_CROSSWALK+'" class="store-qr" target="_blank"><img src="'+Forte.API.qrcode(Forte.Resources.URL.DEBUGGER_ANDROID_CROSSWALK,100)+'" alt="Google Play" />'+
Forte.Resources.Text.DEBUGGER_ANDROID_STORE_CAPTION_CROSSWALK+"</a>");$("#android-build-ver").text(Forte.API.androidCustomDebuggerVer);Forte.API.getDebuggerVersion("android",function(a){$("#android-store-ver").text(a)})}},items:[{cls:"ide-debugger-description",style:"margin-top: 40px",html:"<h1>"+Forte.Resources.Text.DEBUGGER_IOS_STEP1_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_IOS_STEP1_SENTENCE+"</p>"},{xtype:"container",layout:{type:"hbox",pack:"left",align:"top"},height:146,style:"border-top:1px solid #ddd; padding-top:8px;",
width:b[0]-80,items:[{width:300,style:"margin: 14px 10px 0 0;",html:"<h2>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_GOOGLEPLAY+"</h2><p>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_GOOGLEPLAY_DESC+"</p>"},{itemId:"store-qr-normal",width:100,height:140,cls:"store-qr store-qr-normal",html:""},{itemId:"store-qr-crosswalk",width:100,height:140,cls:"store-qr",html:""}]},{xtype:"container",layout:{type:"hbox",pack:"left",align:"middle"},height:142,width:b[0]-80,style:"border-top:1px solid #DDD; border-bottom:1px solid #DDD; padding-top: 10px;",
items:[{xtype:"component",width:320,style:"margin-right: 56px",html:"<h2>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_BUILD+"</h2><p>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_BUILD_DESC+"</p>"},{xtype:"cell.button",itemId:"ide-debugger-android-startbutton",ui:"light",width:120,text:Forte.Resources.Text.DEBUGGER_START_BUILD,disabled:!0,handler:function(){a.webViewEngine===Forte.Debugger.AndroidDialog.ENGINE_DEFAULT?(a.getLayout().setActiveItem(Forte.Debugger.AndroidDialog.PAGE_PROGRESS),a.build()):
a.getLayout().setActiveItem(Forte.Debugger.AndroidDialog.PAGE_BUILDOPTION)}}]}]},{listeners:{activate:function(){a.down("#ide-debugger-android-openbutton").hide();a.down("#ide-debugger-android-closebutton").hide();a.down("#ide-debugger-android-backbutton").hide();a.down("#ide-debugger-android-startbutton").hide();a.down("#ide-debugger-android-nextbutton").show();a.down("#ide-debugger-android-cancelbutton").hide();a.down("#ide-debugger-android-toconnectbutton").hide();"debugger"===Forte.API.ideMode?
a.down("#ide-debugger-android-platformbutton").hide():a.down("#ide-debugger-android-platformbutton").show()}},items:[{cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP4_HEADER+"</li></ul>"},{cls:"ide-debugger-description",height:100,html:"<h1>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP2_H1+
"</h1>"},{html:Forte.Resources.Text.BUILD_ANDROID_ARCH_DESC,style:"margin-top:20px; margin-bottom:10px;"},{xtype:"radiogroup",itemId:"architecture_android",emptyText:Forte.Resources.Text.SETTING_ANDROID_ALIAS_EMPTY,fieldLabel:Forte.Resources.Text.BUILD_ANDROID_ARCH,width:500,labelWidth:200,columns:3,items:[{boxLabel:"ARM",name:"architecture_android",inputValue:"arm",checked:!0},{boxLabel:"x86",name:"architecture_android",inputValue:"x86"}]}]},{listeners:{activate:function(){a.down("#ide-debugger-android-openbutton").hide();
a.down("#ide-debugger-android-closebutton").hide();a.down("#ide-debugger-android-backbutton").hide();a.down("#ide-debugger-android-startbutton").hide();a.down("#ide-debugger-android-nextbutton").hide();a.down("#ide-debugger-android-cancelbutton").show();a.down("#ide-debugger-android-platformbutton").hide();a.down("#ide-debugger-android-toconnectbutton").hide()},beforeshow:function(){"build"!==Forte.API.ideMode&&"debugger"!==Forte.API.ideMode&&(Ext.getCmp("component:mainpanel").openTabBuildHistory(),
a.close())}},items:[{cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP4_HEADER+"</li></ul>"},{cls:"ide-build-building",html:"<h1>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP3_1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP3_2+"</p>"},{width:b[0]-80,height:60,style:"text-align : center; vertical-align : middle",
html:'<img src="/img/loading.gif"/>'}]},{listeners:{activate:function(){a.down("#ide-debugger-android-openbutton").hide();a.down("#ide-debugger-android-closebutton").hide();a.down("#ide-debugger-android-platformbutton").hide();a.down("#ide-debugger-android-backbutton").hide();a.down("#ide-debugger-android-startbutton").hide();a.down("#ide-debugger-android-nextbutton").hide();a.down("#ide-debugger-android-cancelbutton").hide();a.down("#ide-debugger-android-toconnectbutton").show();"debugger"===Forte.API.ideMode?
(a.down("#ide-debugger-android-toconnectbutton").hide(),a.down("#ide-debugger-android-toconnectcheck").hide()):a.down("#ide-debugger-android-toconnectbutton").show()},afterRender:function(){$(".btn-buildlog-success").click(function(){var b=Ext.create("Forte.Widgets.BuildLog");b.setLog(a.buildLog);b.show()})},show:function(b){var e='<img src="'+Forte.API.qrcode(a.binaryUrl)+'"/>',e=e+("<p>"+Forte.Resources.Text.DEBUGGER_DOWNLOAD_DESCRIPTION+"</p>");b.down("#success-qr").update(e);a.down("#ide-debugger-android-toconnectcheck").setValue(!1);
$(b.down("#success-qr").getEl().dom).find("a").attr("href",a.binaryUrl)}},items:[{cls:"ide-build-flow-2of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP4_HEADER+"</li></ul>"},{cls:"ide-debugger-description",height:100,layout:"vbox",html:"<h1>"+Forte.Resources.Text.DEBUGGER_ANDROID_SUCCESS+"</h1><p>"+
Forte.Resources.Text.DEBUGGER_ANDROID_SUCCESS_DESC+"</p>"},{xtype:"container",height:350,layout:"vbox",defaults:{xtype:"component"},items:[{itemId:"success-qr",cls:"ide-debugger-android-success-qr",html:"",width:500,height:170},{html:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_INSTRUCTION},{xtype:"checkbox",itemId:"ide-debugger-android-toconnectcheck",boxLabel:Forte.Resources.Text.DEBUGGER_NAV_ANDROID_STORE_CHECK,style:"margin-top: 10px;",listeners:{change:function(b,e){e?a.down("#ide-debugger-android-toconnectbutton").enable():
a.down("#ide-debugger-android-toconnectbutton").disable()}}}]}]},{cls:"ide-build-window-fail",listeners:{activate:function(){a.down("#ide-debugger-android-openbutton").hide();a.down("#ide-debugger-android-closebutton").show();a.down("#ide-debugger-android-platformbutton").hide();a.down("#ide-debugger-android-backbutton").hide();a.down("#ide-debugger-android-startbutton").hide();a.down("#ide-debugger-android-nextbutton").hide();a.down("#ide-debugger-android-cancelbutton").hide();a.down("#ide-debugger-android-toconnectbutton").hide()},
afterRender:function(){$(".btn-buildlog-fail").click(function(){if(!a.showedBuildlog){var b=a.down("#buildlog2");b.show();b.setValue(a.buildLog);a.showedBuildlog=!0}})}},items:[{cls:"ide-build-flow-1of4",html:"<ul><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP1_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP2_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP3_HEADER+"</li><li>"+Forte.Resources.Text.DEBUGGER_ANDROID_STEP4_HEADER+"</li></ul>"},{cls:"ide-debugger-description",
html:"<h1>"+Forte.Resources.Text.DEBUGGER_ANDROID_ERROR+"</h1><p>"+Forte.Resources.Text.DEBUGGER_ANDROID_ERROR_DESC+"</p>"},{xtype:"textarea",itemId:"buildlog2",hidden:!0,width:b[0]-84,height:100},{xtype:"container",layout:"vbox",height:224,defaults:{xtype:"component",width:b[0]-80},items:[{cls:"ide-build-error-itemize",html:"<h2>"+Forte.Resources.Text.DEBUGGER_IOS_STEP4_ERROR_H2+"</h2>"+Forte.Resources.Text.BUILD_CONTROL_ERROR_ANDROID,margin:"10 0 0 0"}]}]}]});this.callParent()},build:function(a){var b=
this,c=new Forte.Debugger.BuildControl,e={androidWebView:b.webViewEngine};b.webViewEngine===Forte.Debugger.AndroidDialog.ENGINE_CROSSWALK&&(e.androidArch=a);c.build("android",e,function(a){if(b.forceClose!=true){b.binaryUrl=a.binary_url;b.buildLog=a.build_log;b.queueId=a.queue_id;b.getLayout().setActiveItem(Forte.Debugger.AndroidDialog.PAGE_SUCCESS)}},function(a){if(b.forceClose!=true){b.buildLog=a.build_log;b.getLayout().setActiveItem(Forte.Debugger.AndroidDialog.PAGE_FAIL)}})},showWindow:function(a){var b=
this;b.modal=a&&a.modal?a.modal:!1;b.isFromBuildDialog=a&&a.isFromBuildDialog?a.isFromBuildDialog:!1;a&&a.binaryUrl&&(b.binaryUrl=a.binaryUrl);a&&a.buildLog&&(b.buildLog=a.buildLog);a&&a.queueId&&(b.queueId=a.queueId);a&&a.webViewEngine?(b.webViewEngine=a.webViewEngine,b.down("#ide-debugger-android-waitnext").hide(),b.down("#ide-debugger-android-startbutton").enable()):(b.down("#ide-debugger-android-waitnext").show(),Forte.API.readProjectSetting(function(a){b.webViewEngine=a.config.android.preference.WebView?
Forte.Debugger.AndroidDialog.ENGINE_CROSSWALK:a.config.android.preference["monaca:WebViewEngine"];b.down("#ide-debugger-android-waitnext").hide();b.down("#ide-debugger-android-startbutton").enable()}));Forte.API.canBuildIOSApp(function(){var c=a&&a.activeItem?a.activeItem:0;b.forceClose=false;b.show(null,function(){b.getLayout().setActiveItem(c);if(c===Forte.Debugger.AndroidDialog.PAGE_PROGRESS){b.build();if(Forte.API.ideMode!=="build"&&Forte.API.ideMode!=="debugger"){Ext.getCmp("component:mainpanel").openTabBuildHistory();
b.close()}}})}).error(function(a){Forte.API.convertFail(Forte.API.showProjectSettingError,a)})}});Ext.define("Forte.Debugger.AndroidDialogForCordova2",{extend:"Cell.window.LightWindow",singleton:!0,modal:!1,id:"component:debuggerandroid",cls:"ide-debugger-window",title:Forte.Resources.Text.DEBUGGER_ANDROID_TITLE,closable:!0,closeAction:"hide",resizable:!1,layout:"vbox",listeners:{activate:function(a){a.down("#ide-debugger-android-qr").update(Forte.Resources.Text.DEBUGGER_ANDROID_QR+"<br />(ver."+
Forte.API.androidCustomDebuggerVer+')<br /><a href="'+Forte.Resources.URL.DEBUGGER_ANDROID_FRAMEWORK2+'" target="_blank"><img src="'+Forte.API.qrcode(Forte.Resources.URL.DEBUGGER_ANDROID_FRAMEWORK2,140)+'" /></a>')}},initComponent:function(){var a=this,b=[580,500];Ext.apply(this,{width:b[0],height:b[1],bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CLOSE,handler:function(){a.hide()}}],items:[{height:115,layout:"hbox",style:"margin-top: 40px;",items:[{xtype:"container",
cls:"ide-debugger-description",width:b[0]-80,layout:"vbox",items:[{xtype:"component",html:"<h1>"+Forte.Resources.Text.DEBUGGER_ANDROID_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_ANDROID_SENTENCE+"</p>"}]}]},{height:255,layout:{type:"hbox",pack:"center",align:"middle"},items:[{xtype:"component",width:180,height:250,cls:"ide-debugger-android-qr",itemId:"ide-debugger-android-qr",html:""}]}]});this.callParent()},showWindow:function(a){this.modal=a&&a.modal?a.modal:!1;this.show()}})})();
Forte.Debugger.AndroidDialog.PAGE_METHOD=0;Forte.Debugger.AndroidDialog.PAGE_BUILDOPTION=1;Forte.Debugger.AndroidDialog.PAGE_PROGRESS=2;Forte.Debugger.AndroidDialog.PAGE_SUCCESS=3;Forte.Debugger.AndroidDialog.PAGE_FAIL=4;Forte.Debugger.AndroidDialog.ENGINE_DEFAULT="default";Forte.Debugger.AndroidDialog.ENGINE_CROSSWALK="crosswalk";(function(){})();(function(){Ext.define("Forte.Debugger.ChromeDialog",{extend:"Cell.window.LightWindow",alias:"widget.debugger.chromedialog",singleton:!0,initComponent:function(){var a=this,b=[570,355];Ext.apply(this,{id:"component:debuggerchrome",cls:"ide-debugger-window",title:Forte.Resources.Text.DEBUGGER_CHROME_TITLE,width:b[0],height:b[1],closeAction:"hide",closable:!0,resizable:!1,modal:!1,layout:"vbox",bbar:[{xtype:"cell.button",itemId:"platformbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_BACK,
handler:function(){Forte.Debugger.DebuggerDialog.showWindow({activeItem:Forte.Debugger.DebuggerDialog.PAGE_HOME});a.close()}},"->",{xtype:"cell.button",itemId:"backbutton",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CLOSE,handler:function(){a.hide()}}],items:[{xtype:"component",cls:"ide-debugger-description icon monaca",x:45,y:0,width:b[0]-40,height:100,layout:"vbox",html:"<h1>"+Forte.Resources.Text.DEBUGGER_CHROME_H1+"</h1><p>"+Forte.Resources.Text.DEBUGGER_CHROME_DESCRIPTION+"</p>"},
{xtype:"container",layout:{type:"hbox"},height:102,style:"background-color: #f1f1f1; border: 1px solid #eee; padding: 20px 18px",items:[{xtype:"component",itemId:"storetext",width:230,style:"margin-right: 12px; padding-top: 10px",html:Forte.Resources.Text.DEBUGGER_CHROME_METHOD},{xtype:"component",itemId:"storelink",width:206,height:58,html:'<a href="https://chrome.google.com/webstore/detail/eampeimhpjmnimjbfajnbegjnafjadld" target="_blank"><img src="/img/debugger/chrome/bnr_webstore.png"></a>'}]},
{xtype:"component",itemId:"storeurl",height:30,html:"https://chrome.google.com/webstore/detail/eampeimhpjmnimjbfajnbegjnafjadld",style:"color: #909090; font-size: 11px; -webkit-user-select: text; user-select: text"}]});this.callParent()},showWindow:function(a){this.modal=a&&a.modal?a.modal:!1;this.show();"debugger"===Forte.API.ideMode?(this.down("#platformbutton").hide(),this.down("#backbutton").show()):(this.down("#platformbutton").show(),this.down("#backbutton").hide());a&&a.disableStoreLink&&(a=
this.down("#storeurl"),$(a.el.dom).css({top:"232px",left:"19px"}),a.show(),this.down("#storetext").update(Forte.Resources.Text.DEBUGGER_CHROME_METHOD_NOLINK),this.down("#storelink").update('<img src="/img/debugger/chrome/bnr_webstore.png" />'))}})})();(function(){Forte.SettingPreviewComponentModels={splash_android:{device:"android",size:160,isProject:!0},splashLdpi_android:{device:"android",size:48,isProject:!0},splashMdpi_android:{device:"android",size:64,isProject:!0},splashHdpi_android:{device:"android",size:96,isProject:!0},splashXHdpi_android:{device:"android",size:128,isProject:!0},splashXXHdpi_android:{device:"android",size:128,isProject:!0},splashXXXHdpi_android:{device:"android",size:128,isProject:!0},iconLdpi_android:{device:"android",
size:36,isProject:!0},iconMdpi_android:{device:"android",size:48,isProject:!0},iconHdpi_android:{device:"android",size:64,isProject:!0,imageURL:"",filename:"",labelType:""},iconXHdpi_android:{device:"android",size:72,isProject:!0,imageURL:"",filename:"",labelType:""},iconXXHdpi_android:{device:"android",size:72,isProject:!0,imageURL:"",filename:"",labelType:""},iconXXXHdpi_android:{device:"android",size:96,isProject:!0,imageURL:"",filename:"",labelType:""},icon_iphone:{device:"ios",size:82,isProject:!0,
imageURL:"",filename:"",labelType:""},icon_iphone_retina:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_iphone_retina_ios7:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_ipad:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_ipad_retina:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_ipad_ios7:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_ipad_retina_ios7:{device:"ios",
size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_60_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_40_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_40_2x_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_50_2x_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_50_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_small_ios:{device:"ios",
size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_small_2x_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_small_3x_ios:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_ipad_pro:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},icon_iphone6plus:{device:"ios",size:82,isProject:!0,imageURL:"",filename:"",labelType:""},splash_iphone:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},
splash_iphone_568h:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_iphone_retina:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_iphone6:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_iphone6plus:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_iphone6plus_landscape:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad:{device:"ios",size:100,
isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad_landscape:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad_retina:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad_retina_landscape:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad_ios7:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad_ios7_landscape:{device:"ios",size:100,isProject:!0,imageURL:"",
filename:"",labelType:""},splash_ipad_retina_ios7:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},splash_ipad_retina_ios7_landscape:{device:"ios",size:100,isProject:!0,imageURL:"",filename:"",labelType:""},app_logo_winrt:{device:"winrt",size:150,isProject:!0,imageURL:"",filename:"",labelType:""},app_small_logo_winrt:{device:"winrt",size:30,isProject:!0,imageURL:"",filename:"",labelType:""},app_splash_screen_winrt:{device:"winrt",size:620,isProject:!0,imageURL:"",filename:"",
labelType:""},app_tile_wide_logo_winrt:{device:"winrt",size:310,isProject:!0,imageURL:"",filename:"",labelType:""},package_logo_winrt:{device:"winrt",size:50,isProject:!0,imageURL:"",filename:"",labelType:""},keystore_android:{device:"android",filePath:"android/keystore.private",isProject:!1,filename:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE},devProvisioning_ios:{device:"ios",filePath:"etc/iOS/development_provisioning.mobileprovision",isProject:!0,filename:Forte.Resources.Text.SETTING_IOS_PROV_DEV},
adhocProvisioning_ios:{device:"ios",filePath:"etc/iOS/distribution_provisioning_adhoc.mobileprovision",isProject:!0,filename:Forte.Resources.Text.SETTING_IOS_PROV_ADHOC},releaseProvisioning_ios:{device:"ios",filePath:"etc/iOS/distribution_provisioning_appstore.mobileprovision",isProject:!0,filename:Forte.Resources.Text.SETTING_IOS_PROV_RELEASE},privateKey_ios:{device:"ios",filePath:"iOS/private.key",isProject:!1,filename:Forte.Resources.Text.SETTING_IOSUSER_KEY},csr_ios:{device:"ios",filePath:"iOS/csr.certSigningRequest",
isProject:!1,filename:Forte.Resources.Text.SETTING_IOSUSER_CSR},dev_certification_ios:{device:"ios",filePath:"iOS/developer_identity.cer",isProject:!1,filename:Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CERTFILE_DEV},certification_ios:{device:"ios",filePath:"iOS/distribution_identity.cer",isProject:!1,filename:Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CERTFILE_DIST},debugProvisioning_ios:{device:"ios",filePath:"iOS/debugger_provisioning_adhoc.mobileprovision",isProject:!1,filename:Forte.Resources.Text.SETTING_IOS_PROV},
debugger_ios:{device:"ios",filePath:"",isProject:!1,filename:Forte.Resources.Text.SETTING_IOS_DEBUGGER},debug_pfx_winrt:{device:"winrt",filePath:"winrt/app_debug.pfx",isProject:!0,filename:Forte.Resources.Text.SETTING_WINRT_UPLOAD_PACKAGE_CERTIFICATE_KEY},icon_chrome_128:{device:"chrome",size:128,isProject:!0,imageURL:"",filename:"",labelType:""}};Ext.define("Forte.ExportWindow",{extend:"Cell.window.LightWindow",alias:"widget.settingExportWindow",callbackFunc:null,initComponent:function(){var a=this;
a.exportForm=Ext.create("Ext.form.Panel",{layout:"anchor",bodyStyle:"padding : 10 20 10 20;",autoScroll:!0,border:!1,defaults:{anchor:"100%",margin:"20"},fieldDefaults:{msgTarget:"under",labelWidth:180},defaultType:"textfield",items:[{xtype:"label",html:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_DESCRIPTION},{fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_PASSWORD,name:"password_android",inputType:"password",allowBlank:!1,maxLength:256,minLength:6,validateOnChange:!0},{xtype:"label",
html:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE_DESCRIPTION},{fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE_PASSWORD,name:"keystore_password_android",inputType:"password",allowBlank:!1,maxLength:256,minLength:6,validateOnChange:!0},{xtype:"button",text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.close()}}]});Ext.apply(this,{title:Forte.Resources.Text.SETTING_ANDROIDUSER_ADDKEY_FORM_TITLE,width:600,layout:"fit",closable:!1,modal:!0,items:[a.exportForm]});this.callParent()}})})();(function(){Ext.define("Forte.EnvironmentSetting",{fontname:null,fontsize:null,shiftwidth:null,softwrap:null,softtabs:null,keybind:null,showPrintMargin:null,showSpecialChar:null,showIndentGuide:null,printMargin:null,theme:null,enableAutoCloseTag:null,disableAutoQuot:null,preserve_newlines:null,max_preserve_newlines:null,html_indent_scripts:null,js_space_in_paren:null,js_brace_style:null,js_break_chained_methods:null,js_space_before_conditional:null,js_wrap_line_length:null});Ext.define("Forte.EnvironmentSettingControl",
{setting:null,settingPanel:null,constructor:function(){this.settingPanel=this.getSettingPanel();this.load()},getSettingPanel:function(){if(!this.settingPanel){var a=this;this.settingPanel=new Forte.EnvironmentSettingPanel;this.settingPanel.on("destroy",function(){a.settingPanel=null});this.settingPanel.on("submit",function(){a.save()});if(null==this.setting)this.settingPanel.on("afterRender",function(){this.startLoading();a.load()},this.settingPanel);else this.settingPanel.setSetting(this.setting)}return this.settingPanel},
load:function(){var a=this;this.settingPanel.on("destroy",function(){a.settingPanel=null});Forte.API.readEnvironmentSettings(function(b){a.setting=Ext.apply(new Forte.EnvironmentSetting,b);a.settingPanel.stopLoading();a.settingPanel.setSetting(b);(new Message.UpdateEnvironmentSettings(b)).send()},function(){a.settingPanel.stopLoading();(new Message.Notify({message:Forte.Resources.Text.SETTING_API_FAILED,type:"warning"})).send();(new Message.UpdateEnvironmentSettings).send()}).error(function(){a.settingPanel.stopLoading();
(new Message.Notify({message:Forte.Resources.Text.SETTING_API_FAILED,type:"warning"})).send();(new Message.UpdateEnvironmentSettings).send()})},save:function(){var a=this.getSettingPanel(),b=a.getForm(),c=null;!1===b.findField("showPrintMargin").getValue()?(Ext.getCmp("printmargin").setDisabled(!1),c=b.getValues(!1,!1,!0),Ext.getCmp("printmargin").setDisabled(!0)):c=b.getValues(!1,!1,!0);c.softtabs="true"===c.softtabs?!0:!1;c.showPrintMargin="on"===c.showPrintMargin?!0:!1;c.showSpecialChar="on"===
c.showSpecialChar?!0:!1;c.showIndentGuide="on"===c.showIndentGuide?!0:!1;c.disableAutoQuot="on"===c.disableAutoQuot?!0:!1;c.enableAutoCloseTag="on"===c.enableAutoCloseTag?!0:!1;c.preserve_newlines="on"===c.preserve_newlines?!0:!1;c.js_space_in_paren="on"===c.js_space_in_paren?!0:!1;c.js_break_chained_methods="on"===c.js_break_chained_methods?!0:!1;c.js_space_before_conditional="on"===c.js_space_before_conditional?!0:!1;this.settings=Ext.apply(new Forte.EnvironmentSetting,c);b.isValid()?(a.startLoading(),
(new Message.UpdateEnvironmentSettings(c)).send(),this.setting=Ext.apply(new Forte.EnvironmentSetting,c),Forte.API.saveEnvironmentSettings(c,function(){a.stopLoading();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_SETTING_SAVE,type:"report"})).send()},function(){a.stopLoading();(new Message.Notify({message:Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,type:"report"})).send()}).error(function(){a.stopLoading();(new Message.Notify({message:Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,type:"report"})).send()})):
Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,Forte.Resources.Text.ERROR_SAVE_SETTING_INVALID_TEXT)}});Ext.define("Forte.EnvironmentSettingPanel",{aceEditor:null,optBeautify:{},extend:"Ext.form.Panel",cls:"env-panel",id:"monaca:environment",minWidth:800,hasSetting:!1,fieldDefaults:{msgTarget:"side",labelWidth:180},listeners:{activate:function(){MessageHub.send(new Message.MainPanel.ActivateEnvironmentTab)},deactivate:function(){MessageHub.send(new Message.MainPanel.DeactivateEnvironmentTab)}},
startLoading:function(){this.setIconCls("ide-loading-icon2");this.getEl().mask()},stopLoading:function(){this.setIconCls("ide-setting-panel-icon");this.getEl()&&this.getEl().unmask()},setSetting:function(a){var b=this.getForm();a.fontname&&b.findField("fontname").setValue(a.fontname);b.findField("fontsize").setValue(a.fontsize);b.findField("shiftwidth").setValue(a.shiftwidth);b.findField("softtabs").setValue({softtabs:!0===a.softtabs?"true":"false"});b.findField("keybind").setValue(a.keybind);b.findField("theme").setValue(a.theme);
b.findField("showPrintMargin").setValue(a.showPrintMargin);b.findField("showSpecialChar").setValue(a.showSpecialChar);b.findField("showIndentGuide").setValue(a.showIndentGuide);b.findField("printMargin").setValue(a.printMargin);b.findField("disableAutoQuot").setValue(a.disableAutoQuot);b.findField("enableAutoCloseTag").setValue(a.enableAutoCloseTag);b.findField("preserve_newlines").setValue(a.preserve_newlines);b.findField("max_preserve_newlines").setValue(a.max_preserve_newlines);b.findField("html_indent_scripts").setValue(a.html_indent_scripts);
b.findField("js_space_in_paren").setValue(a.js_space_in_paren);b.findField("js_brace_style").setValue(a.js_brace_style);b.findField("js_break_chained_methods").setValue(a.js_break_chained_methods);b.findField("js_space_before_conditional").setValue(a.js_space_before_conditional);b.findField("js_wrap_line_length").setValue(a.js_wrap_line_length);this.optBeautify.preserve_newlines=a.preserve_newlines;this.optBeautify.max_preserve_newlines=a.max_preserve_newlines;this.optBeautify.indent_scripts=a.html_indent_scripts;
this.optBeautify.space_in_paren=a.js_space_in_paren;this.optBeautify.brace_style=a.js_brace_style;this.optBeautify.break_chained_methods=a.js_break_chained_methods;this.optBeautify.space_before_conditional=a.js_space_before_conditional;this.optBeautify.wrap_line_length=a.js_wrap_line_length;"false"==a.showPrintMargin&&Ext.getCmp("printmargin").setDisabled(!0);!0!=a.preserve_newlines&&Ext.getCmp("max_preserve_newlines").setDisabled(!0);!0===a.softtabs?(this.optBeautify.indent_char=" ",this.optBeautify.indent_size=
a.shiftwidth):(this.optBeautify.indent_char="\t",this.optBeautify.indent_size=1);this.hasSetting=!0},initComponent:function(){var a=this;Ext.apply(this,{iconCls:"ide-setting-panel-icon",bodyStyle:"padding : 20;",closable:!0,title:Forte.Resources.Text.SETTING_ENVIRONMENT_TITLE,listeners:{activate:function(){var a=Ext.getDom("sampleace");this.aceEditor=ace.edit(a);var a=this.getForm(),c=a.findField("theme").getValue();this.aceEditor.setTheme("ace/theme/"+("default"===c?"eclipse":c));this.aceEditor.setReadOnly(!0);
this.aceEditor.setShowPrintMargin(a.findField("showPrintMargin").getValue());this.aceEditor.setPrintMarginColumn(20);this.aceEditor.setShowInvisibles(a.findField("showSpecialChar").getValue());this.aceEditor.setDisplayIndentGuides(a.findField("showIndentGuide").getValue());c=this.aceEditor.getSession();c.setUseWrapMode(!0);c.setTabSize(this.getForm().findField("shiftwidth").getValue());c.setUseWorker(!1);c.setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
this.optBeautify));var e=require("ace/mode/monaca").Mode;c.setMode(new e);c="default"===a.findField("fontname").getValue()?"":"'"+a.findField("fontname").getValue()+"'";$(Ext.getDom("sampleace")).css("font-family",c);$(Ext.getDom("sampleace")).css("font-size",""+a.findField("fontsize").getValue()+"px")}},bbar:["->",{xtype:"cell.button",ui:"blue",minWidth:120,text:Forte.Resources.Text.GENERAL_SAVE,scope:a,handler:function(){a.fireEvent("submit")}}],items:[{xtype:"component",html:Forte.Resources.Text.SETTING_ENVIRONMENT_TITLE,
cls:"cell-title",style:"margin-bottom: 0;"},{xtype:"container",layout:{type:"hbox",align:"stretchmax"},items:[{xtype:"container",layout:{type:"vbox",align:"stretchmax"},height:1280,items:[{xtype:"fieldset",title:Forte.Resources.Text.SETTING_ENVIRONMENT_EDITOR_FONTANDCOLOR_TITLE,defaults:{margin:"10",validateOnChange:!0},fieldDefaults:{msgTarget:"side",labelAlign:"right",height:40},items:[{xtype:"panel",layout:"vbox",height:84,items:[{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_FONT,
name:"fontname",store:[["default","Default"],["Courier New","Courier New"],["dejavusansmono","DejaVu Sans Mono"],["mplus","M+ 1mn regular"],["scpro","Source Code Pro"]],forceSelection:!0,size:26,editable:!1,allowBlank:!1,style:"margin-right: 10px; margin-bottom: 10px;",listeners:{select:{fn:function(a){a="default"===a.value?"":"'"+a.value+"'";$(Ext.getDom("sampleace")).css("font-family",a)}}}},{xtype:"cell.numberfield",name:"fontsize",minValue:9,maxValue:99,forceSelection:!0,style:{marginLeft:"185px"},
size:7,editable:!1,allowBlank:!1,listeners:{change:function(a,c){$(Ext.getDom("sampleace")).css("font-size",""+c+"px")}}}]},{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_THEME,name:"theme",editable:!1,size:26,store:[["default","Default"],["ambiance","Ambiance"],["chrome","Chrome"],["clouds","Clouds"],["cobalt","Cobalt"],["crimson_editor","Crimson Editor"],["dawn","Dawn"],["dreamweaver","Dreamweaver"],["eclipse","Eclipse"],["github","GitHub"],["idle_fingers","Idle Fingers"],
["merbivore","Merbivore"],["merbivore_soft","Merbivore Soft"],["mono_industrial","Mono Industrial"],["monokai","Monokai"],["solarized_dark","Solarized Dark"],["solarized_light","Solarized Light"],["textmate","Textmate"],["tomorrow","Tomorrow"],["tomorrow_night_blue","Tomorrow Night Blue"],["twilight","Twilight"],["vibrant_ink","Vibrant Ink"]],allowBlank:!1,listeners:{select:{fn:function(b){a.aceEditor.setTheme("ace/theme/"+("default"===b.value?"eclipse":b.value))}}}}]},{xtype:"fieldset",title:Forte.Resources.Text.SETTING_ENVIRONMENT_EDITOR_DISPLAY_TITLE,
defaults:{margin:"10",validateOnChange:!0},fieldDefaults:{msgTarget:"side",labelAlign:"right",height:40},items:[{xtype:"panel",layout:"vbox",height:100,defaults:{height:30},items:[{xtype:"panel",layout:"hbox",width:"400px",height:38,items:[{xtype:"checkbox",name:"showPrintMargin",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SHOWOPTIONS,boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SHOWOPTIONS_PRINTMARGIN,editable:!0,handler:function(){this.checked?(a.aceEditor&&a.aceEditor.setShowPrintMargin(!0),
Ext.getCmp("printmargin").setDisabled(!1)):(a.aceEditor&&a.aceEditor.setShowPrintMargin(!1),Ext.getCmp("printmargin").setDisabled(!0))}},{xtype:"cell.numberfield",id:"printmargin",name:"printMargin",editable:!0,allowBlank:!1,style:{marginLeft:15},size:6,listeners:{change:function(b){a&&a.aceEditor&&a.aceEditor.setPrintMarginColumn(b.lastValue)}}},{html:Forte.Resources.Text.SETTING_ENVIRONMENT_PRINTMARGIN_NUM,style:{marginTop:"2px",marginLeft:"3px"}}]},{xtype:"checkbox",name:"showSpecialChar",boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SHOWOPTIONS_SPECIALCHAR,
style:"margin: 0 0 0 186px",editable:!0,handler:function(){this.checked?a.aceEditor&&a.aceEditor.setShowInvisibles(!0):a.aceEditor&&a.aceEditor.setShowInvisibles(!1)}},{xtype:"checkbox",name:"showIndentGuide",boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SHOWOPTIONS_INDENTGUIDE,style:"margin: 0 0 0 186px",editable:!0,handler:function(){this.checked?a.aceEditor&&a.aceEditor.setDisplayIndentGuides(!0):a.aceEditor&&a.aceEditor.setDisplayIndentGuides(!1)}}]}]},{xtype:"fieldset",title:Forte.Resources.Text.SETTING_ENVIRONMENT_EDITOR_INPUT_TITLE,
defaults:{margin:"10",validateOnChange:!0},fieldDefaults:{msgTarget:"side",labelAlign:"right",height:40},items:[{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_KEYBIND,name:"keybind",editable:!1,size:26,store:[["default","Default"],["emacs","Emacs"],["vim","Vim"]],allowBlank:!1},{xtype:"panel",layout:"vbox",height:60,defaults:{height:30,style:"margin-bottom: 0"},items:[{xtype:"checkbox",name:"disableAutoQuot",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_AUTOCOMPLETE,
boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_AUTOCOMPLETE_QUOTATION,editable:!0},{xtype:"checkbox",name:"enableAutoCloseTag",style:{marginLeft:"186px"},boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_AUTOCOMPLETE_CLOSE_TAG,editable:!0}]},{xtype:"panel",layout:"vbox",height:40,items:[{xtype:"panel",layout:"hbox",width:450,items:[{xtype:"displayfield",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SHORTCUT,value:Forte.Resources.Text.SETTING_ENVIRONMENT_SHORTCUT_LINK}]}]}]},{xtype:"fieldset",
title:Forte.Resources.Text.SETTING_ENVIRONMENT_EDITOR_FORMAT_TITLE,defaults:{margin:"10",validateOnChange:!0},fieldDefaults:{msgTarget:"side",labelAlign:"right",height:40},items:[{xtype:"radiogroup",name:"softtabs",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SOFTTABS,labelStyle:"margin-top: 22px;",columns:[110,100],items:[{boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SOFTTABS_SOFT,name:"softtabs",inputValue:"true",checked:!0},{boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_SOFTTABS_HARD,
name:"softtabs",inputValue:"false"}],listeners:{change:function(b){var c=a.getForm(),b="true"==b.lastValue.softtabs?!0:!1;a.aceEditor&&(b?(a.optBeautify.indent_char=" ",a.optBeautify.indent_size=c.findField("shiftwidth").getValue()):(a.optBeautify.indent_char="\t",a.optBeautify.indent_size=1),a.aceEditor.getSession().setUseSoftTabs(b),a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}}},{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_TABSIZE,name:"shiftwidth",store:[[2,"2"],[4,"4"],[8,"8"]],editable:!1,size:"5",allowBlank:!1,listeners:{select:{fn:function(b){var c=a.getForm();a.aceEditor&&(a.optBeautify.indent_size="true"==c.findField("softtabs").getValue().softtabs?b.value:1,a.aceEditor.getSession().setTabSize(b.value),a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}}}},{xtype:"panel",layout:"hbox",width:"400px",height:48,items:[{xtype:"checkbox",name:"preserve_newlines",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_PRESERVE_NEWLINES,editable:!1,handler:function(){this.checked?(a.optBeautify.preserve_newlines=!0,Ext.getCmp("max_preserve_newlines").setDisabled(!1)):(a.optBeautify.preserve_newlines=!1,Ext.getCmp("max_preserve_newlines").setDisabled(!0));a.aceEditor&&a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify))}},{xtype:"cell.combo",id:"max_preserve_newlines",name:"max_preserve_newlines",editable:!1,allowBlank:!1,style:{marginLeft:15},size:12,store:[[0,"unlimited"],[1,"1"],[2,"2"],[3,"3"],[4,"4"],[5,"5"],[6,"6"],[7,"7"],[8,"8"],[9,"9"],[10,"10"]],listeners:{select:{fn:function(b){a.aceEditor&&(a.optBeautify.max_preserve_newlines=b.value,a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}}}}]},{xtype:"fieldset",title:Forte.Resources.Text.SETTING_ENVIRONMENT_EDITOR_FORMAT_HTML_TITLE,defaults:{margin:"10",validateOnChange:!0},fieldDefaults:{msgTarget:"side",labelAlign:"right",height:40},items:[{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_HTML_INDENT_SCRIPTS,name:"html_indent_scripts",store:[["normal","normal"],["keep","keep"],["separate","separate"]],editable:!1,size:"12",allowBlank:!1,listeners:{select:{fn:function(b){a.aceEditor&&(a.optBeautify.indent_scripts=
b.value,a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}}}}]},{xtype:"fieldset",title:Forte.Resources.Text.SETTING_ENVIRONMENT_EDITOR_FORMAT_JS_TITLE,defaults:{margin:"10",validateOnChange:!0},fieldDefaults:{msgTarget:"side",labelAlign:"right",height:40},items:[{xtype:"checkbox",boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_JS_SPACE_IN_PAREN,name:"js_space_in_paren",editable:!1,handler:function(){a.optBeautify.space_in_paren=this.checked?!0:!1;a.aceEditor&&a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify))}},{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_JS_BRACE_STYLE,name:"js_brace_style",store:[["expand","expand"],["collapse","collapse"],["end-expand","end-expand"]],editable:!1,size:"15",allowBlank:!1,listeners:{select:{fn:function(b){a.aceEditor&&(a.optBeautify.brace_style=b.value,a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}}}},{xtype:"checkbox",boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_JS_BREAK_CHAINED_METHODS,name:"js_break_chained_methods",editable:!1,handler:function(){a.aceEditor&&(a.optBeautify.break_chained_methods=this.checked?!0:!1,a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}},{xtype:"checkbox",boxLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_JS_SPACE_BEFORE_CONDITIONAL,name:"js_space_before_conditional",editable:!1,handler:function(){a.aceEditor&&(a.optBeautify.space_before_conditional=this.checked?!0:!1,a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}},{xtype:"cell.combo",fieldLabel:Forte.Resources.Text.SETTING_ENVIRONMENT_JS_WRAP_LINE_LENGTH,name:"js_wrap_line_length",store:[[0,"OFF"],[60,"60"],[70,"70"],[80,"80"],[90,"90"],[100,"100"]],editable:!1,size:"7",allowBlank:!1,listeners:{select:{fn:function(b){a.aceEditor&&(a.optBeautify.wrap_line_length=b.value,a.aceEditor.getSession().setValue(html_beautify('<!DOCTYPE HTML>\n<\!-- Preview --\><html>\n<head>\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />\n        <script>\n$("#lorem").css("border", "1px solid blue");\n            function lorem() {\n                var temp;\n            \tvar n = true;\n            \tif(n){\n                    temp = function(){\n                        return "lorem";\n                    }\n            \t}else{\n                    temp = function(){\n                        return "ipsum";\n                    }\n            \t}\n            }\n            var ipsum = function() {\n                for( var i = 0; i < 1; i++ ) {\n\n                }\n            };\n            var LoremIpsum = {};\n        <\/script>\n        <style>\n        \tbody p em {background: #ebebeb;color: #333}\n            body p strong {background: #ebebeb;color: #333}\n        </style>\n    </head>\n    <body>\n        <h1>HTML Ipsum Presents</h1>\n        <p id="lorem" class="ipsum"><strong>Pellentesque habitant morbi tristique</strong> senectus et netus et malesuada fames ac turpis\n            egestas. Vestibulum tortor quam,\n            <\!-- feugiat vitae, ultricies eget, tempor sit amet, ante. --\>\n            Donec eu libero sit amet quam egestas semper.\n            <em>Aenean ultricies mi vitae est.</em>  <a href="#">Donec non enim</a> in turpis pulvinar facilisis.Ut\n            felis.</p>\n        <h2>Header Level 2</h2>\n        <ol>\n            <li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</li>\n            <li>Aliquam tincidunt mauris eu risus.</li>\n        </ol>\n    </body>\n\n</html>',
a.optBeautify)))}}}}]}]}]},{xtype:"panel",id:"sampleace",flex:1,margin:"5",style:{border:"1px solid #999",zIndex:10},html:'<div id="sampleace-cont" style="width:100%; height:100%; background-color:#FFF;"></div>'}]},{xtype:"label",html:Forte.Resources.Text.SETTING_ENVIRONMENT_DESCRIPTION}]});this.callParent()}})})();(function(){Ext.define("Forte.SettingCloud",{extend:"Cell.VerticalTabPanel",title:Forte.Resources.Text.CLOUD_SETTING_TITLE,config:{},minWidth:920,closable:!0,initComponent:function(){var a=this;Forte.API.postCloud("Project.getConfig",null,function(b){a.config=b.config;if(a.rendered)a.onGetConfig(a)});a.indexData=[{title:Forte.Resources.Text.CLOUD_SETTING_INDEX_USER,id:0},{title:Forte.Resources.Text.CLOUD_SETTING_INDEX_PUSH,id:1},{title:Forte.Resources.Text.CLOUD_SETTING_INDEX_MANAGEMENT_API,id:2}];
a.settingPageList=[];a.settingPageList[0]=a.makeUserPanel();a.settingPageList[1]=a.makePushPanel();a.settingPageList[2]=a.makeManagementPanel();a.callParent()},onAfterRender:function(){if(0===Object.keys(this.config).length)this.loadmask.show();else this.onGetConfig(this);this.callParent()},onGetConfig:function(a){var b=a.config;a.loadmask.hide();a.settingPageList[0].down("#autologin").setValue(b.autoLoginEnabled?!0:!1);a.settingPageList[0].down("#autologintime").setValue(b.autoLoginExpireMinutes);
a.settingPageList[0].down("#minpassword").setValue(b.minPasswordLength);a.settingPageList[0].down("#minusername").setValue(b.minUsernameLength);a.settingPageList[0].down("#passwordresettoken").setValue(b.passwordResetExpireMinutes)},makeUserPanel:function(){var a=Ext.create("Ext.container.Container",{layout:"vbox",cls:"cell-vtabpanel-cont",width:460,defaults:{labelWidth:320,editable:!0,allowBlank:!1,size:7},items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.CLOUD_SETTING_AUTH_TITLE},
{xtype:"container",layout:"hbox",width:600,style:"margin-left: 13px;",items:[{xtype:"checkbox",boxLabel:Forte.Resources.Text.CLOUD_SETTING_AUTH_AUTOLOGIN,itemId:"autologin",width:177},{xtype:"cell.numberfield",fieldLabel:Forte.Resources.Text.CLOUD_SETTING_AUTH_AUTOLOGIN_TIME,itemId:"autologintime",minValue:0,maxValue:9999,value:30,width:202,labelWidth:130}]},{xtype:"cell.numberfield",fieldLabel:Forte.Resources.Text.CLOUD_SETTING_MINIMUM_PASSWORD_LENGTH,itemId:"minpassword",minValue:1,maxValue:99,
value:4},{xtype:"cell.numberfield",fieldLabel:Forte.Resources.Text.CLOUD_SETTING_MINIMUM_USERNAME_LENGTH,itemId:"minusername",minValue:1,maxValue:99,value:4},{xtype:"cell.numberfield",fieldLabel:Forte.Resources.Text.CLOUD_SETTING_PASSWORD_RESET_TOKEN,itemId:"passwordresettoken",minValue:0,maxValue:9999,value:30},{xtype:"component",cls:"cell-settings-annotation",style:"margin-bottom: 10px;",html:Forte.Resources.Text.CLOUD_SETTING_CAUTION},{xtype:"cell.button",cls:"cell-vtabpanel-submit",ui:"blue",
text:Forte.Resources.Text.GENERAL_APPLY,handler:function(){var b=this;b.setDisabled(!0);var c={autoLoginEnabled:a.down("#autologin").getValue()?1:0,autoLoginExpireMinutes:a.down("#autologintime").getValue(),minPasswordLength:a.getComponent("minpassword").getValue(),minUsernameLength:a.getComponent("minusername").getValue(),passwordResetExpireMinutes:a.getComponent("passwordresettoken").getValue()};Forte.API.postCloud("Project.setConfig",c,function(){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_SETTING_SAVE,
type:"report"})).send()},null,function(){b.setDisabled(!1)})}}]});return a},makePushPanel:function(){var a=Forte.API.getAPIUrl("/page/project/:project_id/push/config");return Ext.create("Ext.container.Container",{layout:"vbox",cls:"cell-vtabpanel-cont",style:"padding: 0;",html:'<iframe src="'+a+'" class="cell-iframe-tab-content" frameborder="0"></iframe>',listeners:{afterRender:function(){setIframeMaskHandler()}}})},makeManagementPanel:function(){var a=this,b=Ext.create("Ext.container.Container",
{layout:"anchor",cls:"cell-settings-management cell-vtabpanel-cont",autoScroll:!0,managementKeys:[],dataLoaded:!1,supportManagementApi:!1,listeners:{afterrender:function(){b.managementKeys=[];b.dataLoaded=!1;b.loadMask.show();Forte.API._postBackend("management/list",{backendId:Forte.API.backendId},function(a){b.managementKeys=a.keys;b.supportManagementApi=a.supportManagementApi;b.dataLoaded=!0});setTimeout(b.checkPanelState,200,b)}},defaults:{editable:!0},items:[{xtype:"component",cls:"cell-title",
html:Forte.Resources.Text.CLOUD_MANAGEMENT_API+' <a href="'+Forte.Resources.DocumentURL.TOP+'reference/monaca_api/cloud_management/" target="_blank"><img src="/img/icon/help.png"/></a>'},{xtype:"container",layout:"hbox",width:600,items:[{xtype:"component",itemId:"isenabled",html:Forte.Resources.Text.CLOUD_SETTING_MANAGEMENT_DISABLED,style:"margin:5px 10px 0 0;"},{xtype:"cell.button",itemId:"enablebtn",ui:"light",text:Forte.Resources.Text.GENERAL_ENABLE,width:120,height:28,handler:function(){if(this.getText()===
Forte.Resources.Text.GENERAL_ENABLE)b.supportManagementApi?b.setPanelState(b,!0):Ext.create("Cell.window.RestrictionDialog").showWindow("MANAGEMENT_API");else{var a=b.down("#keys").getStore().getRange();0===a.length?b.setPanelState(b,!1):Cell.LightMessageBox.confirm({modal:!0,buttons:6,buttonUi:["red","light"],width:400,title:Forte.Resources.Text.CLOUD_MANAGEMENT_STOP_TITLE,msg:Forte.Resources.Text.CLOUD_MANAGEMENT_STOP_BODY,callback:function(e){if("yes"===e){for(var e=0,f="";e<a.length;e++)f+=a[e].data.id+
",";Forte.API._postBackend("management/delete",{backendId:Forte.API.backendId,managementKeyId:f},function(){var a=b.getComponent("keys");a.setHeight(70);Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_SUCCESS,Forte.Resources.Text.CLOUD_MANAGEMENT_STOP_SUCCESS);b.setPanelState(b,!1);b.managementKeys=[];a.getStore().removeAll()})}}})}}}]},{xtype:"component",html:'<a href="#" onclick="$(\'#ide-cloud-settings-management-description\').show();$(this).hide();return false;">'+Forte.Resources.Text.CLOUD_MANAGEMENT_DESCRIPTION_TITLE+
"</a>",style:"margin-bottom: 20px;"},{xtype:"component",itemId:"description",id:"ide-cloud-settings-management-description",html:Forte.Resources.Text.CLOUD_MANAGEMENT_DESCRIPTION,hidden:!0,style:"margin: 20px 0 30px; padding: 30px 0 0 0; border-top: 1px solid #ccc"},{xtype:"component",style:"padding: 30px 0 0 0; margin-top: 20px; border-top: 1px solid #ccc",html:Forte.Resources.Text.CLOUD_MANAGEMENT_APIURL},{xtype:"textfield",width:560,labelWidth:0,value:Forte.API.cloudHost+"manage/json-rpc/"+Forte.API.backendId,
readOnly:!0,listeners:{afterrender:function(){$(this.inputEl.dom).click(function(){$(this).select();copyToClipboard()})}}},{xtype:"cell.grid",itemId:"keys",ui:"simple",width:560,autoScroll:!1,enableColumnHide:!1,enableColumnMove:!1,enableColumnResize:!1,sortableColumns:!1,columns:[{dataIndex:"api_key",header:Forte.Resources.Text.CLOUD_MANAGEMENT_APIKEY,width:320},{dataIndex:"ip_address",header:Forte.Resources.Text.CLOUD_MANAGEMENT_IP,width:200},{xtype:"actioncolumn",flex:1,stopSelection:!0,items:[{icon:"/img/icon/trash_bin.png",
tooltip:Forte.Resources.Text.GENERAL_DELETE,scope:a,handler:a.openDeleteKey}]}],store:Ext.create("Ext.data.SimpleStore",{autoLoad:!0,fields:[{name:"id",type:"string"},{name:"api_key",type:"string"},{name:"ip_address",type:"string",convert:function(a){return 0<a.length?a:Forte.Resources.Text.GENERAL_BLANK}},{name:"created_at",type:"date",dateFormat:"timestamp",convert:unixToText},{name:"modified_at",type:"date",dateFormat:"timestamp",convert:unixToText}],data:[]}),listeners:{itemclick:function(b,e){if(!a.gridBtnClicked){var f=
'<table class="cell-settings-management-detail">';Forte.API._postBackend("management/get",{backendId:Forte.API.backendId,id:e.data.id},function(a){g.getComponent("key").setValue(a.api_key);for(var b in a){var c="",e=a[b]?a[b]:"";switch(b){case "id":case "modified_at":case "api_key":continue;case "ip_address":c=Forte.Resources.Text.CLOUD_MANAGEMENT_IP;e=a.ip_address.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2");e||(e=Forte.Resources.Text.GENERAL_BLANK);break;case "created_at":c=Forte.Resources.Text.CLOUD_MANAGEMENT_CREATED_AT;
e=unixToText(a.created_at);break;default:c=b}f+="<tr><th>"+c+":</th><td>"+e+"</td></tr>"}f+="</table>";g.getComponent("cont").update(f)});var g=Ext.create("Cell.window.LightWindow",{title:"Management Key",closable:!0,resizable:!1,layout:"vbox",modal:!0,width:420,height:360,bodyStyle:"padding-top: 20px;",bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CLOSE,handler:function(){g.close()}}],items:[{xtype:"cell.textfield",itemId:"key",fieldLabel:Forte.Resources.Text.CLOUD_MANAGEMENT_APIKEY,
labelAlign:"top",readOnly:!0,width:340,listeners:{afterrender:function(){$(this.inputEl.dom).click(function(){$(this).select();copyToClipboard()})}}},{xtype:"component",itemId:"cont",html:Forte.Resources.Text.CLOUD_COLLECTION_ITEM_LOADING,width:340,height:240}]}).show()}}}},{xtype:"container",cls:"cell-settings-management-createkey",layout:"vbox",width:560,height:220,style:"margin-bottom: 20px;",defaults:{width:520},items:[{xtype:"component",cls:"cell-subtitle",html:Forte.Resources.Text.CLOUD_MANAGEMENT_NEWKEY,
style:"margin-bottom: 10px;"},{xtype:"textarea",itemId:"iprange",emptyText:"xxx.xxx.xxx.xxx/32",fieldLabel:Forte.Resources.Text.CLOUD_MANAGEMENT_NEWKEY_IP,labelAlign:"top",style:"margin-bottom:0"},{xtype:"component",cls:"cell-settings-annotation",html:Forte.Resources.Text.CLOUD_MANAGEMENT_NEWKEY_IP_ANNO},{xtype:"container",layout:"hbox",items:[{xtype:"component",flex:1},{xtype:"cell.button",text:Forte.Resources.Text.GENERAL_CREATE,width:100,handler:function(){b.supportManagementApi?Forte.API._postBackend("management/create",
{backendId:Forte.API.backendId,ipAddress:b.down("#iprange").getValue()},function(a){var e=b.getComponent("keys"),f=e.getStore();Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_SUCCESS,Forte.Resources.Text.CLOUD_MANAGEMENT_NEWKEY_CREATED);f.add(a);e.setHeight(30*f.getRange().length+70)}):Ext.create("Cell.window.RestrictionDialog").showWindow("MANAGEMENT_API")}}]}]},{xtype:"textfield",width:560,fieldLabel:Forte.Resources.Text.CLOUD_SETTING_MANAGEMENT_EXAMPLE,labelAlign:"top",value:"curl "+Forte.API.cloudHost+
"manage/json-rpc/"+Forte.API.backendId+' --header \'X-Monaca-Backend-Management-API-Key: ****\' --data \'{"jsonrpc": "2.0", "id": 1, "method": "Collection.list", "params": {}}\'',readOnly:!0,listeners:{afterrender:function(){$(this.inputEl.dom).click(function(){$(this).select()})}}}],checkPanelState:function(a){a.dataLoaded?(a.loadMask.hide(),0<a.managementKeys.length?a.setPanelState(a,!0):a.setPanelState(a,!1)):setTimeout(function(){a.checkPanelState(a)},200,a)},setPanelState:function(a,b){if(b){a.down("#isenabled").update(Forte.Resources.Text.CLOUD_SETTING_MANAGEMENT_ENABLED);
a.down("#enablebtn").setText(Forte.Resources.Text.GENERAL_DISABLE);for(var f=3;f<a.items.length;f++)a.items.items[f].show();a.getComponent("description").hide();f=a.getComponent("keys").getStore();f.removeAll();f.add(a.managementKeys)}else{a.down("#isenabled").update(Forte.Resources.Text.CLOUD_SETTING_MANAGEMENT_DISABLED);a.down("#enablebtn").setText(Forte.Resources.Text.GENERAL_ENABLE);for(f=2;f<a.items.length;f++)a.items.items[f].hide();a.getComponent("description").show()}}});b.loadMask=new Ext.LoadMask(b,
{msg:"Loading..."});return b},openDeleteKey:function(a,b){var c=this,e=a.ownerCt,f=e.getStore().getAt(b).get("id");c.gridBtnClicked=!0;Cell.LightMessageBox.confirm({modal:!0,buttons:6,buttonUi:["red","light"],width:400,title:Forte.Resources.Text.CLOUD_MANAGEMENT_DELETE_TITLE,msg:Forte.Resources.Text.CLOUD_MANAGEMENT_DELETE_BODY,callback:function(a){c.gridBtnClicked=!1;"yes"===a&&Forte.API._postBackend("management/delete",{backendId:Forte.API.backendId,managementKeyId:f},function(){var a=e.getStore();
a.removeAt(b);e.setHeight(30*a.getRange().length+70);Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_SUCCESS,Forte.Resources.Text.CLOUD_MANAGEMENT_DELETE_SUCCESS)})}})}})})();(function(){Ext.define("Forte.Setting.Android",{extend:"Cell.SettingPanel",alias:"widget.setting.android",id:"setting:android",settings:null,splashPicker:null,bgPicker:null,parentScope:null,fieldDefaults:{msgTarget:"under"},initComponent:function(){var a=this,b=Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?[a.parentScope.makePreviewComponent(parent,"iconLdpi_android",{x:25,y:0,width:36,height:36,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconMdpi_android",
{x:126,y:0,width:48,height:48,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconHdpi_android",{x:226,y:0,width:72,height:72,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconXHdpi_android",{x:335,y:0,width:72,height:72,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconXXHdpi_android",{x:455,y:0,width:72,height:72,cls:"ide-setting-thumbnail-icon"}),a.makeImgChangeBtn("iconLdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_LDPI,
0,100),a.makeImgChangeBtn("iconMdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_MDPI,110,100),a.makeImgChangeBtn("iconHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_HDPI,220,100),a.makeImgChangeBtn("iconXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_XHDPI,330,100),a.makeImgChangeBtn("iconXXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_XXHDPI,447,100)]:[a.parentScope.makePreviewComponent(parent,"iconLdpi_android",{x:25,y:60,width:36,height:36,cls:"ide-setting-thumbnail-icon"}),
a.parentScope.makePreviewComponent(parent,"iconMdpi_android",{x:128,y:48,width:48,height:48,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconHdpi_android",{x:232,y:32,width:64,height:64,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconXHdpi_android",{x:336,y:24,width:72,height:72,cls:"ide-setting-thumbnail-icon"}),a.parentScope.makePreviewComponent(parent,"iconXXHdpi_android",{x:450,y:24,width:72,height:72,cls:"ide-setting-thumbnail-icon"}),
a.parentScope.makePreviewComponent(parent,"iconXXXHdpi_android",{x:560,y:0,width:96,height:96,cls:"ide-setting-thumbnail-icon"}),a.makeImgChangeBtn("iconLdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_LDPI,0,100),a.makeImgChangeBtn("iconMdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_MDPI,110,100),a.makeImgChangeBtn("iconHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_HDPI,220,100),a.makeImgChangeBtn("iconXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_XHDPI,330,100),
a.makeImgChangeBtn("iconXXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_XXHDPI,442,100),a.makeImgChangeBtn("iconXXXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_ICON_XXXHDPI,564,100)],c=[{id:"applicationName_android",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_APPPLICATIONNAME,labelWidth:200,name:"applicationName_android",helpMsg:Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_APP,size:40,validator:function(a){return!a?Forte.Resources.Text.SETTING_APPLICATION_NAME_ALERT:!0},listeners:{change:function(){Forte.API.isStandardCordova&&
a.updateCaution(this,"iOS"+Forte.Resources.Text.SETTING_APPLICATIONNAME_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS"+Forte.Resources.Text.SETTING_APPLICATIONNAME_CAUTION)}}},{fieldLabel:Forte.Resources.Text.SETTING_ANDROID_PACKAGE,id:"applicationClass_android",name:"applicationClass_android",helpMsg:Forte.API.isStandardCordova?Forte.Resources.Text.SETTING_APPID_FOR_STANDARD_CORDOVA:Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_PACKAGE,size:30,validator:function(a){if(Forte.API.isStandardCordova)return window.validateApplicationId(a);
a=a.split(".");if(2>a.length)return Forte.Resources.Text.SETTING_VALIDATOR_ERR1;for(var b=0;b<a.length;b++){var c=a[b];if(0===c.length)return Forte.Resources.Text.SETTING_VALIDATOR_ERR2;if(!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(c))return Forte.Resources.Text.SETTING_VALIDATOR_ERR3}return!0},listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,Forte.Resources.Text.SETTING_ANDROID_PACKAGE_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,Forte.Resources.Text.SETTING_ANDROID_PACKAGE_CAUTION)}}},
{xtype:"cell.checkbox",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_POSTFIX,itemId:"config_postfix",name:"config_postfix",helpMsg:Forte.Resources.Text.SETTING_ANDROID_POSTFIX_HELP,inputValue:"true",uncheckedValue:"false"},{fieldLabel:Forte.Resources.Text.SETTING_ANDROID_VERSIONNAME,itemId:"versionName_android",name:"versionName_android",helpMsg:Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_VERSIONNAME,size:19,validator:function(a){return Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?
!0:-1===a.search(/^\d{1,2}\.\d{1,2}\.\d{1,2}$/)?Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_VERSIONNAME:!0},listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS"+Forte.Resources.Text.SETTING_VERSIONNAME_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS"+Forte.Resources.Text.SETTING_VERSIONNAME_CAUTION)}}}];(Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO||Forte.API.cordovaVersion>=Forte.API.CORDOVA_VERSION_FIVE)&&c.push({fieldLabel:Forte.Resources.Text.SETTING_ANDROID_VERSIONCODE,
itemId:"versionCode_android",name:"versionCode_android",helpMsg:Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_VERSIONCODE,size:19,allowBlank:!0,disabled:parseFloat(Forte.API.cordovaVersion)!==Forte.API.FRAMEWORK_VERSION_TWO,validator:function(a){return Forte.API.cordovaVersion>=Forte.API.CORDOVA_VERSION_FIVE&&!a?!0:-1===a.search(/^[0-9]+$/)?Forte.Resources.Text.SETTING_ANDROID_VERSIONCODE_ERROR:!0}},{xtype:"cell.checkbox",itemId:"disable_versionCode_android",name:"disable_versionCode_android",
labelSeparator:"",hideLabel:!0,boxLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_ALLOW_ENTER_VERSION_CODE,hidden:parseFloat(Forte.API.cordovaVersion)===Forte.API.FRAMEWORK_VERSION_TWO,size:50,margin:"-15 0 20 206",listeners:{change:function(){a.down("#disable_versionCode_android").checked?a.down("#versionCode_android").enable():(a.down("#versionCode_android").disable(),a.down("#versionCode_android").setValue(""))}}});c.push({xtype:"cell.checkbox",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_FULLSCREEN,
itemId:"fullscreen_android",name:"fullscreen_android",hidden:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO,disabled:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO,inputValue:"true",uncheckedValue:"false"});Ext.apply(a,{items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.SETTING_ANDROID_TITLE},{title:Forte.Resources.Text.SETTING_ANDROID_APPPLICATION,defaults:{xtype:"cell.textfield",allowBlank:!1,maxLength:256,validateOnChange:!0,labelWidth:200},items:c},
{title:Forte.Resources.Text.SETTING_ANDROID_ICONS,layout:{type:"vbox",align:"stretch"},height:400,items:[{xtype:"container",cls:"ide-setting-upload-all",height:80,items:[{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROID_ICON_ALL},{xtype:"filefield",name:"icon_all_android",buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_UPLOAD+"...",width:200,listeners:{change:function(){var b=this;Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.NOTIFY_GENERAL_OVERWRITE,
function(c){if("yes"===c){c=$(".ide-setting-thumbnail-icon",a.down("#icons-cont").el.dom);c.html('<img src="/img/loading-icon5.gif" width="16" />&nbsp;');var g=a.getInputNamesInElement(c[0].parentNode);Forte.API.uploadSettingImg(null,"icon_all_android",null,function(){a.parentScope.updateFileFields(parent,g);b.reset()},function(c,f){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,f);for(var k=0;k<g.length;k++)a.parentScope.getSettingImgTag(g[k]);b.reset()})}else b.reset()})}}}]},
{itemId:"icons-cont",layout:"absolute",height:230,defaults:{xtype:"component",buttonOnly:!0},items:b},{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROID_ICON_DESCRIPTION,cls:"cell-annotation"}]},{title:Forte.Resources.Text.SETTING_ANDROID_SPLASH,cls:"ide-setting-android-splash",layout:"vbox",height:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?540:390,defaults:{xtype:"component",buttonOnly:!0,labelWidth:150},items:[{xtype:"container",width:760,height:Forte.API.frameworkVersion===
Forte.API.FRAMEWORK_VERSION_TWO?360:230,layout:{type:"absolute",align:"center"},items:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?[a.parentScope.makePreviewComponent(parent,"splash_android",{x:0,y:0,width:180,height:280}),a.makeImgChangeBtn("splash_android","",35,280),a.makeImgRemoveBtn("splash_android",35,318)]:[a.parentScope.makePreviewComponent(parent,"splashLdpi_android",{x:17,y:80,width:48,height:48}),a.makeImgChangeBtn("splashLdpi_android",Forte.Resources.Text.SETTING_ANDROID_SPLASH_LDPI,
0,137),a.makeImgRemoveBtn("splashLdpi_android",0,189),a.parentScope.makePreviewComponent(parent,"splashMdpi_android",{x:104,y:64,width:64,height:64}),a.makeImgChangeBtn("splashMdpi_android",Forte.Resources.Text.SETTING_ANDROID_SPLASH_MDPI,92,137),a.makeImgRemoveBtn("splashMdpi_android",92,189),a.parentScope.makePreviewComponent(parent,"splashHdpi_android",{x:183,y:32,width:96,height:96}),a.makeImgChangeBtn("splashHdpi_android",Forte.Resources.Text.SETTING_ANDROID_SPLASH_HDPI,187,137),a.makeImgRemoveBtn("splashHdpi_android",
187,189),a.parentScope.makePreviewComponent(parent,"splashXHdpi_android",{x:290,y:0,width:112,height:128}),a.makeImgChangeBtn("splashXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_SPLASH_XHDPI,312,137),a.makeImgRemoveBtn("splashXHdpi_android",312,189),a.parentScope.makePreviewComponent(parent,"splashXXHdpi_android",{x:434,y:0,width:128,height:128}),a.makeImgChangeBtn("splashXXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_SPLASH_XXHDPI,455,137),a.makeImgRemoveBtn("splashXXHdpi_android",455,
189),a.parentScope.makePreviewComponent(parent,"splashXXXHdpi_android",{x:576,y:0,width:128,height:128}),a.makeImgChangeBtn("splashXXXHdpi_android",Forte.Resources.Text.SETTING_ANDROID_SPLASH_XXXHDPI,599,137),a.makeImgRemoveBtn("splashXXXHdpi_android",599,189)]},{xtype:"cell.textfield",itemId:"splashtime_android",name:"splashtime_android",size:14,allowBlank:!1,hidden:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO,disabled:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO,
maxLength:256,value:1E3,validateOnChange:!0,fieldLabel:Forte.Resources.Text.SETTING_ANDROID_SPLASH_TIME,helpMsg:Forte.Resources.Text.SETTING_ANDROID_SPLASH_TIME_DESC},{xtype:"cell.textfield",itemId:"app_splash_android_background",name:"app_splash_android_background",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_SPLASH_BACKGROUND,size:10,hidden:Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO,disabled:Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO,listeners:{afterRender:function(b){var c=
new jscolor.color(b.inputEl.dom,{});c.required=!1;c.hash=!0;c.slider=!1;c.pickerClosable=!0;c.onImmediateChange=function(){document.getElementById("setting_file_android_splash_android").style.backgroundColor=c.toString()};a.settings&&a.settings.config.android.preference["monaca:SplashBackground"]&&(c.fromString(a.settings.config.android.preference["monaca:SplashBackground"]),document.getElementById("setting_file_android_splash_android").style.backgroundColor=c.toString());a.splashPicker=c}}},{xtype:"cell.combobox",
itemId:"app_splash_android_autoHide",name:"app_splash_android_autoHide",editable:!1,hidden:Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO,disabled:Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO,fieldLabel:Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE,labelStyle:"margin-top: 10px;",helpMsg:Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE_HELP,value:!0,size:20,store:[[!0,Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE_TRUE],[!1,Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE_FALSE]]},
{html:Forte.Resources.Text.SETTING_ANDROID_ICON_DESCRIPTION,cls:"cell-annotation"},{html:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?Forte.Resources.Text.SETTING_ANDROID_SPLASH_DESCRIPTION_CORDOVA2:Forte.Resources.Text.SETTING_ANDROID_SPLASH_DESCRIPTION,cls:"cell-annotation"}]},{title:Forte.Resources.Text.SETTING_ANDROID_PERMISSION_TITLE,html:Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO?Forte.Resources.Text.SETTING_ANDROID_PERMISSION_HELP_CORDOVA3:Forte.Resources.Text.SETTING_ANDROID_PERMISSION_HELP,
layout:"hbox",maxWidth:700,defaults:{xtype:"grid",cls:"ide-setting-chrome-permgrid",hideHeaders:!0,multiSelect:!0,width:240,height:300,style:"margin-bottom:30px;"},items:Forte.API.frameworkVersion!==Forte.API.FRAMEWORK_VERSION_TWO?[]:[{itemId:"permission-available",columns:[{dataIndex:"text",width:198}],draggable:!1,store:a.initPermissionStore(!0),title:Forte.Resources.Text.GENERAL_DISABLED},{xtype:"container",width:60,layout:{type:"vbox",align:"center",pack:"center"},items:[{xtype:"button",text:"&gt;&gt;",
style:"margin-bottom:10px;",width:34,handler:function(){var b=a.down("#permission-available"),c=b.getSelectionModel().getSelection();a.down("#permission-enabled").getStore().add(c);b.getStore().remove(c)}},{xtype:"button",text:"&lt;&lt;",width:34,handler:function(){var b=a.down("#permission-enabled"),c=b.getSelectionModel().getSelection();a.down("#permission-available").getStore().add(c);b.getStore().remove(c)}}]},{itemId:"permission-enabled",columns:[{dataIndex:"text",width:198}],draggable:!1,store:a.initPermissionStore(!1),
title:Forte.Resources.Text.GENERAL_ENABLED}]},{title:Forte.Resources.Text.SETTING_ANDROID_OTHERS,defaults:{allowBlank:!1,boxLabel:Forte.Resources.Text.SETTING_CHECKBOX_ENABLE,maxLength:256,validateOnChange:!0,labelStyle:"margin-top: 8px;",labelWidth:200,inputValue:"true",uncheckedValue:"false"},items:[{xtype:"cell.textarea",id:"config_access_origin_android",name:"config_access_origin_android",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_OTHERS_ACESS_ORIGIN,allowBlank:!0,helpMsg:Forte.Resources.Text.SETTING_ANDROID_OTHERS_ACESS_ORIGIN_HELP,
width:540,margin:"0 0 12 0",listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS"+Forte.Resources.Text.SETTING_ACCESS_ORIGIN_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS"+Forte.Resources.Text.SETTING_ACCESS_ORIGIN_CAUTION)}}},{xtype:"label",id:"notification_config_access_origin_android",hidden:parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_FIVE,margin:"0 0 0 205",text:Forte.Resources.Text.SETTING_ANDROID_OTHERS_ACCESS_ORIGIN_CAUTION},
{xtype:"cell.checkbox",itemId:"config_keeprunning",name:"config_keeprunning",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_OTHERS_KEEPRUNNING,margin:"0 0 5 0"},{xtype:"cell.checkbox",id:"config_disallow_overscroll_android",name:"config_disallow_overscroll_android",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_OTHERS_DISALLOW_OVERSCROLL,helpMsg:Forte.Resources.Text.SETTING_DISALLOW_OVERSCROLL_DESCRIPTION,margin:"0 0 0 0",width:540,listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,
"iOS "+Forte.Resources.Text.SETTING_DISALLOW_OVERSCROLL_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS "+Forte.Resources.Text.SETTING_DISALLOW_OVERSCROLL_CAUTION)}}},{xtype:"radiogroup",itemId:"config_webview_engine",cls:"setting-android-webview-engine",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW,hidden:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO||parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE,disabled:Forte.API.frameworkVersion===
Forte.API.FRAMEWORK_VERSION_TWO,columns:1,items:[{boxLabel:Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW_DEFAULT,name:"config_webview_engine",inputValue:"default",checked:!0},{boxLabel:Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW_CROSSWALK,name:"config_webview_engine",inputValue:"crosswalk"}]},{xtype:"label",id:"selected_webview_engine",hidden:parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_FIVE,padding:"10",listeners:{show:function(){$("#selected_webview_engine").css({"margin-left":"14px"})}}},
{layout:"hbox",style:"margin: 0 0 10px 10px",hidden:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO,items:[{xtype:"label",text:Forte.Resources.Text.SETTING_ANDROID_OTHERS_ORIENTATION},{id:"config_orientation_help_android",xtype:"cell.component",helpMsg:Forte.Resources.Text.SETTING_ANDROID_OTHERS_ORIENTATION_DESC},{xtype:"radiogroup",id:"config_orientation_android",cls:"setting-android-orientation",width:300,height:100,style:"en"==window.LANG?"margin: 0 -53px;":"margin: 0 105px;",disabled:Forte.API.frameworkVersion===
Forte.API.FRAMEWORK_VERSION_TWO,columns:1,items:[{boxLabel:"Default",name:"config_orientation_android",inputValue:"default",checked:!0},{boxLabel:"Landscape",name:"config_orientation_android",inputValue:"landscape"},{boxLabel:"Portrait",name:"config_orientation_android",inputValue:"portrait"}]}]},{xtype:"cell.textfield",itemId:"bgcolor_android",name:"bgcolor_android",fieldLabel:Forte.Resources.Text.SETTING_ANDROID_BGCOLOR,size:10,hidden:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO||
parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE,disabled:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO||parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE,listeners:{afterRender:function(b){b=new jscolor.color(b.inputEl.dom,{});b.required=!1;b.hash=!0;b.slider=!1;b.pickerClosable=!0;a.settings&&a.settings.config.android.preference.BackgroundColor&&b.fromString(a.settings.config.android.preference.BackgroundColor.replace(/0xff/i,"#"));a.bgPicker=
b}}}]}],bbar:["->",{xtype:"cell.button",ui:"blue",text:Forte.Resources.Text.GENERAL_SAVE,minWidth:120,handler:function(){var b=a.getForm();if(b.isValid()){var c={};c.android=b.getFieldValues();c.android.permissions=["ignore_me"];Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?(delete c.android.config_webview_engine,delete c.android.config_orientation_android,a.down("#permission-enabled").getStore().getRange().forEach(function(a){c.android.permissions.push(String(a.data.value))})):delete c.android.permissions;
a.parentScope.showMask();Forte.API.saveProjectSetting(c,function(){a.onSave.call(a)},function(b,c){a.parentScope.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:c,buttons:1,minWidth:480,noEscape:true})})}else Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,Forte.Resources.Text.ERROR_SAVE_SETTING_INVALID_TEXT)}}]});a.callParent()},onSave:function(){var a=this,b=this.parentScope;Forte.API.readProjectSetting(function(c){a.setSettings(c);
a.down("#applicationName_android").fireEvent("change");a.down("#applicationClass_android").fireEvent("change");a.down("#versionName_android").fireEvent("change");a.down("#config_access_origin_android").fireEvent("change");a.down("#config_disallow_overscroll_android").fireEvent("change");a.down("#config_orientation_android").fireEvent("change");b.hideMask();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_SETTING_SAVE,type:"report"})).send()},function(a,e){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
msg:e,buttons:1,minWidth:480,noEscape:!0})})},setSettings:function(a){var b=this.down("#applicationName_android");b.origValue=a.config.android.applicationName||"";b.setValue(b.origValue);b=this.down("#applicationClass_android");b.origValue=a.config.android.applicationClass||"";b.setValue(b.origValue);b=this.down("#versionName_android");b.origValue=a.config.android.versionName||"";b.setValue(b.origValue);b=this.down("#config_access_origin_android");b.origValue=a.config.android.accessOrigin||"";b.setValue(b.origValue);
this.down("#config_keeprunning").setValue("true"===a.config.android.preference.KeepRunning);b=this.down("#config_disallow_overscroll_android");b.origValue="true"===a.config.android.preference.DisallowOverscroll;b.setValue(b.origValue);this.down("#config_postfix").setValue("true"===a.config.android.preference["monaca:AndroidIsPackageNameSeparate"]);if(Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO){if(this.down("#versionCode_android").setValue(a.config.android.preference["monaca:androidVersionCode"]||
""),a.project.backendId&&(b=$("#AndroidPermissionSettingHelp"),b.html(b.html()+"<br>("+Forte.Resources.Text.BUILD_ANDROID_PUSH_PERMISSION+" Get Accounts, Wake Lock, Receive Data from Internet.)")),b="true"===a.config.android.preference["monaca:AutoHideSplashScreen"],this.down("#app_splash_android_autoHide").setValue(b),a.config.android.preference["monaca:SplashBackground"]&&this.splashPicker&&(this.splashPicker.fromString(a.config.android.preference["monaca:SplashBackground"]),$("#setting_file_android_splash_android").css("background-color",
this.splashPicker.toString())),a.manifest&&a.manifest.android.permission)for(var b=this.down("#permission-available").getStore(),c=this.down("#permission-enabled").getStore(),e=0;e<a.manifest.android.permission.length;e++){var f=b.findRecord("value",a.manifest.android.permission[e]);f&&(c.add(f),b.remove(f))}}else b=this.down("#config_orientation_android"),b.origValue=a.config.android.preference.Orientation,b.setValue({config_orientation_android:a.config.android.preference.Orientation}),parseFloat(Forte.API.cordovaVersion)>=
Forte.API.CORDOVA_VERSION_FIVE?(b=this.down("#versionCode_android"),c=this.down("#disable_versionCode_android"),b.setValue(a.config.android.versionCode||""),0==b.getValue().length?(b.disable(),c.setValue(!1)):(b.enable(),c.setValue(!0)),this.webviewEngine=a.config.android.preference.webView?-1<a.config.android.preference.webView.indexOf("crosswalk")?"crosswalk":"default":"default",b="crosswalk"==this.webviewEngine?Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW_CROSSWALK:Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW_DEFAULT,
this.down("#selected_webview_engine").setText(Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW+':<span style="margin-left: 10px;">'+b+"</span><br/>"+Forte.Resources.Text.SETTING_ANDROID_OTHERS_WEBVIEW_ENGINE_NOTICE,!1),this.down("#selected_webview_engine").show(),this.down("#config_webview_engine").hide(),this.down("#config_webview_engine").disable()):this.webviewEngine=a.config.android.preference["monaca:WebViewEngine"],this.down("#config_webview_engine").setValue({config_webview_engine:this.webviewEngine}),
this.down("#fullscreen_android").setValue(a.config.android.preference.Fullscreen||!1),b=a.config.android.preference.SplashScreenDelay,this.down("#splashtime_android").setValue(b?b:1E3),a.config.android.preference.BackgroundColor&&this.bgPicker&&this.bgPicker.fromString(a.config.android.preference.BackgroundColor.replace(/0xff/i,"#"));Forte.API.isStandardCordova&&(this.down("#applicationName_android").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_ANDROID,this.down("#applicationClass_android").helpMsg+=
Forte.Resources.Text.SETTING_PLATFORM_COMMON_ANDROID,this.down("#versionName_android").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_ANDROID,this.down("#config_access_origin_android").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_ANDROID,this.down("#config_disallow_overscroll_android").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_ANDROID,Forte.Resources.Text.SETTING_PLATFORM_COMMON_ANDROID="");$("> .x-panel-body",this.el.dom).scrollTop(0);this.settings=a},getInputNamesInElement:function(a){for(var b=
[],a=$("input[type=file]",a),c=0;c<a.length;c++)b.push(a[c].name);return b},makeImgChangeBtn:function(a,b,c,e){var f=this.parentScope;return{xtype:"filefield",name:a,x:c,y:e,buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_CHANGE+"...",fieldLabel:b,labelAlign:"top",labelSeparator:"",labelStyle:"text-align:center; padding-right: 4px",width:88,listeners:{change:function(b,c){f.onUploadFileImgBtn(this,b,c,"android",a)}}}},makeImgRemoveBtn:function(a,b,c){var e=this.parentScope;return{xtype:"cell.button",
ui:"light",text:Forte.Resources.Text.SETTING_REMOVE_BUTTON,x:b,y:c,height:23,width:84,listeners:{click:function(b,c){e.onDeleteFileImgBtn(e,b,c,"android",a)}}}},initPermissionStore:function(a){var b=Forte.API.getOptionalAndroidPermissions(),c=[],e;for(e in b)c.push({text:b[e],value:e});return{autoLoad:!0,fields:[{name:"text",type:"string"},{name:"value",type:"string"}],proxy:{type:"memory",data:a?c:[]}}}})})();(function(){Ext.define("Forte.Setting.AndroidUser",{extend:"Cell.SettingPanel",alias:"widget.setting.androiduser",id:"setting:androiduser",aliasStore:null,settings:null,parentScope:null,initComponent:function(){var a=this;a.aliasStore=Ext.create("Ext.data.ArrayStore",{autoLoad:!0,fields:["alias","password","del"],data:[]});Ext.apply(a,{items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSETTING},{xtype:"component",itemId:"caution",cls:"ide-setting-caution",
html:Forte.Resources.Text.SETTING_ANDROIDUSER_WARNING},{itemId:"settingAndroidUserFieldset",ui:"transparent",defaults:{xtype:"cell.fieldcontainer",style:"margin-bottom: 20px;"},items:[{xtype:"component",cls:"ide-setting-top-description",html:Forte.Resources.Text.SETTING_ANDROIDUSER_DESCRIPTION+' <a href="'+Forte.Resources.DocumentURL.TOP+'manual/build/build_android/#configure-android-keystore" target="_blank"><img src="/img/icon/help.png"/></a>',style:"margin-bottom: 40px;"},{fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_MAKEKEYSTORE,
layout:"hbox",labelStyle:"margin-top: 13px;",defaults:{xtype:"cell.button",ui:"light"},items:[{itemId:"makekeystore",text:Forte.Resources.Text.SETTING_ANDROIDUSER_MAKE_KEY_BUTTON,style:"margin-right: 5px;",listeners:{click:function(){Forte.API.getProjectSettingFileList().keystore_android?Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.NOTIFY_GENERAL_DESTROY_OVERWRITE,function(b){"yes"==b&&a.makeKeystore()}):a.makeKeystore()}}},{text:Forte.Resources.Text.SETTING_ANDROIDUSER_IMPORT_KEYSTORE,
style:"margin-right: 5px;",listeners:{click:function(){Forte.API.getProjectSettingFileList().keystore_android?Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.NOTIFY_GENERAL_DESTROY_OVERWRITE,function(b){"yes"==b&&a.uploadKeystore()}):a.uploadKeystore()}}},{itemId:"exportkeystore",text:Forte.Resources.Text.GENERAL_EXPORT+"...",listeners:{click:function(){Ext.widget("widgets.iframewindow",{title:"Export",width:450,height:240,src:Forte.API.export("keystore_android")}).show()}}}]},
{itemId:"aliasContainer",fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_LIST,height:300,layout:"vbox",viewConfig:{stripeRows:!0},fieldDefaults:{xype:"textfield",msgTarget:"under",autoFitErrors:!0},items:[{xtype:"cell.grid",itemId:"aliasGrid",ui:"mini",border:!0,enableColumnHide:!1,enableColumnMove:!1,enableColumnResize:!1,store:a.aliasStore,style:"margin-bottom: 8px;",width:404,viewConfig:{autoScroll:!0,blockRefresh:!0},columns:[{header:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS,width:180,
sortable:!1,hideable:!1,dataIndex:"alias"},{header:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_PASSWORD,width:180,sortable:!1,dataIndex:"password"},{width:40,itemId:"aliasDelete",dataIndex:"del",sortable:!1,hideable:!1}],listeners:{itemmouseenter:function(b,c){var e=c.data.alias,f=a.down("#aliasGrid");$(".ide-setting-android-grid-icon[alias="+e+"]",f.getEl().dom).addClass("ide-setting-android-grid-icon-highlight")},itemmouseleave:function(){var b=a.down("#aliasGrid");$(".ide-setting-android-grid-icon",
b.getEl().dom).removeClass("ide-setting-android-grid-icon-highlight")},afterrender:function(){a.updateAliasPanel()}}},{xtype:"container",layout:"hbox",width:404,items:[{xtype:"textfield",itemId:"aliasName",name:"aliasName",allowBlank:!1,emptyText:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS,maxLength:256,style:"margin-right: 5px;",validator:function(a){return 0<=a.search(/'|"|<|>|&/)?Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_ERROR:!0},width:140},{xtype:"textfield",itemId:"aliasPassword",name:"aliasPassword",
inputType:"password",allowBlank:!1,emptyText:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_PASSWORD,minLength:6,maxLength:256,style:"margin-right: 5px;",width:160},{xtype:"cell.button",itemId:"makeAlias",ui:"light",text:Forte.Resources.Text.SETTING_ANDROIDUSER_ADD_ALIAS_BUTTON,style:"margin-top: 8px;",listeners:{click:function(){var b=a.getForm(),c=a.down("#makeAlias"),e=a.down("#aliasName"),f=a.down("#aliasPassword");b.isValid()&&(e.errorEl.hide(),f.errorEl.hide(),param=b.getFieldValues(),b.reset(),
a.down("#aliasGrid").setLoading("Loading..."),c.disable(),f.disable(),e.disable(),Forte.API.makeAlias(param.aliasName,param.aliasPassword,function(){(new Message.Notify({message:Forte.Resources.Text.NOTIFY_GENERATE_ALIAS,type:"report"})).send();a.updateAliasPanel();c.enable();f.enable();e.enable()},function(b,h){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,h);a.updateAliasPanel();c.enable();f.enable();e.enable()}))}}}]}]}]}]});this.callParent()},setSettings:function(){Forte.API.getProjectSettingFileList().keystore_android?
(this.down("#caution").hide(),this.down("#makekeystore").setText(Forte.Resources.Text.SETTING_ANDROIDUSER_REMAKE_KEY_BUTTON)):(this.down("#makeAlias").disable(),this.down("#caution").show())},uploadKeystore:function(){var a=this,b=this.parentScope;Ext.create("Forte.KeyStoreUploadWindow",{callbackFunc:function(c){Forte.API.saveUserSetting({keystore_password_android:c},function(){});Forte.API.uploadSetting("android/keystore.private","keystore_android","",function(){Forte.API.readProjectSettingFileList(function(){a.updateAliasPanel()});
b.updateFileFields(b,["keystore_android"]);a.down("#caution").hide();a.down("#makekeystore").setText(Forte.Resources.Text.SETTING_ANDROIDUSER_REMAKE_KEY_BUTTON)},function(a,b){Forte.API.saveUserSetting({keystore_password_android:""},function(){});Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)})}}).show()},makeKeystore:function(){var a=this,b=this.parentScope;Ext.create("Forte.AliasWindow",{callbackFunc:function(c,e,f){Forte.API.makeKeystore(f,c,e,function(){Forte.API.saveUserSetting({keystore_password_android:f},
function(){});b.updateFileFields(b,["keystore_android"]);a.down("#caution").hide();a.down("#makekeystore").setText(Forte.Resources.Text.SETTING_ANDROIDUSER_REMAKE_KEY_BUTTON);Forte.API.readProjectSettingFileList(function(){a.updateAliasPanel();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_GENERATE_KEYSTORE,type:"report"})).send()})},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b)})}}).show()},delAlias:function(a){var b=this;b.down("#aliasGrid").setLoading("Loading...");
Forte.API.deleteAlias(a,function(){b.updateAliasPanel();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_DELETE_ALIAS,type:"report"})).send()},function(a,e){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,e);b.updateAliasPanel()})},updateAliasPanel:function(){var a=this,b=a.down("#aliasGrid");b.setLoading("Loading...");Forte.API.getProjectSettingFileList().keystore_android?Forte.API.readProjectSetting(function(c){var c=c.project.android.alias_android_list,e=[];a.aliasStore.removeAll();
if(c){for(var f=0,g=c.length;f<g;f++)e.push(c[f].alias);e.sort();f=0;for(g=e.length;f<g;f++){var h=e[f];a.aliasStore.add({alias:htmlEscape(h),password:"*",del:'<div class="ide-setting-android-grid-icon" alias="'+h+'"></div>'})}}b.setLoading(!1);b.getView().setHeight(23*c.length);b.up("#aliasContainer").setHeight(23*c.length+128);b.doComponentLayout();b.up("#settingAndroidUserFieldset").doComponentLayout();$(".ide-setting-android-grid-icon",b.getEl().dom).click(function(){if(1>=e.length)Cell.LightMessageBox.alert(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,
Forte.Resources.Text.SETTING_ANDROIDUSER_DELETEKEY_UNABLE);else{var b=this.attributes.alias.value;Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.SETTING_ANDROIDUSER_DELETEKEY_CONFIRM,function(c){"yes"==c&&a.delAlias(b)})}})}):b.setLoading(!1)}});Ext.define("Forte.KeyStoreUploadWindow",{extend:"Cell.window.LightWindow",alias:"widget.settingKeyStoreUploadWindow",title:Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,bodyStyle:"padding-top: 30px;",
closable:!1,modal:!0,width:600,callbackFunc:null,items:[{xtype:"form",itemId:"formpanel",layout:"anchor",height:200,defaults:{anchor:"100%",labelAlign:"top",msgTarget:"under",style:"margin-bottom: 20px;"},items:[{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE_IMPORT_DESCRIPTION},{xtype:"filefield",name:"keystore_android",buttonText:Forte.Resources.Text.GENERAL_BROWSE},{xtype:"cell.textfield",name:"password",allowBlank:!1,fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE_IMPORT_PASSWORD,
inputType:"password",maxLength:256,minLength:6,validateOnChange:!0}]}],bbar:["->",{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_CANCEL,width:80,handler:function(){this.ownerCt.ownerCt.close()}},{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_IMPORT,handler:function(){var a=this.ownerCt.ownerCt,b=a.getComponent("formpanel").getForm();b.isValid()?(b=b.getFieldValues(),a.callbackFunc(b.password),a.close()):Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_NO_KEYSTORE_TITTE,
Forte.Resources.Text.ERROR_KEYSTORE_SHORTPASSWORD_TEXT)}}]});Ext.define("Forte.AliasWindow",{extend:"Cell.window.LightWindow",alias:"widget.settingAliasWindow",title:Forte.Resources.Text.SETTING_ANDROIDUSER_ADDKEY_FORM_TITLE,width:600,layout:"anchor",closable:!1,modal:!0,callbackFunc:null,items:[{xtype:"form",itemId:"formpanel",layout:"anchor",height:320,defaults:{xtype:"cell.textfield",anchor:"100%",margin:"20",msgTarget:"under",labelWidth:180},items:[{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_DESCRIPTION},
{fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS,name:"alias_android",allowBlank:!1,maxLength:256,validateOnChange:!0},{fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_ALIAS_PASSWORD,name:"password_android",inputType:"password",allowBlank:!1,maxLength:256,minLength:6,validateOnChange:!0},{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE_DESCRIPTION},{fieldLabel:Forte.Resources.Text.SETTING_ANDROIDUSER_KEYSTORE_PASSWORD,name:"keystore_password_android",inputType:"password",
allowBlank:!1,maxLength:256,minLength:6,validateOnChange:!0}]}],bbar:["->",{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){this.ownerCt.ownerCt.close()}},{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.SETTING_ANDROIDUSER_ADDKEY_BUTTON,handler:function(){var a=this.ownerCt.ownerCt,b=a.getComponent("formpanel").getForm();b.isValid()&&(b=b.getFieldValues(),a.callbackFunc(b.alias_android,b.password_android,b.keystore_password_android),a.close())}}]})})();(function(){Ext.define("Forte.Setting.IOS",{extend:"Cell.SettingPanel",alias:"widget.setting.ios",id:"setting:ios",settings:null,parentScope:null,fieldDefaults:{msgTarget:"under"},initComponent:function(){var a=this,b=a.parentScope,c=0,e=Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?[b.makePreviewComponent(b,"splash_iphone",{x:c=0,y:0,width:100,height:150}),b.makePreviewComponent(b,"splash_iphone_retina",{x:c+=115,y:0,width:100,height:150}),b.makePreviewComponent(b,"splash_iphone_568h",
{x:c+=115,y:0,width:100,height:178}),b.makePreviewComponent(b,"splash_ipad",{x:c+=115,y:0,width:100,height:131}),b.makePreviewComponent(b,"splash_ipad_landscape",{x:c+=115,y:0,width:100,height:73}),b.makePreviewComponent(b,"splash_ipad_retina",{x:c=0,y:280,width:100,height:131}),b.makePreviewComponent(b,"splash_ipad_retina_landscape",{x:c+=115,y:280,width:100,height:73}),b.makePreviewComponent(b,"splash_ipad_ios7",{x:c+=115,y:280,width:100,height:133}),b.makePreviewComponent(b,"splash_ipad_ios7_landscape",
{x:c+=115,y:280,width:100,height:75}),b.makePreviewComponent(b,"splash_ipad_retina_ios7",{x:c+=115,y:280,width:100,height:133}),b.makePreviewComponent(b,"splash_ipad_retina_ios7_landscape",{x:c+=115,y:280,width:100,height:75}),a.makeImgChangeBtn("splash_iphone",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE,c=10,183),a.makeImgChangeBtn("splash_iphone_retina",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE_RETINA,c+=115,183),a.makeImgChangeBtn("splash_iphone_568h",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE_568H,
c+=115,183),a.makeImgChangeBtn("splash_ipad",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD,c+=115,183),a.makeImgChangeBtn("splash_ipad_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_LAND,c+=115,183),a.makeImgChangeBtn("splash_ipad_retina",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_RETINA,c=10,421),a.makeImgChangeBtn("splash_ipad_retina_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_RETINA_LAND,c+=115,406),a.makeImgChangeBtn("splash_ipad_ios7",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_IOS7,
c+=115,421),a.makeImgChangeBtn("splash_ipad_ios7_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_IOS7_LAND,c+=115,406),a.makeImgChangeBtn("splash_ipad_retina_ios7",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_RETINA_IOS7,c+=115,421),a.makeImgChangeBtn("splash_ipad_retina_ios7_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_RETINA_IOS7_LAND,c+=115,406)]:[b.makePreviewComponent(b,"splash_iphone",{x:c=0,y:0,width:100,height:150}),b.makePreviewComponent(b,"splash_iphone_retina",{x:c+=
140,y:0,width:100,height:150}),b.makePreviewComponent(b,"splash_iphone_568h",{x:c+=140,y:0,width:100,height:178}),b.makePreviewComponent(b,"splash_iphone6",{x:c+=140,y:0,width:100,height:178}),b.makePreviewComponent(b,"splash_iphone6plus",{x:c+=140,y:0,width:100,height:178}),b.makePreviewComponent(b,"splash_iphone6plus_landscape",{x:c=0,y:280,width:100,height:56}),b.makePreviewComponent(b,"splash_ipad_ios7",{x:c+=140,y:280,width:100,height:133}),b.makePreviewComponent(b,"splash_ipad_ios7_landscape",
{x:c+=140,y:280,width:100,height:75}),b.makePreviewComponent(b,"splash_ipad_retina_ios7",{x:c+=140,y:280,width:100,height:133}),b.makePreviewComponent(b,"splash_ipad_retina_ios7_landscape",{x:c+=140,y:280,width:100,height:75}),a.makeImgChangeBtn("splash_iphone",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE,c=10,183),a.makeImgChangeBtn("splash_iphone_retina",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE_RETINA,c+=140,183),a.makeImgChangeBtn("splash_iphone_568h",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE_568H,
c+=140,183),a.makeImgChangeBtn("splash_iphone6",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE6,c+=140,183),a.makeImgChangeBtn("splash_iphone6plus",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE6PLUS,c+=140,183),a.makeImgChangeBtn("splash_iphone6plus_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPHONE6PLUS_LAND,c=10,406),a.makeImgChangeBtn("splash_ipad_ios7",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_IOS7,c+=140,421),a.makeImgChangeBtn("splash_ipad_ios7_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_IOS7_LAND,
c+=140,406),a.makeImgChangeBtn("splash_ipad_retina_ios7",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_RETINA_IOS7,c+=140,421),a.makeImgChangeBtn("splash_ipad_retina_ios7_landscape",Forte.Resources.Text.SETTING_IOS_SPLASH_IPAD_RETINA_IOS7_LAND,c+=140,406)];Ext.apply(this,{items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.SETTING_IOS_TITLE,style:"margin-bottom: 20px;"},{xtype:"component",cls:"ide-setting-top-description",html:Forte.Resources.Text.SETTING_IOS_DESCRIPTION+' <a href="'+
Forte.Resources.DocumentURL.TOP+'manual/build/ios/build_ios/#configure-ios-app" target="_blank"><img src="/img/icon/help.png"/></a>'},{title:Forte.Resources.Text.SETTING_IOS_APPLICATION,defaults:{xtype:"cell.textfield",allowBlank:!1,labelWidth:180,maxLength:256,validateOnChange:!0},fieldDefaults:{msgTarget:"side"},items:[{id:"applicationName_ios",name:"applicationName_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_APPNAME,helpMsg:Forte.Resources.Text.SETTING_IOS_DESCRIPTION_APPNAME,size:40,validator:function(a){return!a?
Forte.Resources.Text.SETTING_APPLICATION_NAME_ALERT:!0},listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android"+Forte.Resources.Text.SETTING_APPLICATIONNAME_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android"+Forte.Resources.Text.SETTING_APPLICATIONNAME_CAUTION)}}},{id:"applicationID_ios",name:"applicationID_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_APPID,helpMsg:Forte.API.isStandardCordova?Forte.Resources.Text.SETTING_APPID_FOR_STANDARD_CORDOVA:
Forte.Resources.Text.SETTING_IOS_DESCRIPTION_APPID,size:30,validator:function(a){return Forte.API.isStandardCordova?window.validateApplicationId(a):!a||-1===a.search(/^[a-zA-Z]/)?Forte.Resources.Text.SETTING_IOS_APPID_ERROR_FIRSTLETTER:-1===a.search(/^[a-zA-Z0-9\.\-]+$/)?Forte.Resources.Text.SETTING_IOS_APPID_ERROR_SPECIALCHARS:!0},listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,Forte.Resources.Text.SETTING_IOS_PACKAGE_CAUTION)},blur:function(){Forte.API.isStandardCordova&&
a.updateCaution(this,Forte.Resources.Text.SETTING_IOS_PACKAGE_CAUTION)}}},{id:"versionName_ios",name:"versionName_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_VERSIONNAME,helpMsg:Forte.Resources.Text.SETTING_IOS_DESCRIPTION_VERSIONNAME,size:14,validator:function(a){return Forte.API.isStandardCordova&&-1===a.search(/^\d{1,2}\.\d{1,2}\.\d{1,2}$/)?Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_VERSIONNAME:-1===a.search(/^[0-9.]+$/)?Forte.Resources.Text.SETTING_IOS_VERSION_ERROR_SPECIALCHARS:!0},
listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android"+Forte.Resources.Text.SETTING_VERSIONNAME_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android"+Forte.Resources.Text.SETTING_VERSIONNAME_CAUTION)}}},{id:"bundleVersion_ios",name:"bundleVersion_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_BUNDLE_VERSION,helpMsg:Forte.Resources.Text.SETTING_IOS_DESCRIPTION_BUNDLE_VERSION,hidden:parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_FIVE,
size:14,disabled:!0,validator:function(a){return Forte.API.isStandardCordova&&-1===a.search(/^\d{1,2}\.\d{1,2}\.\d{1,2}$/)&&-1===a.search(/^\d{1,2}\.\d{1,2}\.\d{1,2}\.\d{1,2}$/)?Forte.Resources.Text.SETTING_ANDROID_DESCRIPTION_VERSIONNAME:-1===a.search(/^[0-9.]+$/)?Forte.Resources.Text.SETTING_IOS_VERSION_ERROR_SPECIALCHARS:!0}},{xtype:"cell.checkbox",itemId:"disable_bundleversion_ios",name:"disable_bundleversion_ios",labelSeparator:"",hideLabel:!0,boxLabel:Forte.Resources.Text.SETTING_IOS_ALLOW_ENTER_BUNDLE_VERSION,
hidden:parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_FIVE,width:540,margin:"-15 0 20 188",listeners:{change:function(){a.down("#disable_bundleversion_ios").checked?a.down("#bundleVersion_ios").enable():a.down("#bundleVersion_ios").disable()}}},{xtype:"cell.checkboxgroup",itemId:"localizations_ios",name:"localizations_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_LOCALIZATIONS,helpMsg:Forte.Resources.Text.SETTING_IOS_DESCRIPTION_LOCALIZATIONS,maxWidth:800,columns:5,vertical:!1,
allowBlank:!0,validateOnChange:!0,items:[{boxLabel:"English",name:"localizations_ios",inputValue:"en"},{boxLabel:"French",name:"localizations_ios",inputValue:"fr"},{boxLabel:"German",name:"localizations_ios",inputValue:"de"},{boxLabel:"Italian",name:"localizations_ios",inputValue:"it"},{boxLabel:"Spanish",name:"localizations_ios",inputValue:"es"},{boxLabel:"Japanese",name:"localizations_ios",inputValue:"ja"},{boxLabel:"Korean",name:"localizations_ios",inputValue:"ko"},{boxLabel:"Chinese",name:"localizations_ios",
inputValue:"zh"},{boxLabel:"Chinese<br />(simplified)",name:"localizations_ios",inputValue:"zh_CN",fieldStyle:"vertical-align: 18px;"},{boxLabel:"Chinese<br />(traditional)",name:"localizations_ios",inputValue:"zh_TW",fieldStyle:"vertical-align: 18px;"}]}]},{title:Forte.Resources.Text.SETTING_IOS_TARGET_FAMILY,layout:"absolute",height:212,defaults:{inputValue:"1",uncheckedValue:"0"},items:[{xtype:"image",itemId:"ImgTargetIphone",cls:"ide-settings-device-img",x:5,y:0,src:"/img/cell/icon/ico-iphone.png",
listeners:{afterRender:function(){var b=Forte.API.projectSettings;b&&$(a.down("#ImgTargetIphone").getEl().dom).css("opacity",b.config.ios.preference["monaca:targetFamilyiPhone"]?1:0.4)}}},{xtype:"checkbox",itemId:"targetFamilyiPhone_ios",name:"targetFamilyiPhone_ios",boxLabel:"iPhone, iPod touch",y:112,listeners:{change:function(b,c){var e=a.down("#ImgTargetIphone").getEl();e&&$(e.dom).css("opacity",c?1:0.4);!a.down("#targetFamilyiPhone_ios").getValue()&&!a.down("#targetFamilyiPad_ios").getValue()?
a.down("#targetFamilyError").show():a.down("#targetFamilyError").hide()}}},{xtype:"image",itemId:"ImgTargetIpad",name:"ImgTargetIpad",cls:"ide-settings-device-img",x:200,y:0,src:"/img/cell/icon/ico-ipad.png",listeners:{afterRender:function(){var b=Forte.API.projectSettings;b&&$(a.down("#ImgTargetIpad").getEl().dom).css("opacity",b.config.ios.preference["monaca:targetFamilyiPad"]?1:0.4)}}},{xtype:"checkbox",itemId:"targetFamilyiPad_ios",name:"targetFamilyiPad_ios",boxLabel:"iPad",x:237,y:112,listeners:{change:function(b,
c){var e=a.down("#ImgTargetIpad").getEl();e&&$(e.dom).css("opacity",c?1:0.4);!a.down("#targetFamilyiPhone_ios").getValue()&&!a.down("#targetFamilyiPad_ios").getValue()?a.down("#targetFamilyError").show():a.down("#targetFamilyError").hide()}}},{xtype:"component",itemId:"targetFamilyError",cls:"x-form-invalid-under",x:0,y:142,hidden:!0,html:Forte.Resources.Text.SETTING_IOS_TARGET_ERROR}]},{minWidth:720,title:Forte.Resources.Text.SETTING_IOS_ICONS,items:[{xtype:"container",cls:"ide-setting-upload-all",
items:[{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROID_ICON_ALL},{xtype:"filefield",name:"icon_all_ios",buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_UPLOAD+"...",width:200,listeners:{change:function(){var c=this;Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,Forte.Resources.Text.NOTIFY_GENERAL_OVERWRITE,function(e){if("yes"===e){e=$(".ide-setting-thumbnail-icon",a.down("#icons-cont").el.dom);e.html('<img src="/img/loading-icon5.gif" width="16" />&nbsp;');
var h=a.getInputNamesInElement(e[0].parentNode);Forte.API.uploadSettingImg(null,"icon_all_ios",null,function(){b.updateFileFields(b,h);c.reset()},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b);for(var e=0;e<h.length;e++)this.getSettingImgTag(h[e]);c.reset()})}else c.reset()})}}}]},{itemId:"icons-cont",layout:"absolute",height:a.getHeightOfIconCont(),defaults:{xtype:"component",buttonOnly:!0},items:a.getIconItems()}]},{title:Forte.Resources.Text.SETTING_IOS_SPLASHES,
layout:{type:"vbox"},minWidth:720,height:900,defaults:{labelWidth:240,width:700},items:[{cls:"ide-setting-description",html:Forte.Resources.Text.SETTING_IOS_DESCRIPTION5,width:600},{xtype:"container",cls:"ide-setting-upload-all",items:[{xtype:"component",html:Forte.Resources.Text.SETTING_ANDROID_ICON_ALL},{xtype:"filefield",name:"splash_all_ios",buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_UPLOAD+"...",width:200,listeners:{change:function(){var c=this;Cell.LightMessageBox.confirm(Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,
Forte.Resources.Text.NOTIFY_GENERAL_OVERWRITE,function(e){if("yes"===e){e=$(".ide-setting-thumbnail",a.down("#splashes-cont").el.dom);e.html('<img src="/img/loading-icon5.gif" width="16" />&nbsp;');var h=a.getInputNamesInElement(e[0].parentNode);Forte.API.uploadSettingImg(null,"splash_all_ios",null,function(){b.updateFileFields(b,h);c.reset()},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b);for(var e=0;e<h.length;e++)this.getSettingImgTag(h[e]);c.reset()})}else c.reset()})}}}]},
{itemId:"splashes-cont",layout:"absolute",height:568,defaults:{xtype:"component",boxLabel:Forte.Resources.Text.SETTING_CHECKBOX_ENABLE,buttonOnly:!0,labelWidth:260,inputValue:"true",uncheckedValue:"false"},items:e},{xtype:"cell.combobox",itemId:"config_auto_hide_splash_screen",name:"config_auto_hide_splash_screen",editable:!1,fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_AUTO_HIDE_SPLASH_SCREEN,helpMsg:Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE_HELP,labelStyle:"margin-top: 10px;",value:!0,
width:400,size:20,store:[[!1,Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE_FALSE],[!0,Forte.Resources.Text.SETTING_ANDROID_SPLASH_AUTOHIDE_TRUE]]},{xtype:"cell.checkbox",itemId:"config_fade_splash_screen",name:"config_fade_splash_screen",fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_FADE_SPLASH_SCREEN,inputValue:"true",uncheckedValue:"false"},{xtype:"cell.checkbox",itemId:"config_show_splash_screen_spinner",name:"config_show_splash_screen_spinner",fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_SHOW_SPLASH_SCREEN_SPINNER,
inputValue:"true",uncheckedValue:"false"}]},{title:Forte.Resources.Text.SETTING_IOS_OTHERS,defaults:{allowBlank:!1,boxLabel:Forte.Resources.Text.SETTING_CHECKBOX_ENABLE,maxLength:256,validateOnChange:!0,labelStyle:"margin-top: 8px;",labelWidth:260,inputValue:"true",uncheckedValue:"false"},items:[{xtype:"cell.textarea",id:"config_access_origin_ios",name:"config_access_origin_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_ACESS_ORIGIN,helpMsg:Forte.Resources.Text.SETTING_IOS_OTHERS_ACESS_ORIGIN_HELP,
allowBlank:!0,width:540,listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android"+Forte.Resources.Text.SETTING_ACCESS_ORIGIN_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android"+Forte.Resources.Text.SETTING_ACCESS_ORIGIN_CAUTION)}}},{xtype:"cell.checkbox",itemId:"config_disallow_overscroll_ios",name:"config_disallow_overscroll_ios",fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_DISALLOW_OVERSCROLL,helpMsg:Forte.Resources.Text.SETTING_DISALLOW_OVERSCROLL_DESCRIPTION,
width:540,listeners:{change:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android "+Forte.Resources.Text.SETTING_DISALLOW_OVERSCROLL_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"Android "+Forte.Resources.Text.SETTING_DISALLOW_OVERSCROLL_CAUTION)}}},{xtype:"cell.checkbox",id:"config_enable_viewport_scale",name:"config_enable_viewport_scale",fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_ENABLE_VIEWPORT_SCALE},{xtype:"displayfield",itemId:"config_orientation_desc",
name:"config_orientation_desc",style:"-webkit-user-select: text;",hidden:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO,fieldLabel:Forte.Resources.Text.SETTING_IOS_OTHERS_ORIENTATION,value:Forte.Resources.Text.SETTING_IOS_OTHERS_ORIENTATION_DESC}]}],bbar:["->",{xtype:"cell.button",ui:"blue",text:Forte.Resources.Text.GENERAL_SAVE,minWidth:120,handler:function(){var c=a.getForm();if(c.isValid()&&(a.down("#targetFamilyiPhone_ios").getValue()||a.down("#targetFamilyiPad_ios").getValue())){var e=
{};e.ios=c.getFieldValues();b.showMask();delete e.ios.config_orientation_desc;Forte.API.saveProjectSetting(e,function(){a.onSave.call(a)},function(a,c){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:c,buttons:1,minWidth:480,noEscape:!0})})}else Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,Forte.Resources.Text.ERROR_SAVE_SETTING_INVALID_TEXT)}}]});this.callParent()},onSave:function(){var a=this,b=this.parentScope;Forte.API.readProjectSetting(function(c){a.setSettings(c);
a.down("#applicationName_ios").fireEvent("change");a.down("#applicationID_ios").fireEvent("change");a.down("#versionName_ios").fireEvent("change");a.down("#bundleVersion_ios").fireEvent("change");a.down("#config_access_origin_ios").fireEvent("change");a.down("#config_disallow_overscroll_ios").fireEvent("change");b.hideMask();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_SETTING_SAVE,type:"report"})).send()},function(a,e){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
msg:e,buttons:1,minWidth:480,noEscape:!0})})},setSettings:function(a){var b=this.down("#applicationName_ios");b.origValue=a.config.ios.applicationName||"";b.setValue(b.origValue);b=this.down("#applicationID_ios");b.origValue=a.config.ios.applicationId||"";b.setValue(b.origValue);b=this.down("#versionName_ios");b.origValue=a.config.ios.versionName||"";b.setValue(b.origValue);var c=this.down("#bundleVersion_ios"),e=this.down("#disable_bundleversion_ios");c.origValue=a.config.ios.bundleVersion||"";c.setValue(c.origValue);
parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE&&(c.show(),e.show());c.origValue?(c.enable(),e.setValue(!0)):c.setValue(b.origValue);this.setTargetFamily(a);b=this.down("#config_access_origin_ios");b.origValue=a.config.ios.accessOrigin||"";b.setValue(b.origValue);b=this.down("#config_disallow_overscroll_ios");b.origValue="true"===a.config.ios.preference.DisallowOverscroll;b.setValue(b.origValue);this.down("#config_enable_viewport_scale").setValue("true"===a.config.ios.preference.EnableViewportScale);
this.down("#config_auto_hide_splash_screen").setValue("true"===a.config.ios.preference.AutoHideSplashScreen);this.down("#config_fade_splash_screen").setValue("true"===a.config.ios.preference.FadeSplashScreen);this.down("#config_show_splash_screen_spinner").setValue("true"===a.config.ios.preference.ShowSplashScreenSpinner);Forte.API.isStandardCordova&&(this.down("#applicationName_ios").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_IOS,this.down("#applicationID_ios").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_IOS,
this.down("#versionName_ios").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_IOS,this.down("#config_access_origin_ios").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_IOS,this.down("#config_disallow_overscroll_ios").helpMsg+=Forte.Resources.Text.SETTING_PLATFORM_COMMON_IOS,Forte.Resources.Text.SETTING_PLATFORM_COMMON_IOS="");a.project.ios.localizations&&this.down("#localizations_ios").setValue({localizations_ios:a.project.ios.localizations});this.settings=a},getInputNamesInElement:function(a){for(var b=
[],a=$("input[type=file]",a),c=0;c<a.length;c++)b.push(a[c].name);return b},makeImgChangeBtn:function(a,b,c,e){var f=this.parentScope;return{xtype:"filefield",name:a,x:c,y:e,buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_CHANGE+"...",fieldLabel:b,cls:"ios-config-icon-change-field",labelSeparator:"",labelAlign:"top",labelWidth:80,listeners:{change:function(b,c){f.onUploadFileImgBtn(this,b,c,"ios",a)}}}},makeImgDeleteBtn:function(a,b,c){var e=this.parentScope;return{xtype:"cell.button",ui:"light",
text:Forte.Resources.Text.SETTING_REMOVE_BUTTON,x:b,y:c,height:23,listeners:{click:function(b,c){e.onDeleteFileImgBtn(e,b,c,"ios",a)}}}},getHeightOfIconCont:function(){return Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?230:parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_SIX?728:480},getIconItems:function(){var a=this.parentScope,b=0;iconTopRow3=420;var c=this.getIconData();if(Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO)return this.getIconDateForFrameworkVersion2();
parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_SIX?[a.makePreviewComponent(a,"icon_small_3x_ios",{x:b=0,y:iconTopRow3,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad_pro",{x:b+=100,y:iconTopRow3,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),this.makeImgChangeBtn("icon_small_3x_ios",Forte.Resources.Text.SETTING_IOS_ICON_SMALL_3x,b=6,107+iconTopRow3),this.makeImgChangeBtn("icon_ipad_pro",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_PRO,
b+=100,107+iconTopRow3),{html:Forte.Resources.Text.SETTING_IOS_ICON_DESCRIPTION,cls:"cell-annotation",x:0,y:600}].forEach(function(a){c.push(a)}):c.push({html:Forte.Resources.Text.SETTING_IOS_ICON_DESCRIPTION,cls:"cell-annotation",x:0,y:400});return c},getIconData:function(){var a=this.parentScope,b=0;iconTopRow3=420;return[a.makePreviewComponent(a,"icon_iphone",{x:b=0,y:2,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_iphone_retina",{x:b+=100,y:2,width:82,height:82,
cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad",{x:b+=100,y:2,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad_retina",{x:b+=100,y:2,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_60_ios",{x:b+=100,y:2,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_iphone_retina_ios7",{x:b+=100,y:2,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,
"icon_iphone6plus",{x:b+100,y:2,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad_ios7",{x:b=0,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad_retina_ios7",{x:b+=100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_40_ios",{x:b+=100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_40_2x_ios",{x:b+=100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),
a.makePreviewComponent(a,"icon_50_ios",{x:b+=100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_50_2x_ios",{x:b+=100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_small_ios",{x:b+=100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_small_2x_ios",{x:b+100,y:210,width:82,height:82,cls:"ide-setting-thumbnail-icon"}),this.makeImgChangeBtn("icon_iphone",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE,
b=6,92),this.makeImgChangeBtn("icon_iphone_retina",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE_RETINA,b+=100,92),this.makeImgChangeBtn("icon_ipad",Forte.Resources.Text.SETTING_IOS_ICON_IPAD,b+=100,92),this.makeImgChangeBtn("icon_ipad_retina",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_RETINA,b+=100,92),this.makeImgChangeBtn("icon_60_ios",Forte.Resources.Text.SETTING_IOS_ICON_60,b+=100,107),this.makeImgChangeBtn("icon_iphone_retina_ios7",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE_RETINA_IOS7,b+=
100,92),this.makeImgChangeBtn("icon_iphone6plus",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE6PLUS,b+100,92),this.makeImgChangeBtn("icon_ipad_ios7",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_IOS7,b=6,302),this.makeImgChangeBtn("icon_ipad_retina_ios7",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_RETINA_IOS7,b+=100,302),this.makeImgChangeBtn("icon_40_ios",Forte.Resources.Text.SETTING_IOS_ICON_40,b+=100,317),this.makeImgChangeBtn("icon_40_2x_ios",Forte.Resources.Text.SETTING_IOS_ICON_40_RETINA,b+=100,
317),this.makeImgChangeBtn("icon_50_ios",Forte.Resources.Text.SETTING_IOS_ICON_50,b+=100,317),this.makeImgChangeBtn("icon_50_2x_ios",Forte.Resources.Text.SETTING_IOS_ICON_50_RETINA,b+=100,317),this.makeImgChangeBtn("icon_small_ios",Forte.Resources.Text.SETTING_IOS_ICON_SMALL,b+=100,317),this.makeImgChangeBtn("icon_small_2x_ios",Forte.Resources.Text.SETTING_IOS_ICON_SMALL_RETINA,b+100,317)]},getIconDateForFrameworkVersion2:function(){var a=this.parentScope,b=0;iconTopRow3=420;return[a.makePreviewComponent(a,
"icon_iphone",{x:b=0,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_iphone_retina",{x:b+=98,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad",{x:b+=98,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad_retina",{x:b+=98,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_iphone_retina_ios7",{x:b+=98,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),
a.makePreviewComponent(a,"icon_ipad_ios7",{x:b+=98,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),a.makePreviewComponent(a,"icon_ipad_retina_ios7",{x:b+98,y:2,width:90,height:90,cls:"ide-setting-thumbnail-icon"}),this.makeImgChangeBtn("icon_iphone",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE,b=5,112),this.makeImgChangeBtn("icon_iphone_retina",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE_RETINA,b+=98,112),this.makeImgChangeBtn("icon_ipad",Forte.Resources.Text.SETTING_IOS_ICON_IPAD,b+=98,
112),this.makeImgChangeBtn("icon_ipad_retina",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_RETINA,b+=98,112),this.makeImgChangeBtn("icon_iphone_retina_ios7",Forte.Resources.Text.SETTING_IOS_ICON_IPHONE_RETINA_IOS7,b+=98,97),this.makeImgChangeBtn("icon_ipad_ios7",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_IOS7,b+=98,112),this.makeImgChangeBtn("icon_ipad_retina_ios7",Forte.Resources.Text.SETTING_IOS_ICON_IPAD_RETINA_IOS7,b+98,112),{html:Forte.Resources.Text.SETTING_IOS_ICON_DESCRIPTION,cls:"cell-annotation",
x:0,y:190}]},setTargetFamily:function(a){if(parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_SIX){a=a.config.ios.preference["ios-XCBuildConfiguration-TARGETED_DEVICE_FAMILY"];a==Forte.Setting.IOS.DEVICE_FAMILY_IPHONE?(this.down("#targetFamilyiPhone_ios").setValue(!0),this.down("#targetFamilyiPad_ios").setValue(!1)):a==Forte.Setting.IOS.DEVICE_FAMILY_IPAD?(this.down("#targetFamilyiPhone_ios").setValue(!1),this.down("#targetFamilyiPad_ios").setValue(!0)):a==Forte.Setting.IOS.DEVICE_FAMILY_UNIVERSAL?
(this.down("#targetFamilyiPhone_ios").setValue(!0),this.down("#targetFamilyiPad_ios").setValue(!0)):(this.down("#targetFamilyiPhone_ios").setValue(!1),this.down("#targetFamilyiPad_ios").setValue(!1));var b=this.down("#ImgTargetIphone").el;b&&$(b.dom).css("opacity",this.down("#targetFamilyiPhone_ios").getValue()?1:0.4);(b=this.down("#ImgTargetIpad").el)&&$(b.dom).css("opacity",this.down("#targetFamilyiPad_ios").getValue()?1:0.4)}else this.down("#targetFamilyiPhone_ios").setValue(parseInt(a.config.ios.preference["monaca:targetFamilyiPhone"])?
!0:!1),(b=this.down("#ImgTargetIphone").el)&&$(b.dom).css("opacity",parseInt(a.config.ios.preference["monaca:targetFamilyiPhone"])?1:0.4),this.down("#targetFamilyiPad_ios").setValue(parseInt(a.config.ios.preference["monaca:targetFamilyiPad"])?!0:!1),(b=this.down("#ImgTargetIpad").el)&&$(b.dom).css("opacity",parseInt(a.config.ios.preference["monaca:targetFamilyiPad"])?1:0.4)}});Forte.Setting.IOS.DEVICE_FAMILY_IPHONE="1";Forte.Setting.IOS.DEVICE_FAMILY_IPAD="2";Forte.Setting.IOS.DEVICE_FAMILY_UNIVERSAL=
"1,2"})();(function(){Ext.define("Forte.Setting.IOSUser",{extend:"Cell.SettingPanel",alias:"widget.setting.iosuser",id:"setting:iosuser",settings:null,parentScope:null,initComponent:function(){var a=this,b=a.parentScope;Ext.apply(a,{items:[{xtype:"component",html:Forte.Resources.Text.SETTING_IOSUSER_TITLE,cls:"cell-title",style:"margin-bottom: 20px;"},{xtype:"component",cls:"ide-setting-top-description",html:Forte.Resources.Text.SETTING_IOSUSER_DESCRIPTION+' <a href="'+Forte.Resources.DocumentURL.TOP+'manual/build/ios/build_ios/#configure-ios-build-settings" target="_blank"><img src="/img/icon/help.png"/></a>'},
{xtype:"component",itemId:"caution",cls:"ide-setting-caution",style:"color: #D00; margin-bottom: 30px;",hidden:!0},{title:Forte.Resources.Text.SETTING_IOSUSER_STEP1,defaults:{labelWidth:220},items:[{xtype:"component",cls:"ide-setting-description",html:Forte.Resources.Text.SETTING_IOSUSER_DESCRIPTION2},{xtype:"fieldcontainer",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_GENERATECSR,layout:"hbox",labelStyle:"margin-top: 12px;",items:[{itemId:"isKeyRegistered",html:Forte.Resources.Text.SETTING_IOSUSER_KEY_REGISTERED,
style:"margin-top: 3px; margin-right: 10px;"},{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.SETTING_IOSUSER_GENERATE,style:"margin-right: 5px;",listeners:{click:function(){Forte.API.getProjectSettingFileList().csr_ios?Cell.LightMessageBox.confirm({title:Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,icon:null,buttons:6,msg:Forte.Resources.Text.SETTING_IOSUSER_GENERATE_OVERWRITE,callback:function(b){"yes"==b&&a.generatePrivateKey()}}):a.generatePrivateKey()}}},{xtype:"cell.button",ui:"light",
text:Forte.Resources.Text.SETTING_IOSUSER_IMPORT,listeners:{click:function(){Forte.API.getProjectSettingFileList().csr_ios?Cell.LightMessageBox.confirm({title:Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,icon:null,msg:Forte.Resources.Text.SETTING_IOSUSER_GENERATE_OVERWRITE,buttons:6,callback:function(b){"yes"==b&&a.uploadPrivateKey()}}):a.uploadPrivateKey()}}}]},{xtype:"displayfield",itemId:"adcUsername_ios",name:"adcUsername_ios",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_USERNAME_DISPLAY,
value:"-",width:300},{xtype:"fieldcontainer",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_CSR_DISPLAY,labelStyle:"margin-top: 17px;",layout:"hbox",items:[{xtype:"displayfield",itemId:"adc_email_ios",name:"adc_email_ios",value:Forte.Resources.Text.SETTING_IOSUSER_CSR_NONE,width:170},{xtype:"cell.button",itemId:"csrExport",ui:"light",text:Forte.Resources.Text.GENERAL_EXPORT+"...",listeners:{click:function(){Ext.widget("widgets.iframewindow",{title:"Export",width:450,height:280,src:Forte.API.export("csr_ios")}).show()}}}]}]},
{title:Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CER_TITLE,defaults:{xtype:"cell.fieldcontainer",layout:"hbox",labelStyle:"margin-top: 20px;",labelWidth:220},items:[{xtype:"component",cls:"ide-setting-description",html:Forte.Resources.Text.SETTING_IOSUSER_DESCRIPTION3},{fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CERTFILE_DEV,style:"margin-bottom: 0;",items:[{xtype:"component",itemId:"isCerDevRegistered",html:Forte.Resources.Text.SETTING_IOSUSER_CER_REGISTERED,style:"margin-top: 11px; margin-right: 10px;"},
{xtype:"filefield",name:"dev_certification_ios",buttonOnly:!0,buttonText:Forte.Resources.Text.SETTING_IOSUSER_SELECT_CERT_BUTTON,style:"margin-right: 10px;",width:110,listeners:{change:function(c,e){b.onUploadFileBtn(b,c,e,"dev_certification_ios",function(){a.down("#cerDevExport").enable();a.down("#isCerDevRegistered").show();a.parent.showMask();a.parent.loadProjectSetting();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOAD_CER,type:"report"})).send()})}}},{xtype:"cell.button",itemId:"cerDevExport",
ui:"light",text:Forte.Resources.Text.GENERAL_EXPORT+"...",style:"margin-top: 7px;",listeners:{click:function(){Ext.widget("widgets.iframewindow",{title:"Export",width:450,height:440,src:Forte.API.export("dev_certification_ios")}).show()}}}]},{fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CERTFILE_DIST,items:[{xtype:"component",itemId:"isCerRegistered",html:Forte.Resources.Text.SETTING_IOSUSER_CER_REGISTERED,style:"margin-top: 11px; margin-right: 10px;"},{xtype:"filefield",name:"certification_ios",
buttonOnly:!0,buttonText:Forte.Resources.Text.SETTING_IOSUSER_SELECT_CERT_BUTTON,style:"margin-right: 10px;",width:110,listeners:{change:function(c,e){b.onUploadFileBtn(b,c,e,"certification_ios",function(){a.down("#cerExport").enable();a.down("#isCerRegistered").show();a.parent.showMask();a.parent.loadProjectSetting();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOAD_CER,type:"report"})).send()})}}},{xtype:"cell.button",itemId:"cerExport",ui:"light",text:Forte.Resources.Text.GENERAL_EXPORT+
"...",style:"margin-top: 7px;",listeners:{click:function(){Ext.widget("widgets.iframewindow",{title:"Export",width:450,height:460,src:Forte.API.export("certification_ios")}).show()}}}]}]}]});a.callParent()},setSettings:function(a,b,c){var e=this,f=[];c.privateKey_ios?e.down("#adcUsername_ios").setValue(b.adc_username_ios):(f.push(Forte.Resources.Text.SETTING_GENERAL_NOTCREATE(Forte.Resources.Text.SETTING_IOSUSER_KEY)),e.down("#isKeyRegistered").hide());c.csr_ios||e.down("#csrExport").disable();c.dev_certification_ios||
(e.down("#cerDevExport").disable(),e.down("#isCerDevRegistered").hide());c.certification_ios||(e.down("#cerExport").disable(),e.down("#isCerRegistered").hide());b.has_adc_csr&&e.down("#adc_email_ios").setValue(b.adc_email_ios);Forte.API.canBuildIOSApp(function(a){a.dev_certificate_error&&f.push(Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CERTFILE_DEV+": "+Forte.Resources.Text.GENERAL_INVALID+" ("+a.dev_certificate_error+")");a.certificate_error&&f.push(Forte.Resources.Text.SETTING_IOSUSER_UPLOAD_CERTFILE_DIST+
": "+Forte.Resources.Text.GENERAL_INVALID+" ("+a.certificate_error+")");a=e.down("#caution");if(f.length){a.update(f.join("<br>"));a.show()}else a.hide()});e.settings=a},generatePrivateKey:function(){var a=this;Ext.create("Forte.iOSKeyGenerateWindow",{callbackFunc:function(b,c){var e=a.getForm();e.setValues({adcUsername_ios:b});e.setValues({adc_email_ios:c});a.down("#isKeyRegistered").update(Forte.Resources.Text.SETTING_IOSUSER_KEY_REGISTERED);a.down("#csrExport").enable();a.down("#caution").hide();
(new Message.Notify({message:Forte.Resources.Text.NOTIFY_GENERATE_CSR_TITLE,type:"report"})).send();Forte.API.readProjectSettingFileList()}}).show()},uploadPrivateKey:function(){var a=this;Ext.create("Forte.iOSKeyUploadWindow",{callbackFunc:function(){var b=a.getForm();Forte.API.readUserSetting(function(a){b.setValues({adcUsername_ios:a.adc_username_ios,adc_email_ios:Forte.Resources.Text.SETTING_IOSUSER_CSR_NONE})});a.down("#isKeyRegistered").update(Forte.Resources.Text.SETTING_IOSUSER_KEY_REGISTERED);
a.down("#csrExport").disable();a.down("#caution").hide();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOAD_FILE,type:"report"})).send();Forte.API.readProjectSettingFileList()}}).show()}});Ext.define("Forte.iOSKeyGenerateWindow",{extend:"Cell.window.LightWindow",alias:"widget.iOSKeyGenerateWindow",callbackFunc:null,initComponent:function(){var a=this;a.generateCSRForm=Ext.create("Ext.form.Panel",{layout:"anchor",border:!1,autoScroll:!0,bodyStyle:"padding : 10px;",defaults:{anchor:"100%",
bodyStyle:"padding : 10px;"},fieldDefaults:{msgTarget:"side",labelWidth:240},listeners:{fieldvaliditychange:function(a){Ext.getCmp("ios-build-generate-csr").setDisabled(!a.form.isValid())}},items:[{xtype:"component",html:Forte.Resources.Text.SETTING_IOSUSER_USERNAME_MAIL_DESCRIPTION},{xtype:"textfield",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_USERNAME,name:"adcUsername_ios",allowBlank:!1,maxLength:256,validateOnChange:!0},{xtype:"textfield",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_MAIL,
name:"adcMailAddress_ios",allowBlank:!1,maxLength:256,validator:function(a){return/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,63}$/.test(a)}}]});Ext.apply(this,{title:Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,width:550,modal:!0,closable:!1,items:[a.generateCSRForm],dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:[{xtype:"component",flex:1},{xtype:"cell.button",id:"ios-build-generate-csr",ui:"light",disabled:!0,text:Forte.Resources.Text.SETTING_IOSUSER_GENERATEKEY_CSR,
handler:function(){var b=a.generateCSRForm.getForm();if(b.isValid()){var c=b.getFieldValues();Forte.API.makeCSR(c.adcUsername_ios,c.adcMailAddress_ios,"csr_ios",function(){Forte.API.saveUserSetting({adc_username_ios:c.adcUsername_ios,adc_email_ios:c.adcMailAddress_ios});a.callbackFunc(c.adcUsername_ios,c.adcMailAddress_ios);Cell.LightMessageBox.alert(Forte.Resources.Text.NOTIFY_GENERATE_CSR_TITLE,Forte.Resources.Text.NOTIFY_GENERATE_CSR)},function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
b)})}a.close()}},{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_CANCEL,width:80,handler:function(){a.close()}}]}]});this.callParent()}});Ext.define("Forte.iOSKeyUploadWindow",{extend:"Cell.window.LightWindow",alias:"widget.iOSKeyUploadWindow",callbackFunc:null,initComponent:function(){var a=this;a.uploadCSRForm=Ext.create("Ext.form.Panel",{layout:"anchor",border:!1,autoScroll:!0,bodyStyle:"padding : 10px;",defaults:{anchor:"100%",bodyStyle:"padding : 10px;",margin:20},fieldDefaults:{msgTarget:"side",
labelWidth:180},items:[{xtype:"label",text:Forte.Resources.Text.SETTING_IOSUSER_SECRETKEY_DESCRIPTION},{xtype:"filefield",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_SECRETKEY_FORM,itemId:"secret_key",name:"secret_key",allowBlank:!1,validateOnChange:!0},{xtype:"textfield",inputType:"password",fieldLabel:Forte.Resources.Text.SETTING_IOSUSER_SECRETKEY_PASSWORD_FORM,itemId:"password",name:"password",allowBlank:!0,validateOnChange:!0}]});Ext.apply(this,{title:Forte.Resources.Text.NOTIFY_GENERAL_MONACA_TITLE,
width:550,modal:!0,closable:!1,items:[a.uploadCSRForm],dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:[{xtype:"component",flex:1},{xtype:"cell.button",ui:"light",width:80,text:Forte.Resources.Text.GENERAL_IMPORT,handler:function(){var b=a.uploadCSRForm.getForm();if(b.isValid()){var b=b.getFieldValues(),c=$("input[name=secret_key]");Forte.API.importPKCSKey("secret_key",c,b.password,function(){a.callbackFunc()})}a.close()}},{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_CANCEL,
width:80,handler:function(){a.close()}}]}]});this.callParent()}})})();(function(){Ext.define("Forte.Setting.Winrt",{extend:"Cell.SettingPanel",alias:"widget.setting.winrt",id:"setting:winrt",settings:null,parentScope:null,appBgPicker:null,splashPicker:null,fieldDefaults:{msgTarget:"under"},initComponent:function(){var a=this,b=a.parentScope;Ext.apply(a,{items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.SETTING_LIST_WINRT,style:"margin-bottom: 20px;"},{xtype:"component",cls:"ide-setting-top-description",html:Forte.Resources.Text.SETTING_WINRT_DESCRIPTION},
{title:Forte.Resources.Text.SETTING_WINRT_APPLICATION,cls:"ide-setting-winrt-app",defaults:{xtype:"textfield",allowBlank:!0,maxLength:256,validateOnChange:!1,validateOnBlur:!1},fieldDefaults:{labelWidth:180,msgTarget:"side"},items:[{xtype:"cell.textfield",name:"identity_name_winrt",itemId:"identity_name_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_IDENTITY_NAME,style:"margin-top: 5px;",labelStyle:"margin-top: 0;",labelWidth:180,maxLength:256,width:520,validateOnChange:!0,validator:function(a){return!a?
Forte.Resources.Text.SETTING_REQUIRED:-1===a.search(/^[0-9a-zA-Z\-\.]+$/)?Forte.Resources.Text.SETTING_VALIDATOR_ERR4:!0}},{xtype:"fieldcontainer",fieldLabel:Forte.Resources.Text.SETTING_WINRT_UPLOAD_PACKAGE_CERTIFICATE_KEY,labelWidth:180,layout:"hbox",style:"margin: 0;",defaults:[{style:"margin: 0"}],items:[{width:110,xtype:"filefield",name:"debug_pfx_winrt",buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_UPLOAD+"...",listeners:{change:function(c,e){b.onUploadFileBtn(b,c,e,"debug_pfx_winrt",
function(){a.down("#keyExport").enable();(new Message.Notify({message:Forte.Resources.Text.SETTING_WINRT_UPLOAD_PACKAGE_CERTIFICATE_KEY_UPLOADED,type:"report"})).send()})}}},{xtype:"cell.button",itemId:"keyExport",ui:"light",margin:"1 0 0 10",text:Forte.Resources.Text.GENERAL_EXPORT+"...",listeners:{click:function(){Ext.widget("widgets.iframewindow",{title:Forte.Resources.Text.SETTING_WINRT_UPLOAD_PACKAGE_CERTIFICATE_KEY,width:450,height:280,src:Forte.API.export("debug_pfx_winrt")}).show()}}}]},{itemId:"app_display_name_winrt",
name:"app_display_name_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_APP_DISPLAY_NAME,labelWidth:180,size:64},{itemId:"identity_version_winrt",name:"identity_version_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_IDENTITY_VERSION,labelWidth:180,size:15,validator:function(a){return Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO?!0:-1===a.search(/^\d{1,2}\.\d{1,2}\.\d{1,2}$/)?Forte.Resources.Text.SETTING_WINRT_DESCRIPTION_VERSIONNAME:!0},listeners:{change:function(){Forte.API.isStandardCordova&&
a.updateCaution(this,"iOS/Android"+Forte.Resources.Text.SETTING_VERSIONNAME_CAUTION)},blur:function(){Forte.API.isStandardCordova&&a.updateCaution(this,"iOS/Android"+Forte.Resources.Text.SETTING_VERSIONNAME_CAUTION)}}},{id:"packageVersion_winrt",name:"packageVersion_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_PACKAGE_VERSION,helpMsg:Forte.Resources.Text.SETTING_IOS_DESCRIPTION_BUNDLE_VERSION,hidden:parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_FIVE,labelWidth:180,size:15,
disabled:!0,validateOnChange:!0,validator:function(a){return-1===a.search(/^\d{1,2}\.\d{1,2}\.\d{1,2}\.\d{1,2}$/)?Forte.Resources.Text.SETTING_WINRT_DESCRIPTION_PACKAGE_VERSION:-1===a.search(/^[0-9.]+$/)?Forte.Resources.Text.SETTING_IOS_VERSION_ERROR_SPECIALCHARS:!0}},{xtype:"cell.checkbox",itemId:"disable_packageVersion_winrt",name:"disable_packageVersion_winrt",labelSeparator:"",hideLabel:!0,boxLabel:Forte.Resources.Text.SETTING_WINRT_ALLOW_ENTER_PACKAGE_VERSION,hidden:parseFloat(Forte.API.cordovaVersion)<
Forte.API.CORDOVA_VERSION_FIVE,width:540,margin:"-15 0 20 188",listeners:{change:function(){a.down("#disable_packageVersion_winrt").checked?a.down("#packageVersion_winrt").enable():a.down("#packageVersion_winrt").disable()}}},{xtype:"cell.textarea",itemId:"app_description_winrt",name:"app_description_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_DESCRIPTION_FIELD,labelWidth:180,rows:4,cols:64,fieldDefaults:{msgTarget:"side"},helpMsg:Forte.Resources.Text.SETTING_WINRT_DESCRIPTION_FIELD_HELP},
{itemId:"package_publisher_display_name_winrt",name:"package_publisher_display_name_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_PACKAGE_PUBLISHER_DISPLAY_NAME,labelWidth:180,size:32},{xtype:"cell.combobox",itemId:"app_arch_winrt",name:"app_arch_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_ARCH,labelWidth:180,size:15,displayField:"name",valueField:"value",value:"",editable:!1,store:Ext.create("Ext.data.Store",{fields:["value","name"],data:[{value:"",name:"AnyCPU"},{value:"x86",name:"x86"},
{value:"x64",name:"x64"},{value:"arm",name:"Arm"}]})}]},{title:Forte.Resources.Text.SETTING_WINRT_APP_LOGO,layout:"absolute",height:230,defaults:{xtype:"component",width:200},items:[b.makePreviewComponent(b,"app_logo_winrt",{x:0,y:0,width:150,height:150}),b.makePreviewComponent(b,"package_logo_winrt",{x:270,y:100,width:50,height:50}),b.makePreviewComponent(b,"app_small_logo_winrt",{x:440,y:120,width:30,height:30}),a.makeSplashChangeBtn("app_logo_winrt","150x150",155,105),a.makeSplashChangeBtn("package_logo_winrt",
"50x50",325,105),a.makeSplashChangeBtn("app_small_logo_winrt","30x30",475,105),{html:Forte.Resources.Text.SETTING_WINRT_IMAGE_DESCRIPTION,cls:"cell-annotation",x:0,y:160,width:600}]},{title:Forte.Resources.Text.SETTING_WINRT_TILE_LOGO,layout:"absolute",height:230,defaults:{xtype:"component"},items:[b.makePreviewComponent(b,"app_tile_wide_logo_winrt",{x:0,y:0,width:310,height:150}),a.makeSplashChangeBtn("app_tile_wide_logo_winrt","310x150",320,106),{cls:"cell-annotation",html:Forte.Resources.Text.SETTING_WINRT_IMAGE_DESCRIPTION,
x:0,y:155}]},{title:Forte.Resources.Text.SETTING_WINRT_SPLASH_IMAGE,cls:"ide-setting-winrt-splash",height:430,layout:"absolute",defaults:{xtype:"component",labelWidth:120},items:[b.makePreviewComponent(b,"app_splash_screen_winrt",{x:0,y:0}),a.makeSplashChangeBtn("app_splash_screen_winrt","620x300",0,308,"left"),{xtype:"textfield",itemId:"app_splash_background_winrt",name:"app_splash_background_winrt",fieldLabel:Forte.Resources.Text.SETTING_WINRT_SPLASH_BACKGROUND,labelStyle:"text-align: right;",allowBlank:!0,
maxLength:256,size:12,validateOnChange:!1,validateOnBlur:!1,x:170,y:308,listeners:{afterRender:function(b){var e=new jscolor.color(b.inputEl.dom,{});e.required=!1;e.hash=!0;e.slider=!1;e.pickerClosable=!0;e.onImmediateChange=function(){document.getElementById("setting_file_winrt_app_splash_screen_winrt").style.backgroundColor=e.toString()};a.settings&&a.settings.manifest.winrt.app_splash_background_winrt&&(e.fromString(a.settings.manifest.winrt.app_splash_background_winrt),document.getElementById("setting_file_winrt_app_splash_screen_winrt").style.backgroundColor=
e.toString());a.splashPicker=e}}},{cls:"cell-annotation",html:Forte.Resources.Text.SETTING_WINRT_IMAGE_DESCRIPTION,x:0,y:350}]}],bbar:["->",{xtype:"cell.button",ui:"blue",text:Forte.Resources.Text.GENERAL_SAVE,minWidth:120,handler:function(){var c=a.getForm();if(c.isValid()){var e={};e.winrt=c.getValues();b.showMask();Forte.API.saveProjectSetting(e,function(){Forte.API.readProjectSetting(function(c){a.settings=c;b.hideMask();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_SETTING_SAVE,type:"report"})).send()},
function(a,c){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:c,buttons:1,minWidth:480,noEscape:!0})})},function(a,c){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:c,buttons:1,minWidth:480,noEscape:!0})})}else Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,Forte.Resources.Text.ERROR_SAVE_SETTING_INVALID_TEXT)}}]});a.callParent()},setSettings:function(a){this.down("#identity_name_winrt").setValue(a.config.WindowsStoreIdentityName?
a.config.WindowsStoreIdentityName:a.manifest.winrt.identity_name_winrt);this.down("#app_display_name_winrt").setValue(a.manifest.winrt.app_display_name_winrt||"");this.down("#identity_version_winrt").setValue(a.manifest.winrt.identity_version_winrt||"");this.down("#app_description_winrt").setValue(a.manifest.winrt.app_description_winrt||"");this.down("#package_publisher_display_name_winrt").setValue(a.manifest.winrt.package_publisher_display_name_winrt||"");this.down("#app_arch_winrt").setValue(a.manifest.winrt.app_arch_winrt||
"");this.setPackageVersion(a);this.settings=a},setPackageVersion:function(a){var b=this.down("#packageVersion_winrt"),c=this.down("#disable_packageVersion_winrt");b.origValue=a.config.winrt.packageVersion||"";b.setValue(b.origValue);parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE&&(b.show(),c.show());b.origValue?(b.enable(),c.setValue(!0)):b.setValue(b.origValue)},makeSplashChangeBtn:function(a,b,c,e,f){var g=this.parentScope;"undefined"===typeof f&&(f="top");return{xtype:"filefield",
name:a,x:c,y:e,buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_CHANGE+"...",fieldLabel:b,labelAlign:f,labelWidth:80,width:180,listeners:{change:function(b,c){g.onUploadFileImgBtn(this,b,c,"winrt",a)}}}}})})();(function(){Ext.define("Forte.Setting.CordovaPlugins",{extend:"Cell.SettingPanel",settings:null,contentWindow:null,bodyStyle:"padding: 0",initComponent:function(){var a=this,b=a.parent;Ext.apply(a,{items:[{xtype:"component",layout:"fit",html:'<iframe src="/page/cordovaPlugins" class="cell-iframe-tab-content" frameborder="0"></iframe>',height:"100%",listeners:{afterRender:function(){setIframeMaskHandler();a.contentWindow=this.el.dom.getElementsByTagName("iframe")[0].contentWindow;a.contentWindow.settingsPanel=
b;a.contentWindow.cordovaSettingsPanel=a}}}],createCordovaImportWindow:function(){Ext.create("Forte.CordovaImportWindow",{parentScope:b}).show()},showMask:function(){a.parent.loadmask.show()},hideMask:function(){a.parent.loadmask.hide()}});a.callParent()},setSettings:function(a){this.settings=a;this.contentWindow&&this.contentWindow.dispatchEvent(new Event("settingChanged"))},showMask:function(){this.parent.loadmask.show()},hideMask:function(){this.parent.loadmask.hide()},showUpgradeIndicator:function(){var a=
{lines:13,length:18,width:6,radius:14,rotate:0,color:"#a3a3a3",speed:1,trail:60,shadow:!1,hwaccel:!0,className:"spinner",zIndex:200,top:"auto",left:"auto"};$("#ide-initial-loading-background")||($(document.body).append($('<div id="ide-initial-loading-background" />')),$(document.body).append($('<div id="ide-initial-loading" />').html('<div id="ide-initial-loading-inner"></div><div id="ide-initial-loading-msg"></div>')),(new Spinner(a)).spin($("#ide-initial-loading-inner")[0]));$("#ide-initial-loading-msg").text(Forte.Resources.Text.SETTING_CORDOVA_VERSION_UP_PROGRESS_INFO);
$("#ide-initial-loading-msg").css({color:"white"});$("#ide-initial-loading-background").show();$("#ide-initial-loading").css({opacity:1}).show();$("#ide-initial-loading-background").css({"background-color":"rgba(0, 0, 0, 0.8)"})},hideUpgradeIndicator:function(){var a=$("#ide-initial-loading").position().top;$("#ide-initial-loading").animate({opacity:0},{duration:300,complete:function(){$("#ide-initial-loading").hide()},step:function(){a+=0.5;$(this).css({top:Math.round(a)})}});$("#ide-initial-loading-background").hide()},
reloadIDE:function(){$(window).unbind("beforeunload");window.location.reload()}});Ext.define("Forte.CordovaImportWindow",{extend:"Cell.window.LightWindow",parentScope:null,initComponent:function(){var a=this,b=Ext.create("Ext.form.Panel",{itemId:"form",layout:"absolute",height:190,fieldDefaults:{msgTarget:"under",labelWidth:180},items:[{xtype:"radiogroup",itemId:"method",name:"method",columns:1,x:0,y:0,defaults:{height:74},listeners:{change:function(c,e){e=e.cordova_import_method;"string"===typeof e&&
("url"===e?(a.down("#file").disable(),b.getForm().findField("file").disable(),a.down("#name").enable()):(a.down("#name").disable(),b.getForm().findField("file").enable(),a.down("#file").enable()))}},items:[{boxLabel:Forte.Resources.Text.SETTING_CORDOVA_IMPORTWINDOW_ZIP,name:"cordova_import_method",inputValue:"zip",checked:!0},{boxLabel:Forte.Resources.Text.SETTING_CORDOVA_IMPORTWINDOW_URL,name:"cordova_import_method",inputValue:"url",disabled:Forte.API.frameworkVersion===Forte.API.FRAMEWORK_VERSION_TWO}]},
{xtype:"filefield",fieldLabel:Forte.Resources.Text.SETTING_CORDOVA_IMPORTWINDOW_ZIP_LABEL,itemId:"file",name:"file",x:0,y:48,width:460},{xtype:"textfield",fieldLabel:Forte.Resources.Text.SETTING_CORDOVA_IMPORTWINDOW_URL_LABEL,itemId:"name",name:"name",disabled:!0,x:0,y:134,width:460,regex:/^[^\s]+$/,listeners:{change:function(b){b.isValid()?a.down("#btn_import").enable():a.down("#btn_import").disable()}}}]});Ext.apply(a,{title:Forte.Resources.Text.SETTING_CORDOVA_IMPORTWINDOW_TITLE,width:550,modal:!0,
closable:!1,layout:"fit",items:[b],bbar:["->",{xtype:"cell.button",ui:"light",itemId:"btn_import",width:80,text:Forte.Resources.Text.GENERAL_IMPORT,handler:function(){var b=a.getComponent("form").getForm(),e=b.findField("method").getValue().cordova_import_method,f=function(){a.parentScope.loadProjectSetting()};"zip"===e?a.uploadPackage(b.findField("file").fileInputEl.dom,f):"url"===e&&a.uploadPackage(b.findField("name").getValue(),f);a.close()}},{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_CANCEL,
width:80,handler:function(){a.close()}}]});this.callParent()},uploadPackage:function(a,b){var c=this;if("string"===typeof a)var e=a,f=null;else e=a.files[0],f=$(a);e&&(c.parentScope.showMask(),Forte.API.importCordovaPlugin(e,f,function(){Message.ProjectPanel.UpdateProject.send();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOAD_FILE,type:"report"})).send();c.parentScope.hideMask();b&&b()},function(a,e){c.parentScope.hideMask();b&&b();401==a?Ext.create("Cell.window.RestrictionDialog").showWindow("CORDOVA_PLUGINS"):
Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,e)}))}})})();(function(){Ext.define("Forte.Setting.Html5Plugins",{extend:"Cell.SettingPanel",fieldDefaults:{msgTarget:"under"},parentScope:null,initComponent:function(){var a=this;Ext.apply(a,{id:"setting:html5plugins",items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.SETTING_HTML5_PLUGIN_TITLE},{xtype:"panel",itemId:"plugins-cont",cls:"ide-setting-plugin-cont",minWidth:800,defaults:{layout:"absolute"},tbar:{cls:"ide-setting-plugin-cont-tbar",items:[{xtype:"component",html:Forte.Resources.Text.SETTING_HTML5_PLUGIN_SEARCH},
"->",{xtype:"textfield",id:"ide-setting-html5-plugin-search-keyword",emptyText:Forte.Resources.Text.SETTING_HTML5_PLUGIN_SEARCH_TEXT,width:200,height:30,enableKeyEvents:!0,listeners:{keydown:function(b,c){13==c.keyCode&&a.searchComponent()}}},{xtype:"cell.button",id:"ide-setting-html5-plugin-do-search",name:"ide-setting-html5-plugin-do-search",ui:"blue",width:100,text:Forte.Resources.Text.SETTING_HTML5_PLUGIN_SEARCH_BUTTON,listeners:{click:function(){a.searchComponent()}}}]}}]});a.callParent()},makeHtml5PluginPanel:function(a,
b){var c=this,e=[],f=[],g=[];b.homepage?f.push('<strong style="font-weight: bold"><a href="'+Ext.htmlEncode(b.homepage)+'" target="_blank">'+Ext.htmlEncode(b.displayName)+"</a></strong>"):f.push('<strong style="font-weight: bold">'+Ext.htmlEncode(b.displayName)+"</strong>");b.isInstalled||g.push(Forte.Resources.Text.SETTING_HTML5_PLUGIN_NOT_INSTALLED);b.version&&g.push(Forte.Resources.Text.SETTING_HTML5_PLUGIN_VERSION+Ext.htmlEncode(b.version));b.isDependent&&g.push(Forte.Resources.Text.SETTING_HTML5_PLUGIN_DEPENDENT);
e.push({xtype:"image",cls:"ide-setting-plugin-img",src:"/img/new_ide/settings/ico_list_component.png",x:12,y:12,width:20,height:20});e.push({xtype:"component",cls:"ide-setting-plugin-name",html:f.join(" ")+" <span style='color: #666;'>"+g.join(" ")+"</span>",x:40,y:16,width:600});e.push({xtype:"cell.button",itemId:"file-settings",ui:b.isInstalled?"red":"blue",text:b.isInstalled?Forte.Resources.Text.SETTING_HTML5_PLUGIN_UNINSTALL:Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL,disabled:!0===b.isDependent,
x:660,y:8,width:80,handler:function(){b.isInstalled?c.uninstallComponent(b):c.installComponent(b)}});b.isInstalled&&e.push({xtype:"cell.button",ui:"light",text:Forte.Resources.Text.SETTING_HTML5_PLUGIN_CONFIGURE_LOADER,x:530,y:8,width:120,handler:function(){c.configureLoader(b)}});return{xtype:"container",cls:b.isInstalled?"ide-setting-plugin-list-item selected":"ide-setting-plugin-list-item",height:42,items:e,component:b}},searchComponent:function(){var a=this;a.parentScope.showMask();var b=a.down("#ide-setting-html5-plugin-search-keyword").getValue();
Forte.API.listHtml5Plugin(b,function(b){a.setSettings(b)}).fail(function(){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.SETTING_API_FAILED)}).always(function(){a.parentScope.hideMask()})},installComponent:function(a){var b=this;b.parentScope.showMask();Forte.API.getHtml5PluginInfo({name:a.name,offline:!1},function(a){b.showInstallDialog(a)}).fail(function(){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.SETTING_API_FAILED)}).always(function(){b.parentScope.hideMask()})},
uninstallComponent:function(a){var b=this;Cell.LightMessageBox.confirm(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.SETTING_HTML5_PLUGIN_UNINSTALL_CONFIRM,function(c){"yes"===c&&(b.parentScope.showMask(),Forte.API.uninstallHtml5Plugin(a.name,function(){Forte.API.listHtml5Plugin(null,function(a){b.setSettings(a);Message.ProjectPanel.UpdateProject.send();Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_MONACAIDE,Forte.Resources.Text.SETTING_HTML5_PLUGIN_UNINSTALLED);MessageHub.send(new Message.MainPanel.ReOpenEditorTab("/www/components/loader.js",
"/www/components/loader.js"));MessageHub.send(new Message.MainPanel.ReOpenEditorTab("/www/components/loader.css","/www/components/loader.css"));MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_HTML5_PLUGINS))}).fail(function(){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.SETTING_API_FAILED)}).always(function(){b.parentScope.hideMask()})}).fail(function(){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,
Forte.Resources.Text.SETTING_API_FAILED);b.parentScope.hideMask()}))})},configureLoader:function(a){var b=this;b.parentScope.showMask();Forte.API.getHtml5PluginInfo({name:a.name,offline:!0},function(a){b.showFileSettingsDialog(a,!1)}).fail(function(){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,Forte.Resources.Text.SETTING_API_FAILED)}).always(function(){b.parentScope.hideMask()})},showInstallDialog:function(a){var b=this,c=[],e=a.packageName,f=a[e],g='<div style="height: 50px; overflow: auto; padding: 4px 0;">'+
Ext.htmlEncode(f.latest.description||"")+"</div>",h=[];f.versions.forEach(function(a){h.push({name:Ext.htmlEncode(a),value:a})});var j=Ext.create("Ext.data.Store",{data:h,fields:["name","value"]});c.push({html:Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL_COMPONENT,margin:"0 0 10 0"});c.push({html:Ext.htmlEncode(e),cls:"ide-setting-plugin-dialog-title"});c.push({html:g});c.push({store:j,xtype:"cell.combobox",fieldLabel:Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL_SELECT_VERSION,value:f.latest.version,
margin:"5 0 0 0",width:530,labelWidth:250,id:"component-version",editable:!1,displayField:"name",valueField:"value"});var k=Ext.create("Cell.window.LightWindow",{title:Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL_TITLE,cls:"ide-setting-plugin-dialog",closable:!1,component:a,resizable:!1,layout:"vbox",modal:!0,width:600,height:300,defaults:{xtype:"component",style:"margin-bottom: 5px;"},items:c,bbar:[{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){k.close()}},
"->",{xtype:"cell.button",ui:"blue",width:200,text:Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL_START,handler:function(){b.getForm();var a=k.getComponent("component-version").getValue();b.parentScope.showMask();Forte.API.installHtml5Plugin(e,a,function(a){b.parentScope.hideMask();b.searchComponent();b.showFileSettingsDialog(a,!0);MessageHub.send(new Message.MainPanel.ReOpenEditorTab("/www/components/loader.js","/www/components/loader.js"));MessageHub.send(new Message.MainPanel.ReOpenEditorTab("/www/components/loader.css",
"/www/components/loader.css"));MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_HTML5_PLUGINS))}).fail(function(a,b){var c=Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL_FAILED;try{var e=JSON.parse(a.responseText);if(e&&e.reasons&&e.reasons.version&&"Conflict."==e.reasons.version)var b=e.reasons.reason.result,f=b.split("\t")[1],c=Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALL_CONFLICT+f}catch(g){}Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_MONACAIDE,c)}).always(function(){b.parentScope.hideMask()});
k.close()}}]}).show()},showFileSettingsDialog:function(a,b){var c=this,e=[],f={xtype:"form",itemId:"file-dialog-form",cls:"ide-setting-plugin-dialog-form",height:386,items:[]},g;for(g in a)if(a[g].files)if(f.items.push({xtype:"container",layout:"vbox",height:20,items:[{xtype:"component",html:Forte.Resources.Text.SETTING_HTML5_PLUGIN_LOADER_FOR+Ext.htmlEncode(g)}]}),a[g].files.monaca){if(a[g].files.monaca.main){for(var h in a[g].files.monaca.main){var j=a[g].files.monaca.main[h];f.items.push({xtype:"checkboxfield",
inputValue:"1",boxLabel:Ext.htmlEncode(j),packageName:g,checked:!0,hidden:!0});f.items.push({xtype:"displayfield",fieldLabel:Forte.Resources.Text.SETTING_HTML5_PLUGIN_REQUIRED,value:j,htmlEncode:!0,packageName:g})}"monaca-onsenui"==g&&f.items.push({xtype:"component",html:Forte.Resources.Text.SETTING_HTML5_PLUGIN_NOTICE_ONSEN_THEME})}if(a[g].files.monaca.option)for(h in a[g].files.monaca.option)j=a[g].files.monaca.option[h],"undefined"==typeof a[g].files.loaderFiles?f.items.push({xtype:"checkboxfield",
boxLabel:Ext.htmlEncode(j),inputValue:"1",packageName:g,checked:!1}):f.items.push({xtype:"checkboxfield",boxLabel:Ext.htmlEncode(j),inputValue:"1",packageName:g,checked:-1<a[g].files.loaderFiles.jsFiles.indexOf(j)||-1<a[g].files.loaderFiles.cssFiles.indexOf(j)})}else{for(h in a[g].files.allFiles.js)j=a[g].files.allFiles.js[h],"undefined"==typeof a[g].files.loaderFiles?f.items.push({xtype:"checkboxfield",boxLabel:Ext.htmlEncode(j),inputValue:"1",packageName:g,checked:!1}):f.items.push({xtype:"checkboxfield",
boxLabel:Ext.htmlEncode(j),inputValue:"1",packageName:g,checked:-1<a[g].files.loaderFiles.jsFiles.indexOf(j)});for(h in a[g].files.allFiles.css)j=a[g].files.allFiles.css[h],"undefined"==typeof a[g].files.loaderFiles?f.items.push({xtype:"checkboxfield",boxLabel:Ext.htmlEncode(j),inputValue:"1",packageName:g,checked:!1}):f.items.push({xtype:"checkboxfield",boxLabel:Ext.htmlEncode(j),inputValue:"1",packageName:g,checked:-1<a[g].files.loaderFiles.cssFiles.indexOf(j)})}e.push(f);var k=Ext.create("Cell.window.LightWindow",
{title:Forte.Resources.Text.SETTING_HTML5_PLUGIN_LOADER_TITLE,cls:"ide-setting-plugin-dialog",closable:!0,component:h,resizable:!1,layout:"vbox",modal:!0,width:700,height:500,defaults:{xtype:"component",style:"margin-bottom: 5px;"},items:e,bbar:["->",{xtype:"cell.button",ui:"light",width:100,text:b?Forte.Resources.Text.GENERAL_SKIP:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){b&&(Forte.API.skipSetLoader(),Forte.API.listHtml5Plugin(null,function(a){c.setSettings(a);Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_MONACAIDE,
Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALLED);Message.ProjectPanel.UpdateProject.send()}));k.close()}},{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){var a=k.getComponent("file-dialog-form"),b={};for(h in a.items.items)if(a.items.items[h].packageName&&!0===a.items.items[h].getValue()){var e=a.items.items[h].packageName;b[e]=b[e]||[];b[e].push(Ext.htmlDecode(a.items.items[h].boxLabel))}c.parentScope.showMask();Forte.API.setHtml5PluginLoader(b,
function(){k.close();Forte.API.listHtml5Plugin(null,function(a){c.setSettings(a);Message.ProjectPanel.UpdateProject.send();c.parentScope.hideMask();Cell.LightMessageBox.alert(Forte.Resources.Text.GENERAL_MONACAIDE,Forte.Resources.Text.SETTING_HTML5_PLUGIN_INSTALLED);MessageHub.send(new Message.MainPanel.ReOpenEditorTab("/www/components/loader.js","/www/components/loader.js"));MessageHub.send(new Message.MainPanel.ReOpenEditorTab("/www/components/loader.css","/www/components/loader.css"));MessageHub.send(new Message.MainPanel.OpenSettingTab(Forte.Setting.PAGE_HTML5_PLUGINS))})},
function(a,b){Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,b);k.close();c.parentScope.hideMask()})}}]}).show()},setSettings:function(a){var b=[];if(0==a.length)b.push([{xtype:"container",height:70,layout:"vbox",items:[{xtype:"component",html:Forte.Resources.Text.SETTING_HTML5_PLUGIN_NOT_INSTALLED_TEXT,padding:15}]}]);else for(var c in a)b.push(this.makeHtml5PluginPanel(c,a[c]));this.getComponent("plugins-cont").removeAll();this.getComponent("plugins-cont").add(b)}})})();(function(){Ext.define("Forte.Setting.Chrome.PermissionModel",{extend:"Ext.data.Model",fields:[{name:"text",type:"string"},{name:"permissionType",type:"string"}]});Ext.define("Forte.Setting.Chrome",{extend:"Cell.SettingPanel",id:"setting:chrome",settings:null,fieldDefaults:{labelWidth:240,msgTarget:"under"},listeners:{show:function(a){a.setSettings(a.settings)}},initComponent:function(){var a=this,b=a.parentScope;Ext.apply(a,{items:[{xtype:"component",cls:"cell-title",html:Forte.Resources.Text.SETTING_CHROME_TITLE,
style:"margin-bottom: 20px;"},{title:Forte.Resources.Text.SETTING_CHROME_APP_TITLE,defaults:{xtype:"cell.textfield",allowBlank:!1,maxLength:256,validateOnChange:!1,validateOnBlur:!1},items:[{itemId:"full_name_chrome",name:"full_name_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_APP_NAME,helpMsg:Forte.Resources.Text.SETTING_CHROME_APP_NAME_HELP,size:40},{itemId:"short_name_chrome",name:"short_name_chrome",allowBlank:!0,fieldLabel:Forte.Resources.Text.SETTING_CHROME_APP_SHORT_NAME,helpMsg:Forte.Resources.Text.SETTING_CHROME_APP_SHORT_NAME_HELP,
size:20},{xtype:"cell.textarea",itemId:"description_chrome",name:"description_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_APP_DESCRIPTION,helpMsg:Forte.Resources.Text.SETTING_CHROME_APP_DESCRIPTION_HELP,rows:4,cols:52},{itemId:"version_chrome",name:"version_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_APP_VERSION,size:15},{xtype:"cell.checkbox",itemId:"offline_chrome",name:"offline_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_OFFLINE,helpMsg:Forte.Resources.Text.SETTING_CHROME_OFFLINE_HELP,
size:15},{xtype:"cell.textarea",itemId:"access_origin_chrome",name:"access_origin_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_PERMIT_URL,helpMsg:Forte.Resources.Text.SETTING_CHROME_PERMIT_URL_HELP,allowBlank:!0,rows:4,cols:46,validator:function(a){for(var a=a.split("\n"),b=0;b<a.length;b++)if(""!==a[b]&&-1===a[b].indexOf("//")&&"<all_urls>"!==a[b])return Forte.Resources.Text.SETTING_CHROME_PERMIT_URL_ERROR(b+1);return!0}}]},{title:Forte.Resources.Text.SETTING_CHROME_ICON_TITLE,layout:"absolute",
height:210,defaults:{xtype:"component",width:200},items:[b.makePreviewComponent(b,"icon_chrome_128",{x:0,y:0,width:128,height:128}),a.makeImgChangeBtn("icon_chrome_128","128x128",133,81),{html:Forte.Resources.Text.SETTING_WINRT_IMAGE_DESCRIPTION,cls:"cell-annotation",x:0,y:135,width:600}]},{title:Forte.Resources.Text.SETTING_CHROME_PERMISSION_TITLE,html:Forte.Resources.Text.SETTING_CHROME_PERMISSION_HELP,layout:"hbox",maxWidth:700,defaults:{xtype:"grid",cls:"ide-setting-chrome-permgrid",hideHeaders:!0,
multiSelect:!0,width:240,height:300},items:[{itemId:"permission-available",columns:[{dataIndex:"text",width:198}],draggable:!1,store:a.initPermissionStore(!0),title:Forte.Resources.Text.SETTING_CHROME_PERMISSION_AVAILABLE},{xtype:"container",width:60,layout:{type:"vbox",align:"center",pack:"center"},items:[{xtype:"button",text:"&gt;",style:"margin-bottom:10px;",width:30,handler:function(){var b=a.down("#permission-available"),e=b.getSelectionModel().getSelection();a.down("#permission-enabled").getStore().add(e);
b.getStore().remove(e)}},{xtype:"button",text:"&lt;",width:30,handler:function(){var b=a.down("#permission-enabled"),e=b.getSelectionModel().getSelection();a.down("#permission-available").getStore().add(e);b.getStore().remove(e)}}]},{itemId:"permission-enabled",columns:[{dataIndex:"text",width:198}],draggable:!1,store:a.initPermissionStore(!1),title:Forte.Resources.Text.SETTING_CHROME_PERMISSION_ENABLED}]},{title:Forte.Resources.Text.SETTING_CHROME_PERMISSION_OPTIONAL_TITLE,html:Forte.Resources.Text.SETTING_CHROME_PERMISSION_OPTIONAL_HELP,
layout:"hbox",maxWidth:700,defaults:{xtype:"grid",cls:"ide-setting-chrome-permgrid",hideHeaders:!0,multiSelect:!0,width:240,height:300},items:[{itemId:"permission-optional-available",columns:[{dataIndex:"text",width:198}],draggable:!1,store:a.initPermissionStore(!0),title:Forte.Resources.Text.SETTING_CHROME_PERMISSION_AVAILABLE},{xtype:"container",width:60,layout:{type:"vbox",align:"center",pack:"center"},items:[{xtype:"button",text:"&gt;",style:"margin-bottom:10px;",width:30,handler:function(){var b=
a.down("#permission-optional-available"),e=b.getSelectionModel().getSelection();a.down("#permission-optional-enabled").getStore().add(e);b.getStore().remove(e)}},{xtype:"button",text:"&lt;",width:30,handler:function(){var b=a.down("#permission-optional-enabled"),e=b.getSelectionModel().getSelection();a.down("#permission-optional-available").getStore().add(e);b.getStore().remove(e)}}]},{itemId:"permission-optional-enabled",columns:[{dataIndex:"text",width:198}],draggable:!1,store:a.initPermissionStore(!1),
title:Forte.Resources.Text.SETTING_CHROME_PERMISSION_ENABLED}]},{title:Forte.Resources.Text.SETTING_CHROME_EXTERNALLY_TITLE,height:250,items:[{xtype:"cell.textarea",itemId:"externally_connectable_domain_chrome",name:"externally_connectable_domain_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_EXTERNALLY_DOMAINS,helpMsg:Forte.Resources.Text.SETTING_CHROME_EXTERNALLY_HOSTS_HELP,rows:4,cols:46},{xtype:"cell.textarea",itemId:"externally_connectable_apps_chrome",name:"externally_connectable_apps_chrome",
fieldLabel:Forte.Resources.Text.SETTING_CHROME_EXTERNALLY_APPS,helpMsg:Forte.Resources.Text.SETTING_CHROME_EXTERNALLY_APPS_HELP,rows:4,cols:46},{xtype:"cell.checkbox",itemId:"externally_connectable_use_tls_chrome",name:"externally_connectable_use_tls_chrome",fieldLabel:Forte.Resources.Text.SETTING_CHROME_EXTERNALLY_USE_TLS,size:15}]}],bbar:["->",{xtype:"cell.button",ui:"blue",text:Forte.Resources.Text.GENERAL_SAVE,minWidth:100,handler:function(){var c=a.getForm();if(c.isValid()){var e={};e.chrome=
c.getValues();e.chrome.permissions=[];e.chrome.host_permissions=[];a.down("#permission-enabled").getStore().getRange().forEach(function(a){e.chrome.permissions.push(String(a.data.value))});e.chrome.access_origin_chrome&&(e.chrome.host_permissions=e.chrome.access_origin_chrome.split("\n"));e.chrome.optional_permissions=[];a.down("#permission-optional-enabled").getStore().getRange().forEach(function(a){e.chrome.optional_permissions.push(String(a.data.value))});b.showMask();Forte.API.saveProjectSetting(e,
function(){Forte.API.readProjectSetting(function(c){a.settings=c;b.hideMask();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_SETTING_SAVE,type:"report"})).send();isChromeAppInstalled()&&chrome.runtime.sendMessage(Forte.API.chromeAppId,{action:"reload",projectId:Forte.API.projectId,filepath:["/platforms/chrome/manifest.json"]})},function(a,c){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:c,buttons:1,minWidth:480,noEscape:true})})},function(a,
c){b.hideMask();Cell.LightMessageBox.alert({title:Forte.Resources.Text.ERROR_GENERAL_MONACA_TITLE,msg:c,buttons:1,minWidth:480,noEscape:true})})}else Cell.LightMessageBox.alert(Forte.Resources.Text.ERROR_SAVE_SETTING_TITLE,Forte.Resources.Text.ERROR_SAVE_SETTING_INVALID_TEXT)}}]});a.callParent()},setSettings:function(a){var b=a.manifest.chrome;this.down("#full_name_chrome").setValue(b.name?b.name:"");this.down("#short_name_chrome").setValue(b.short_name?b.short_name:"");this.down("#description_chrome").setValue(b.description?
b.description:"");this.down("#version_chrome").setValue(b.version?b.version:"");this.down("#offline_chrome").setValue(b.offline_enabled?b.offline_enabled:"");this.down("#access_origin_chrome").setValue(b.parsed.host_permissions?b.parsed.host_permissions:"");this.down("#externally_connectable_domain_chrome").setValue(b.parsed.externally_connectable.domain?b.parsed.externally_connectable.domain:"");this.down("#externally_connectable_apps_chrome").setValue(b.parsed.externally_connectable.apps?b.parsed.externally_connectable.apps:
"");this.down("#externally_connectable_use_tls_chrome").setValue(b.parsed.externally_connectable.use_tls?b.parsed.externally_connectable.use_tls:"");if(b.parsed.permissions)for(var c=this.down("#permission-available"),c=c.getStore(),e=this.down("#permission-enabled"),e=e.getStore(),f=0;f<b.parsed.permissions.length;f++){var g=c.findRecord("value",b.parsed.permissions[f]);g&&(e.add(g),c.remove(g))}if(b.parsed.optional_permissions){c=this.down("#permission-optional-available");c=c.getStore();e=this.down("#permission-optional-enabled");
e=e.getStore();for(f=0;f<b.parsed.optional_permissions.length;f++)if(g=c.findRecord("value",b.parsed.optional_permissions[f]))e.add(g),c.remove(g)}$("> .x-panel-body",this.el.dom).scrollTop(0);this.settings=a},makeImgChangeBtn:function(a,b,c,e){var f=this.parent;return{xtype:"filefield",name:a,x:c,y:e,buttonOnly:!0,buttonText:Forte.Resources.Text.GENERAL_CHANGE+"...",fieldLabel:b,labelAlign:"top",labelWidth:80,width:180,listeners:{change:function(b,c){f.onUploadFileImgBtn(this,b,c,"chrome",a)}}}},
initPermissionStore:function(a){var b=[{text:"Allow Fullscreen",value:"fullscreen"},{text:"Allow webkitRequestPointerLock",value:"pointerLock"},{text:"Capture Audio (getUserMedia)",value:"audioCapture"},{text:"Capture Video (getUserMedia)",value:"videoCapture"},{text:"chrome.alarms API",value:"alarms"},{text:"chrome.app.runtime API",value:"app.runtime"},{text:"chrome.app.window API",value:"app.window"},{text:"chrome.contextMenus API",value:"contextMenus"},{text:"chrome.experimental.* API",value:"experimental"},
{text:"chrome.fileSystem API",value:"fileSystem"},{text:"chrome.identity API",value:"identity"},{text:"chrome.idle API",value:"idle"},{text:"chrome.notifications API",value:"notifications"},{text:"chrome.power API",value:"power"},{text:"chrome.pushMessaging API",value:"pushMessaging"},{text:"chrome.serial API",value:"serial"},{text:"chrome.socket API",value:"socket"},{text:"chrome.storage API",value:"storage"},{text:"chrome.system.display API",value:"system.display"},{text:"chrome.system.storage API",
value:"system.storage"},{text:"chrome.usb API",value:"usb"},{text:"Clipboard (Read)",value:"clipboardRead"},{text:"Clipboard (Write)",value:"clipboardWrite"},{text:"HTML5 geolocation API",value:"geolocation"},{text:"Unlimited Local Storage",value:"unlimitedStorage"}];return{autoLoad:!0,fields:[{name:"text",type:"string"},{name:"value",type:"string"}],proxy:{type:"memory",data:a?b:[]}}}})})();(function(){Ext.define("Forte.Setting.Integration",{extend:"Cell.SettingPanel",settings:null,contentWindow:null,initComponent:function(){var a=this,b=a.parent;Ext.apply(a,{items:[{xtype:"component",layout:"fit",html:'<iframe src="/page/serviceIntegration" class="cell-iframe-tab-content" frameborder="0"></iframe>',height:"100%",listeners:{afterRender:function(){setIframeMaskHandler();a.contentWindow=this.el.dom.getElementsByTagName("iframe")[0].contentWindow;a.contentWindow.settingsPanel=b}}}]});a.callParent()},
setSettings:function(a){this.settings=a}})})();(function(){Ext.define("Forte.Settings.Keymap",{extend:"Ext.Base",singleton:!0,keymap:null,keymapIframes:[],keymapList:[],initKeymap:function(){var a="mac"===detectWinMac();this.keymap=new Forte.Settings.KeyMap.Base(document,[{}]);this.createKeymapConfig(219,function(){Message.MainPanel.MoveTabLeft.send()},!0,!1);this.createKeymapConfig(221,function(){Message.MainPanel.MoveTabRight.send()},!0,!1);this.createKeymapConfig(Ext.EventObject.F,function(){Message.HeaderToolbar.FocusSearchBox.send()},!0,
!1);this.createKeymapConfig(Ext.EventObject.Q,function(){(new Message.MainPanel.RemoveTabByFilepath).send()},!0,!1);this.createKeymapConfig(Ext.EventObject.ONE,function(){var a=Ext.getCmp("component:projectpanel-wrap");a.collapsed?(a.expand(),a.setActiveTab(Forte.ProjectPanel.PAGE_TREE)):"component:projectpanel"===a.getActiveTab().id?a.collapse():a.setActiveTab(Forte.ProjectPanel.PAGE_TREE);Ext.getCmp("component:root").fireEvent("resize")},!0,!0);this.createKeymapConfig(Ext.EventObject.TWO,function(){Message.HeaderToolbar.MaximizePanel.send()},
!0,!0);this.createKeymapConfig(a?Ext.EventObject.FIVE:Ext.EventObject.THREE,function(){var a=Ext.getCmp("component:projectpanel-wrap");a.collapsed?(a.expand(),a.setActiveTab(Forte.ProjectPanel.PAGE_GREP)):"component:greppanel"===a.getActiveTab().id?a.collapse():a.setActiveTab(Forte.ProjectPanel.PAGE_GREP);Ext.getCmp("component:root").fireEvent("resize")},!0,!0);this.createKeymapConfig(a?Ext.EventObject.SIX:Ext.EventObject.FOUR,function(){var a=Ext.getCmp("component:projectpanel-wrap");a.collapsed?
(a.expand(),a.setActiveTab(Forte.ProjectPanel.PAGE_BACKEND)):"component:cloudpanel"===a.getActiveTab().id?a.collapse():a.setActiveTab(Forte.ProjectPanel.PAGE_BACKEND);Ext.getCmp("component:root").fireEvent("resize")},!0,!0);this.createKeymapConfig(a?Ext.EventObject.EIGHT:Ext.EventObject.FIVE,function(){Ext.getCmp("component:previewpanel").onPreviewBtn()},!0,!0);this.createKeymapConfig(Ext.EventObject.S,function(){var a=Ext.getCmp("component:mainpanel").getActiveTab();if(a)a.onSaveFile()},!0,!1);for(a=
0;a<this.keymapList.length;a++)this.keymap.addBinding(this.keymapList[a])},createKeymapConfig:function(a,b,c,e){this.keymapList.push({key:a,fn:b,ctrl:c,shift:e,scope:this,defaultEventAction:"preventDefault"})}});Ext.define("Forte.Settings.KeyMap.Base",{constructor:function(a,b,c){Ext.apply(this,{el:Ext.get(a),eventName:c||this.eventName,bindings:[]});b&&this.addBinding(b);this.enable()},eventName:"keydown",addBinding:function(a){if(Ext.isArray(a))Ext.each(a,this.addBinding,this);else{var b=a.key,
c=!1,e,f;if(Ext.isString(b)){e=[];b=b.toUpperCase();c=0;for(f=b.length;c<f;++c)e.push(b.charCodeAt(c));b=e;c=!0}Ext.isArray(b)||(b=[b]);if(!c){c=0;for(f=b.length;c<f;++c)e=b[c],Ext.isString(e)&&(b[c]=e.toUpperCase().charCodeAt(0))}this.bindings.push(Ext.apply({keyCode:b},a))}},handleKeyDown:function(a){if(this.enabled)for(var b=this.bindings,c=0,e=b.length,a=this.processEvent(a);c<e;++c)this.processBinding(b[c],a);return!1},processEvent:function(a){return a},processBinding:function(a,b){if(this.checkModifiers(a,
b)){var c=b.getKey(),e=a.fn||a.handler,f=a.scope||this,g=a.keyCode,h=a.defaultEventAction,j,k,m=new Ext.EventObjectImpl(b);j=0;for(k=g.length;j<k;++j)if(c===g[j]){if(!0!==e.call(f,c,b)&&h)m[h]();break}}},checkModifiers:function(a,b){for(var c=["shift","ctrl","alt"],e=0,f=c.length,g,h;e<f;++e)if(h=c[e],g=a[h],!(void 0===g||g===b[h+"Key"]))return!1;return!0},on:function(a,b,c){var e,f,g,h;Ext.isObject(a)&&!Ext.isArray(a)?(e=a.key,f=a.shift,g=a.ctrl,h=a.alt):e=a;this.addBinding({key:e,shift:f,ctrl:g,
alt:h,fn:b,scope:c})},isEnabled:function(){return this.enabled},enable:function(){this.enabled||(this.el.on(this.eventName,this.handleKeyDown,this),this.enabled=!0)},disable:function(){this.enabled&&(this.el.removeListener(this.eventName,this.handleKeyDown,this),this.enabled=!1)},setDisabled:function(a){a?this.disable():this.enable()},destroy:function(a){this.bindings=[];this.disable();!0===a&&this.el.remove();delete this.el}})})();(function(){Ext.define("Forte.PreviewPanel.PreviewPanel",{extend:"Ext.panel.Panel",alias:"widget.previewpanel.previewpanel",forcedCollapse:!1,previewBodyWidth:350,previewWindow:null,isHiddenAttach:!1,isHiddenMode:!1,initComponent:function(){var a=this;a.lang=window.LANG;Ext.apply(a,{id:"component:previewpanel",region:"east",split:!0,width:a.previewBodyWidth,minWidth:280,hidden:!0,baseCls:"cell-preview-panel",listeners:{show:function(){Ext.getCmp("component:root").fireEvent("resize")},hide:function(){Ext.getCmp("component:root").fireEvent("resize")},
afterrender:function(){$('<div class="ide-iframemask ide-preview-iframemask" />').appendTo("body");setIframeMaskHandler()},resize:function(b,c){0!=c&&a.previewBodyWidth!=c&&(a.previewBodyWidth=c);Ext.getCmp("component:root").fireEvent("resize")}},items:[{xtype:"component",border:!1,style:"height: 100%;",html:'<iframe id="ide-preview-iframe" src="" style="width: 100%; height: 100%; transform-origin: 0 0; -webkit-transform-origin: 0 0;"></iframe>'}]});a.callParent();$(window).unload(function(){a.previewWindow&&
!a.previewWindow.closed&&a.previewWindow.close()});MessageHub.subscribe(Message.InfoPanel.forceCollapse,function(){a.forceCollapse()});MessageHub.subscribe(Message.InfoPanel.freeCollapse,function(){a.freeCollapse()})},getFrame:function(){return $("#ide-preview-iframe")},showContent:function(){var a=this;a.show();setTimeout(function(){a.getFrame().attr("src",Forte.API.previewWindowUrl+"?is_attach=1")},0)},showPanel:function(){this.isHiddenMode||(this.previewWindow&&this.previewWindow.opener?(this.hide(),
this.isHiddenAttach=!0,this.previewWindow.focus(),Forte.API.sendEventToGA("menu-preview","to-front")):(this.show(),this.isHiddenAttach=!1,this.isLoadedProject()||this.showContent()))},forceCollapse:function(){if(!this.hidden||this.forceCollapsed)this.forcedCollapse=!0,this.hide()},freeCollapse:function(){this.forcedCollapse&&(this.forcedCollapse=!1,this.show())},isLoadedProject:function(){return!!$("#ide-preview-iframe").attr("src")},hideContent:function(){this.getFrame().attr("src","");this.hide()},
onPreviewBtn:function(){this.isHiddenMode=!this.isHiddenMode;Ext.getCmp("component:previewpanel").hidden?(this.show(),this.showContent(),Ext.getCmp("component:root").fireEvent("resize")):(this.hide(),Forte.API.sendEventToGA("menu-preview","collapse"))},onAttachBtn:function(){this.showContent();this.previewWindow.close();Ext.getCmp("ToolbarPreviewBtn").addCls("selected");Ext.getCmp("mainpanel-collapse-preview").show();Forte.API.sendEventToGA("menu-preview","expand")},onDetachBtn:function(){this.hideContent();
var a={width:640,height:480,left:100,top:100,status:"no",location:"no",scrollbars:"no",toolbar:"no",personalbar:"no",menubar:"no"},b=[],c;for(c in a)b.push(c+"="+a[c]);this.previewWindow=window.open(Forte.API.previewWindowUrl,"monaca_preview_window",b.join(","));Forte.API.sendEventToGA("menu-preview","open");Ext.getCmp("mainpanel-collapse-preview").hide()}})})();(function(){Ext.define("Forte.MarkdownEditor",{extend:"Forte.AceEditor",alias:"widget.markdowneditor",mdPanel:null,mdToolbar:null,autoScroll:!1,createMdPanel:function(){this.mdToolbar=Ext.create("Ext.toolbar.Toolbar",{dock:"top",cls:"cell-panel-markdown-toolbar",height:30,style:{background:"none",backgroundColor:"white"},items:[{xtype:"container",cls:"cell-panel-markdown-comment",html:Forte.Resources.Text.EDITOR_MARKDOWN_TITLE,style:{top:8,right:70},width:200},{xtype:"cell.button",cls:"cell-panel-markdown-btn",
style:{top:5,right:5},text:Forte.Resources.Text.EDITOR_MARKDOWN_BUTTON_TITLE,ui:"mini",handler:function(){var a=this.up("markdowneditor");a.mdPanel.hide();a.removeDocked(a.mdToolbar,!1);a.doLayout();Ext.getDom(a.filepath+"_ace").style.display="inline";a.aceEditor.resize()}}]});this.addDocked(this.mdToolbar);this.doLayout();this.mdPanel=Ext.create("Ext.panel.Panel",{cls:"cell-panel-markdown-content",autoScroll:!0});this.add(this.mdPanel)}});Forte.MarkdownEditor.override({fetchContents:function(){var a=
this,b=$.Deferred(),c=$.Deferred();$.when(Forte.API.read(a.filepath,function(a){a&&a.content?b.resolve(a):b.reject()},function(b,c){a.onFetchContentsFail(b,c)}),Forte.API.read(a.filepath,function(a){a&&a.content?c.resolve(a):b.reject()},function(b,c){a.onFetchContentsFail(b,c)},{requestContentType:"text/html"})).then(function(b,c){a.callbackReadAPI({content:b[0]},{content:c[0]})})},callbackReadAPI:function(a,b){this.edited=!1;Ext.core.DomHelper.append(this.mdPanel.body.id,b.content,!1);Ext.getDom(this.filepath+
"_ace").style.display="none";this.callOverridden(arguments)}})})();Forte.WebSocketHandler={webSocket:null,errorHandler:null,getEndpointUrl:function(a){var b=window.location.host.replace("ide.",""),c="wss";"monaca.mobi"!=b&&/local$/.test(b)&&(c="ws");return c+"://ws."+b+"/ide/subscribe/"+a},connect:function(a){var b=this;try{b.webSocket=new WebSocket(this.getEndpointUrl(a))}catch(c){console.error(c.message);return}b.webSocket.onmessage=function(a){b.onMessage(a)};b.webSocket.onerror=function(a){b.onError(a)};b.webSocket.onclose=function(){setTimeout(function(){b.connect(a)},
1E4)}},onMessage:function(a){frame=JSON.parse(a.data);"debug.onLog"!==frame.method||frame.data.project_id!==Forte.API.projectId||(obj=frame.data,Ext.each(obj.content,function(a){var c,e=a.message;switch(a.type.toLowerCase()){case "debug":case "verbose":c=0;break;case "log":case "info":c=1;break;case "warning":c=2;break;case "error":c=3;break;case "content_loaded":return;default:c=1}e={url:"",source:3,type:0,level:c,message:e.toString(),parameters:[{type:typeof e,description:e,hasChildren:!1}]};a.url&&
0<a.url.length&&(e.url=a.url);a.line&&0<a.line?e.line=a.line+" "+obj.device_name:e.url=e.url+" "+obj.device_name;data={command:"weinre",deviceId:obj.device_id,deviceName:obj.device_name,message:{"interface":"ConsoleNotify",method:"addConsoleMessage",args:[e]}};Forte.API.sendToInspector(data)}))},onError:function(a){this.errorHandler&&this.errorHandler(a)},setErrorHandler:function(a){this.errorHandler=a}};
