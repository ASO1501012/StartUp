(function(){Ext.define("Forte.Widgets.UploadWindow",{extend:"Cell.window.DarkWindow",alias:"widget.widgets.uploadwindow",callbackFunc:function(){},uploadQueue:[],doUploading:!1,hiddenUpload:!1,listeners:{show:function(a){a.getComponent("droparea").setUploadPath(a.path)},destroy:function(){Forte.Widgets.UploadWindow.isShowing=!1}},initComponent:function(){var a=this,b=a.getDirsFromTree(Forte.API.treeCache,"/"),c=[],d;for(d in b){var f=b[d];!a.isPluginDirName(f)&&!a.isPlatformDirName(f)&&c.push([f,
f])}c.push(["/","/"]);b=Ext.create("Ext.data.ArrayStore",{fields:["text","value"],data:c});Ext.apply(a,{id:"window:upload",cls:"cell-upload-window",title:Forte.Resources.Text.WIDGETS_UPLOAD_TITLE,closable:!0,closeAction:"destroy",modal:!1,width:300,height:265,items:[{xtype:"cell.combobox",itemId:"UploadDirSelectCombo",cls:"forte-upload-dialog-dir",width:180,ui:"mini",allowBlank:!1,editable:!1,queryMode:"local",valueField:"value",displayField:"text",forceSelection:!0,value:"/www/",store:b,listConfig:{cls:"cell-boundlist-uploader"},
listeners:{select:function(b,c){a.path=c[0].data.value;a.getComponent("droparea").setUploadPath(a.path)}}},{xtype:"cell.droparea",itemId:"droparea",cls:"forte-upload-dialog-droparea",height:140},{xtype:"filefield",itemId:"filefield",ui:"dark",cls:"forte-upload-dialog-select",width:220,height:35,fieldLabel:Forte.Resources.Text.WIDGETS_UPLOAD_OR,labelAlign:"left",labelSeparator:"",labelWidth:80,buttonOnly:!0,buttonText:Forte.Resources.Text.WIDGETS_UPLOAD_SELECT_FILE,listeners:{afterrender:function(b){$(b.fileInputEl.dom).change(function(b){a.onFileFieldChange(a,
b)})}}}]});MessageHub.subscribe(Message.Tree.SelectNode,function(b){if(!a.isPluginDirName(b.getDirName())&&!a.isPlatformDirName(b.getDirName())){var c=a.getComponent("UploadDirSelectCombo");"undefined"!=typeof c&&(b=b.getDirName(),0<=c.store.findExact("value",b)&&(c.select(b),a.path=b,a.getComponent("droparea").setUploadPath(b)))}});MessageHub.subscribe(Message.ProjectPanel.DirectoryCreated,function(){a.reloadDir()});a.callParent()},reloadDir:function(){var a=this.getDirsFromTree(Forte.API.treeCache,
"/"),b=[],c=this.getComponent("UploadDirSelectCombo"),d;for(d in a)!this.isPluginDirName(a[d])&&!this.isPlatformDirName(a[d])&&b.push({text:a[d],value:a[d]});c.store.removeAll();c.store.add(b);c.select("/www/");this.path="/www/";this.getComponent("droparea").setUploadPath("/www/")},onFileFieldChange:function(a,b){b.currentTarget.files.length&&Forte.API.uploads(a.path,b.currentTarget.files[0],null,function(){Message.ProjectPanel.UpdateProject.send();(new Message.Notify({message:Forte.Resources.Text.NOTIFY_UPLOAD_FILE,
type:"report"})).send();var b=a.getComponent("filefield");b.reset();$(b.fileInputEl.dom).change(function(b){a.onFileFieldChange(a,b)})})},getDirsFromTree:function(a){var b=[],c;for(c in a)"dir"!==a[c].type||a[c].deleted||this.isPlatformDirName(c)||b.push(c+"/");return b},isPluginDirName:function(a){return 0==a.indexOf("/www/plugins/")},isPlatformDirName:function(a){return 0===a.indexOf("/android")||0===a.indexOf("/ios")||0===a.indexOf("/chrome")},statics:{showWindow:function(a,b,c){if(!Forte.Widgets.UploadWindow.isShowing){Forte.Widgets.UploadWindow.isShowing=
!0;var d=new Forte.Widgets.UploadWindow;if(d.isPluginDirName(a)||d.isPlatformDirName(a))a="/www/";d.path=a;d.callbackFunc=b;d.getComponent("UploadDirSelectCombo").select(a);c?d.hiddenUpload=!0:d.show()}},isShowing:null}})})();(function(){Ext.define("Forte.Widgets.NewFileWindow",{extend:"Cell.window.LightWindow",alias:"widget.widgets.newfilewindow",id:"window:newfile",closable:!0,closeAction:"destroy",cls:"cell-newfile-window",title:Forte.Resources.Text.PAGES_NEW_MESSAGEBOX_TITLE,modal:!0,width:664,height:442,layout:"hbox",dir:"",template:"",filetype:"html",filetypeStore:Ext.create("Ext.data.ArrayStore",{fields:["text","value","ext"],data:[["HTML","html","html"],["CSS","css","css"],["JavaScript","js","js"],[Forte.Resources.Text.PAGES_NEW_MESSAGEBOX_FILETYPE_OTHERS,
"others"]]}),templateStore:Ext.create("Ext.data.ArrayStore",{fields:["text","value","filetype","description","previewurl"],data:[["Blank Template","","html",Forte.Resources.Text.NEW_TEMPLATE_BLANK,""],["Onsen Page","onsen_page","html",Forte.Resources.Text.NEW_TEMPLATE_PAGE,""],["Onsen Tab View","onsen_tabview","html",Forte.Resources.Text.NEW_TEMPLATE_TABVIEW,"https://monaca.github.io/project-templates/9-ons-tab-nav/www/index.html"],["Onsen Checkbox","onsen_checkbox","html",Forte.Resources.Text.NEW_TEMPLATE_CHECKBOX,
"https://onsen.io/patterns/checkbox_list.html"],["Onsen Compose","onsen_compose","html",Forte.Resources.Text.NEW_TEMPLATE_COMPOSE,"https://onsen.io/patterns/compose.html"],["Onsen Detail","onsen_detail","html",Forte.Resources.Text.NEW_TEMPLATE_DETAIL,"https://onsen.io/patterns/details.html"],["Onsen List Icons","onsen_list_icons","html",Forte.Resources.Text.NEW_TEMPLATE_ICONS,"https://onsen.io/patterns/list_icons.html"],["Onsen List Thumbnails","onsen_list_thumbnails","html",Forte.Resources.Text.NEW_TEMPLATE_THUMBNAILS,
"https://onsen.io/patterns/list_thumbnails.html"],["Onsen Login","onsen_login","html",Forte.Resources.Text.NEW_TEMPLATE_LOGIN,"https://onsen.io/patterns/login.html"],["Onsen People","onsen_people","html",Forte.Resources.Text.NEW_TEMPLATE_PEOPLE,"https://onsen.io/patterns/people.html"],["Onsen Settings","onsen_settings","html",Forte.Resources.Text.NEW_TEMPLATE_SETTINGS,"https://onsen.io/patterns/settings.html"],["Onsen Timeline","onsen_timeline","html",Forte.Resources.Text.NEW_TEMPLATE_TIMELINE,"https://onsen.io/patterns/timeline.html"]]}),
onSuccess:function(){},initComponent:function(){var a=this;Ext.apply(this,{items:[{xtype:"form",itemId:"form",layout:"vbox",height:392,listeners:{fieldvaliditychange:function(){this.ownerCt.down("#ok").setDisabled(this.form.isValid()?!1:!0)}},items:[{xtype:"container",layout:{type:"hbox",align:"middle"},width:360,height:46,items:[{xtype:"component",html:Forte.Resources.Text.PAGES_NEW_MESSAGEBOX_TEXT,width:100},{xtype:"component",itemId:"directory",style:"margin-right: 6px;"},{xtype:"textfield",itemId:"filename",
value:"",allowBlank:!1,flex:1,listeners:{change:function(b){var b=b.getValue(),c=b.lastIndexOf(".");if(!(0>c))switch(b.substr(c+1)){case "htm":case "html":a.setFiletype.apply(a,["html"]);break;case "css":a.setFiletype.apply(a,["css"]);break;case "js":a.setFiletype.apply(a,["js"]);break;default:a.setFiletype.apply(a,["others"])}}}}]},{xtype:"cell.combobox",itemId:"filetype",cls:"cell-combobox newfile-filetype",width:360,allowBlank:!0,editable:!1,fieldLabel:Forte.Resources.Text.PAGES_NEW_MESSAGEBOX_FILETYPE,
labelWidth:100,queryMode:"local",valueField:"value",displayField:"text",forceSelection:!0,value:"others",store:this.filetypeStore,listeners:{select:function(b,c){var d=c[0].data.value;a.setFiletype.apply(a,[d]);"others"!==d&&a.setExtension.apply(a,[d])}}},{xtype:"cell.combobox",itemId:"template",width:360,allowBlank:!0,disabled:!0,editable:!1,fieldLabel:Forte.Resources.Text.PAGES_NEW_MESSAGEBOX_TEMPLATE,labelWidth:100,queryMode:"local",valueField:"value",displayField:"text",forceSelection:!0,lastQuery:"",
store:this.templateStore,style:"margin-top: 14px;",listeners:{select:function(b,c){a.template=c[0].data.value;a.down("#description").update(c[0].data.description);var d=c[0].data.previewurl?"<iframe width='240' height='390' src='"+c[0].data.previewurl+"' />":"<div class='newfile-preview-empty'>No Preview</div>";a.down("#preview").update(d)}}},{xtype:"component",itemId:"description",html:""}]},{xtype:"component",itemId:"preview",cls:"newfile-preview",width:242,height:392,disabled:!0,html:"<div class='newfile-preview-empty'>No Preview</div>"}],
bbar:["->",{xtype:"cell.button",ui:"light",text:Forte.Resources.Text.GENERAL_CANCEL,scope:this,width:100,handler:function(){this.close()}},{xtype:"cell.button",itemId:"ok",ui:"light",text:Forte.Resources.Text.GENERAL_OK,scope:this,width:100,handler:function(){this.down("#form").getForm().isValid()&&(this.onSuccess(this.down("#template").getValue(),this.down("#filename").getValue()),this.close())}}]});this.callParent()},listeners:{show:function(){var a=this.dir;16<a.length&&(a=a.substr(0,8)+"..."+
a.substr(-8));this.down("#directory").update(a)}},setExtension:function(a){var b=this.down("#filename");b.setValue(b.getValue().replace(/\.[^\.]+$/,"."+a))},setFiletype:function(a){this.filetype=a;this.down("#filetype").setValue(a);a=this.down("#template");a.store.clearFilter();a.store.filter("filetype",this.filetype);var b=a.store.getAt(0);b?(a.select(""!==this.template?this.template:b),a.enable(),this.down("#description").update(b.get("description"))):(a.clearValue(),a.disable(),this.down("#description").update(""));
this.down("#filename");switch(this.filetype){case "html":this.down("#preview").enable();break;case "css":this.down("#preview").disable();break;case "js":this.down("#preview").disable();break;default:this.down("#preview").disable()}},statics:{showWindow:function(a,b){var c=new Forte.Widgets.NewFileWindow;c.onSuccess=b;c.dir=a;c.show()}}})})();Ext.define("Forte.Widgets.MessageBox",{extend:"Ext.window.Window",requires:"Ext.toolbar.Toolbar Ext.form.field.Text Ext.form.field.TextArea Ext.button.Button Ext.layout.container.Anchor Ext.layout.container.HBox Ext.ProgressBar".split(" "),alias:"widget.widgets.messagebox",OK:1,YES:2,NO:4,CANCEL:8,OKCANCEL:9,YESNO:6,YESNOCANCEL:14,INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",hideMode:"offsets",closeAction:"hide",resizable:!0,title:"&#160;",width:600,
height:500,minWidth:500,maxWidth:600,minHeight:200,maxHeight:600,constrain:!0,cls:Ext.baseCSSPrefix+"message-box",layout:{type:"anchor"},defaultTextHeight:75,minProgressWidth:250,minPromptWidth:600,buttonText:{ok:Forte.Resources.Text.GENERAL_OK,yes:Forte.Resources.Text.GENERAL_YES,no:Forte.Resources.Text.GENERAL_NO,cancel:Forte.Resources.Text.GENERAL_CANCEL},buttonIds:["ok","yes","no","cancel"],titleText:{confirm:"Confirm",prompt:"Prompt",wait:"Loading...",alert:"Attention"},iconHeight:35,makeButton:function(a){a=
this.buttonIds[a];return"ok"==a||"yes"==a?Ext.create("Forte.Widgets.Button.Highlight",{handler:this.btnCallback,itemId:a,scope:this,text:this.buttonText[a],minWidth:75}):Ext.create("Ext.button.Button",{handler:this.btnCallback,itemId:a,scope:this,text:this.buttonText[a],minWidth:75})},btnCallback:function(a){var b,c;if(this.cfg.prompt||this.cfg.multiline)c=this.cfg.multiline?this.textArea:this.cfg.password?this.passField:this.textField,b=c.getValue(),c.reset();a.blur();this.hide();this.userCallback(a.itemId,
b,this.cfg)},hide:function(){this.dd.endDrag();this.progressBar.reset();this.removeCls(this.cfg.cls);this.callParent()},initComponent:function(){var a,b;this.title="&#160;";this.topContainer=Ext.create("Ext.container.Container",{anchor:"100%",style:{padding:"20px",overflow:"hidden"},items:[this.iconComponent=Ext.create("Ext.Component",{cls:"ext-mb-icon",width:50,height:this.iconHeight,style:{"float":"left"}}),this.promptContainer=Ext.create("Ext.container.Container",{layout:{type:"anchor"},items:[this.msg=
Ext.create("Ext.Component",{cls:"messagebox-text",anchor:"100%"}),this.comment=Ext.create("Ext.Component",{cls:"messagebox-text",anchor:"100%"}),this.textField=Ext.create("Ext.form.field.Text",{anchor:"100%",enableKeyEvents:!0,listeners:{keydown:this.onPromptKey,scope:this}}),this.passField=Ext.create("Ext.form.field.Text",{anchor:"100%",inputType:"password",enableKeyEvents:!0,listeners:{keydown:this.onPromptKey,scope:this}}),this.textArea=Ext.create("Ext.form.field.TextArea",{anchor:"100%",height:75})]})]});
this.progressBar=Ext.create("Ext.ProgressBar",{anchor:"-10",style:"margin-left:10px"});this.items=[this.topContainer,this.progressBar];this.msgButtons=[];for(a=0;4>a;a++)b=this.makeButton(a),this.msgButtons[b.itemId]=b,this.msgButtons.push(b);this.bottomTb=Ext.create("Ext.toolbar.Toolbar",{ui:"footer",dock:"bottom",layout:{pack:"end"},items:[this.msgButtons[0],this.msgButtons[1],this.msgButtons[2],this.msgButtons[3]]});this.dockedItems=[this.bottomTb];this.callParent()},onPromptKey:function(a,b){var c;
if(b.keyCode===Ext.EventObject.RETURN||10===b.keyCode)this.msgButtons.ok.isVisible()?(c=!0,this.msgButtons.ok.handler.call(this,this.msgButtons.ok)):this.msgButtons.yes.isVisible()&&(this.msgButtons.yes.handler.call(this,this.msgButtons.yes),c=!0),c&&this.textField.blur()},reconfigure:function(a){var b=a.buttons||0,c=!0,d=this.maxWidth;this.cfg=a=a||{};a.width&&(d=a.width);delete this.defaultFocus;this.animateTarget=a.animateTarget||void 0;this.modal=!1!==a.modal;a.title&&this.setTitle(a.title||"&#160;");
this.rendered?this.setSize(d,this.maxHeight):(this.width=d,this.render(Ext.getBody()));this.setPosition(-1E4,-1E4);this.closable=a.closable&&!a.wait;this.header.child("[type=close]").setVisible(!1!==a.closable);!a.title&&!this.closable?this.header.hide():this.header.show();this.liveDrag=!a.proxyDrag;this.userCallback=Ext.Function.bind(a.callback||a.fn||Ext.emptyFn,a.scope||Ext.global);this.setIcon(a.icon);a.msg?(this.msg.update(Ext.util.Format.nl2br(Ext.util.Format.htmlEncode(a.msg))),this.msg.show()):
this.msg.hide();a.comment?(this.comment.update(a.comment),this.comment.show()):this.comment.hide();a.prompt||a.multiline?(this.multiline=a.multiline)?(this.textArea.setValue(a.value),this.textArea.setHeight(a.defaultTextHeight||this.defaultTextHeight),this.textArea.show(),this.textField.hide(),this.defaultFocus=this.textArea):a.password?(this.passField.setValue(a.value),this.textArea.hide(),this.textField.hide(),this.passField.show(),this.defaultFocus=this.passField):(this.textField.setValue(a.value),
this.textArea.hide(),this.passField.hide(),this.textField.show(),this.defaultFocus=this.textField):(this.textArea.hide(),this.textField.hide(),this.passField.hide());a.progress||a.wait?(this.progressBar.show(),this.updateProgress(0,a.progressText),!0===a.wait&&this.progressBar.wait(a.waitConfig)):this.progressBar.hide();for(a=0;4>a;a++)b&Math.pow(2,a)?(this.defaultFocus||(this.defaultFocus=this.msgButtons[a]),this.msgButtons[a].show(),c=!1):this.msgButtons[a].hide();c?this.bottomTb.hide():this.bottomTb.show()},
show:function(a){this.reconfigure(a);this.addCls(a.cls);a.animateTarget?(this.doAutoSize(!0),this.callParent()):(this.callParent(),this.doAutoSize(!0));return this},afterShow:function(){this.animateTarget&&this.center();this.callParent(arguments)},doAutoSize:function(a){var b=this.iconComponent,c=this.iconHeight;Ext.isDefined(this.frameWidth)||(this.frameWidth=this.el.getWidth()-this.body.getWidth());b.setHeight(c);this.minWidth=this.cfg.minWidth||Ext.getClass(this).prototype.minWidth;this.topContainer.doLayout();
if(Ext.isIE6||Ext.isIEQuirks)this.textField.setCalculatedSize(9),this.passField.setCalculatedSize(9),this.textArea.setCalculatedSize(9);var d=this.cfg.width||this.msg.getWidth()+b.getWidth()+25,f=(this.header.rendered?this.header.getHeight():0)+Math.max(this.promptContainer.getHeight(),b.getHeight())+this.progressBar.getHeight()+(this.bottomTb.rendered?this.bottomTb.getHeight():0)+20;b.setHeight(Math.max(c,this.msg.getHeight()));this.setSize(d+this.frameWidth,f+this.frameWidth);a&&this.center();return this},
updateText:function(a){this.msg.update(a);return this.doAutoSize(!0)},setIcon:function(a){this.iconComponent.removeCls(this.iconCls);a?(this.iconComponent.show(),this.iconComponent.addCls(Ext.baseCSSPrefix+"dlg-icon"),this.iconComponent.addCls(this.iconCls=a)):(this.iconComponent.removeCls(Ext.baseCSSPrefix+"dlg-icon"),this.iconComponent.hide());return this},updateProgress:function(a,b,c){this.progressBar.updateProgress(a,b);c&&this.updateText(c);return this},onEsc:function(){!1!==this.closable&&
this.callParent(arguments)},confirm:function(a,b,c,d){Ext.isString(a)&&(a={title:a,icon:"ext-mb-question",msg:b,buttons:this.YESNO,callback:c,scope:d});return this.show(a)},prompt:function(a,b,c,d,f,e){Ext.isString(a)&&(a={prompt:!0,title:a,minWidth:this.minPromptWidth,msg:b,buttons:this.OKCANCEL,callback:c,scope:d,multiline:f,value:e,password:!1});return this.show(a)},password:function(a,b,c,d,f,e){Ext.isString(a)&&(a={prompt:!0,title:a,minWidth:this.minPromptWidth,msg:b,buttons:this.OKCANCEL,callback:c,
scope:d,multiline:f,value:e,password:!0});return this.show(a)},wait:function(a,b,c){Ext.isString(a)&&(a={title:b,msg:a,closable:!1,wait:!0,modal:!0,minWidth:this.minProgressWidth,waitConfig:c});return this.show(a)},alert:function(a,b,c,d){Ext.isString(a)&&(a={title:a,msg:b,buttons:this.OK,fn:c,scope:d,minWidth:this.minWidth});return this.show(a)},progress:function(a,b,c){Ext.isString(a)&&(a={title:a,msg:b,progress:!0,progressText:c});return this.show(a)}},function(){Forte.MessageBox=Forte.Msg=new this});(function(){Ext.onReady(function(){var a={};MessageHub.subscribe(Message.Notify,function(b){var c=b.getId();if(c)for(var d in a){if(d===c){$(".ide-notify-panel-body span",a[c].panel).html(b.getMessage());a[c].timer&&clearTimeout(a[c].timer);a[c].timer=setTimeout(function(b){b.animate({right:"-500px"},370,function(){b.remove();delete a[c]})},3E3,a[c].panel);return}}else c="toast"+Math.floor(1E7*Math.random());var f="";switch(b.getType()){case "none":f="";break;case "warning":f='<img src="/img/cell/notify_exclamation.png" style="margin-right: 5px;" />';
break;default:f='<img src="/img/cell/notify_checkmark.png" style="margin-right: 5px;" />'}var e=10;for(d in a){var h=a[d].offsetY+a[d].panel.height()+5;h>e&&(e=h)}e>$(window).height()-200&&(e=10);var g=$('<div class="ide-notify-panel" />');b.title&&g.append($('<div class="ide-notify-panel-header">'+htmlEscape(b.getTitle())+"</div>"));b.option&&g.append($('<div class="ide-notify-panel-header-option">'+b.getOption()+"</div>"));d=Ext.getDom("component:mainpanel");d||(d=document.body);g.append($('<div class="ide-notify-panel-body">'+
f+"<span>"+htmlEscape(b.getMessage())+"</span></div>")).css({top:e+"px",right:"-500px",width:"280px"}).appendTo(d).click(function(){$(this).animate({"margin-top":"3px","margin-left":"2px"},70).animate({right:"-500px"},270)}).animate({right:"14px"},280);f=setTimeout(function(){g.animate({right:"-500px"},370,function(){g.remove();delete a[c]})},3E3);a[c]={panel:g,offsetY:e,message:b.getMessage(),timer:f}})})})();(function(){Ext.define("Forte.Widgets.FileTemplate",{singleton:!0,htmlTemplate:function(){var a=Forte.API.userName;return'<!DOCTYPE html>\n <html>\n  <head>\n    <title>Title</title>\n    <meta charset="utf-8" />\n    <meta name="author" content="'+a+'"/>\n    <meta name="copyright" content="Copyright (C) '+a+'"/>\n    <meta name="description" content="" />\n    <meta name="keywords" content="" />\n  </head>\n  <body>\n    <h1>New Page</h1>\n  </body>\n</html>\n'}})})();(function(){Ext.define("Forte.Widgets.AssetsEncryptPasswordWindow",{extend:"Cell.window.LightWindow",singleton:!0,modal:!1,initComponent:function(){var a=this,b=[490,300],c=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#000",className:"spinner spinner-setting-load"})).spin();a.loadmask=new Ext.LoadMask(Ext.getBody(),{msg:c.el.outerHTML});Ext.apply(this,{id:"component:AssetsEncryptPasswordWindow",cls:"ide-build-window",title:Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_TITLE,width:b[0],
height:b[1],closable:!0,resizable:!1,closeAction:"hide",layout:"card",listeners:{beforeshow:function(){a.loadmask.show();$(".x-mask-msg").get(0).style.zIndex="20000";$(".x-mask").get(0).style.zIndex="20000";Forte.API.canBuildIOSApp(function(b){b.has_assets_encrypt_password&&a.down("#alert_message").show();a.loadmask.hide()})},beforehide:function(){a.down("#password").reset();a.down("#password_confirm").reset();a.down("#alert_message").hide();a.down("#error_message").hide()}},bbar:["->",{xtype:"cell.button",
ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){if(""!=a.down("#password").getValue()){var b={password:a.down("#password").getValue(),password_confirm:a.down("#password_confirm").getValue()};a.loadmask.show();$(".x-mask-msg").get(0).style.zIndex="20000";$(".x-mask").get(0).style.zIndex="20000";Forte.API.saveAssetsEncryptPassword(b,function(){(new Message.Notify({message:Forte.Resources.Text.WIDGETS_SAVE_SUCCESSFULLY,type:"report"})).send();a.loadmask.hide();a.close()},
function(b,c){var d=c.match(/\[([^\]]*)\]/g).map(function(a){return a.substring(1,a.length-1)}),g="";d instanceof Array&&(g="<div style='color: red'>"+d.join("<br/>")+"</div>");a.loadmask.hide();a.down("#alert_message").hide();a.down("#error_message").update(g);a.down("#error_message").show()})}}},{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.close()}}],items:[{layout:"vbox",width:b[0]-80,height:b[1],listeners:{},items:[{xtype:"container",
itemId:"options_alias",items:[{xtype:"component",id:"alert_message",hidden:!0,html:"<h3 style='color: red'>"+Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_ALREADY_EXISTS+"</h3>",style:{margin:10}},{xtype:"component",id:"error_message",hidden:!0,html:a.error_messag,style:{margin:10}},{xtype:"textfield",itemId:"password",inputType:"password",fieldLabel:Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_FIELD_PASSWORD,style:{"margin-top":20},width:400,labelWidth:180,listeners:{change:function(){}}},{xtype:"textfield",
inputType:"password",itemId:"password_confirm",fieldLabel:Forte.Resources.Text.WIDGETS_ASSETS_PASSWORD_FIELD_PASSWORD_CONFIRM,width:400,labelWidth:180,style:{"margin-bottom":0},listeners:{change:function(){}}}]}]}]});this.callParent()}})})();(function(){Ext.define("Forte.Widgets.InAppUpdaterSettingWindow",{extend:"Cell.window.LightWindow",singleton:!0,modal:!1,initComponent:function(){var a=this,b=[490,300],c=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#000",className:"spinner spinner-setting-load"})).spin();a.loadmask=new Ext.LoadMask(Ext.getBody(),{msg:c.el.outerHTML});Ext.apply(this,{id:"component:InAppUpdaterSettingWindow",cls:"ide-build-window",title:Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_TITLE,width:b[0],
height:b[1],closable:!0,resizable:!1,closeAction:"hide",layout:"card",listeners:{beforeshow:function(){a.loadmask.show();$(".x-mask-msg").get(0).style.zIndex="20000";$(".x-mask").get(0).style.zIndex="20000";Forte.API.getInAppUpdaterSetting(function(b){var c=null!==b.updateMode?b.updateMode:"default";a.down("#update_mode").setValue(c);a.down("#update_url").setValue(b.updateUrl);a.loadmask.hide()})},beforehide:function(){a.down("#error_message").hide()}},bbar:["->",{xtype:"cell.button",ui:"blue",width:100,
text:Forte.Resources.Text.GENERAL_OK,handler:function(){var b={updateMode:a.down("#update_mode").getValue(),updateUrl:a.down("#update_url").getValue()};a.loadmask.show();$(".x-mask-msg").get(0).style.zIndex="20000";$(".x-mask").get(0).style.zIndex="20000";Forte.API.saveInAppUpdaterSetting(b,function(){(new Message.Notify({message:Forte.Resources.Text.WIDGETS_SAVE_SUCCESSFULLY,type:"report"})).send();a.loadmask.hide();a.close()},function(b,c){var d=c.match(/\[([^\]]*)\]/g).map(function(a){return a.substring(1,
a.length-1)}),g="";d instanceof Array&&(g="<div style='color: red'>"+d.join("<br/>")+"</div>");a.down("#error_message").update(g);a.down("#error_message").show();a.loadmask.hide()})}},{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.close()}}],items:[{layout:"vbox",width:b[0]-80,height:b[1],listeners:{},items:[{xtype:"container",itemId:"options_alias",items:[{xtype:"component",id:"error_message",hidden:!0,html:a.error_message,style:{margin:10}},
{xtype:"cell.combobox",id:"update_mode",fieldLabel:Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_MODE,labelWidth:140,labelAlign:"left",size:15,displayField:"value",valueField:"value",editable:!1,forceSelection:!0,allowBlank:!1,value:"default",style:{"margin-top":25},store:Ext.create("Ext.data.Store",{fields:["value"],data:[{value:"default"},{value:"severe"}]})},{id:"update_url",xtype:"textfield",inputType:"text",fieldLabel:Forte.Resources.Text.WIDGETS_INAPP_UPDATER_SETTING_UPDATE_URL,style:{"margin-top":20},
width:400,labelWidth:140,listeners:{change:function(){}}}]}]}]});this.callParent()}})})();(function(){Ext.define("Forte.Widgets.PluginCommonSettingWindow",{extend:"Cell.window.LightWindow",singleton:!0,modal:!0,plugin:{},bodyStyle:"padding-top:20px",parentScope:null,pluginCard:null,initComponent:function(){var a=this,b=[490,450];a.versionsData=[];var c=(new Spinner({lines:11,length:11,width:5,radius:10,color:"#000",className:"spinner spinner-setting-load"})).spin();a.loadmask=new Ext.LoadMask(Ext.getBody(),{msg:c.el.outerHTML});maskIndex="20000";Ext.apply(a,{id:"component:PluginCommonSetting",
cls:"ide-build-window",width:b[0],height:b[1],closable:!0,resizable:!1,closeAction:"hide",layout:"card",listeners:{beforeshow:function(){a.setTitle(Forte.Resources.Text.PLUGIN_COMMON_SETTINGS_TITLE+a.plugin.name);a.down("[name=plugin_params_text]").setValue("");a.down("#plugin_version").setValue("");a.down("#plugin_version").show();a.down("#plugin_version").enable();a.loadmask.show();$(".x-mask-msg").get(0).style.zIndex=maskIndex;$(".x-mask").get(0).style.zIndex=maskIndex;parseFloat(Forte.API.cordovaVersion)>=
Forte.API.CORDOVA_VERSION_FIVE?(a.plugin.is_npm_plugin&&!1===Forte.API.can_support_cordova_plugin_version_change&&(a.down("#plugin_version").disable(),a.down("#crosswalk_version").disable(),a.down("#notification_plugin_version_change").show()),-1<a.plugin.id.indexOf("crosswalk"))?(a.down("#crosswalk_version").show(),a.down("#crosswalk_version").enable(),a.down("#notification_crosswalk_version").show(),!1===Forte.API.can_support_cordova_plugin_version_change&&a.down("#crosswalk_version").disable()):
(a.down("#crosswalk_version").hide(),a.down("#crosswalk_version").disable(),a.down("#notification_crosswalk_version").hide()):a.down("#notification_plugin_version_change").hide();if(!a.plugin.is_npm_plugin||parseFloat(Forte.API.cordovaVersion)<Forte.API.CORDOVA_VERSION_FIVE)a.down("#plugin_version").disable(),a.down("#plugin_version").hide();var b;Forte.API.getSpecificPluginSettings(a.plugin).then(function(c){var e=c.variables?c.variables:[];e.forEach(function(a){0==a.indexOf("XWALK_VERSION=",0)&&
(b=a.split("=")[1])});c=0<e.length?c.variables.join("\n"):"";a.down("[name=plugin_params_text]").setValue(c);a.plugin.is_npm_plugin&&parseFloat(Forte.API.cordovaVersion)>=Forte.API.CORDOVA_VERSION_FIVE?a.getPluginVersion(a).done(function(){a.down("#crosswalk_version").setValue(b);a.loadmask.hide()}).fail(function(){a.down("#crosswalk_version").setValue(b);a.down("#plugin_version").disable();a.loadmask.hide()}):(a.down("#plugin_version").hide(),a.down("#plugin_version").disable(),a.loadmask.hide())},
function(){a.close();a.loadmask.hide()})}},bbar:["->",{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){a.loadmask.show();$(".x-mask-msg").get(0).style.zIndex=maskIndex;$(".x-mask").get(0).style.zIndex=maskIndex;var b={variables_text:a.down("[name=plugin_params_text]").getValue(),using_plugin_version:a.plugin.version,update_plugin_version:a.down("#plugin_version").getValue()};Forte.API.updateSpecificPluginSettings(a.plugin,b).done(function(){(new Message.Notify({message:Forte.Resources.Text.WIDGETS_SAVE_SUCCESSFULLY,
type:"report"})).send();var b=a.down("#plugin_version").getValue();a.pluginCard.find("span.version").text(b?"v"+b:"");a.pluginCard.find("span.plugin-detail-version i").text(b?b:"");a.close()}).always(function(){a.loadmask.hide();a.parentScope.loadProjectSetting()})}},{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.close()}}],items:[{layout:"vbox",height:b[1],listeners:{},items:[{xtype:"container",items:[{xtype:"cell.component",id:"notification_plugin_version_change",
html:Forte.Resources.Text.SETTING_CORDOVA_PLUGIN_VERSION_CHANGE,hidden:!0,margin:"5 0"},{xtype:"cell.combobox",id:"plugin_version",fieldLabel:Forte.Resources.Text.SETTING_CORDOVA_PLUGIN_VERSION,labelWidth:170,labelAlign:"left",labelStyle:"padding: 0",size:15,displayField:"value",valueField:"value",editable:!1,forceSelection:!0,allowBlank:!0,value:{value:"1.0.0"},store:Ext.create("Ext.data.Store",{fields:["value"],data:[]})},{xtype:"cell.combobox",id:"crosswalk_version",fieldLabel:Forte.Resources.Text.SETTING_CORDOVA_PLUGIN_XWALK_VERSION,
labelWidth:170,labelAlign:"left",labelStyle:"padding: 0",size:15,displayField:"value",valueField:"value",editable:!1,forceSelection:!0,allowBlank:!1,value:{value:"222"},style:{"margin-top":25},hidden:!0,store:Ext.create("Ext.data.Store",{fields:["value"],data:[]}),listeners:{change:function(b){a.loadmask.show();for(var c=a.down("[name=plugin_params_text]").getValue().split("\n"),e=0;e<c.length;e++)0==c[e].indexOf("XWALK_VERSION=",0)&&(c[e]="XWALK_VERSION="+b.getValue());a.down("[name=plugin_params_text]").setValue(c.join("\n"));
a.loadmask.hide()}}},{xtype:"cell.component",html:Forte.Resources.Text.PLUGIN_COMMON_SETTINGS_VARS_LABEL,helpMsg:Forte.Resources.Text.PLUGIN_COMMON_SETTINGS_VARS_HELP,margin:"10 0"},{xtype:"cell.textarea",name:"plugin_params_text",emptyText:Forte.Resources.Text.PLUGIN_COMMON_SETTINGS_VARS_EG,allowBlank:!0,width:405,height:100,margin:"0 0 12 0"},{xtype:"cell.component",id:"notification_crosswalk_version",html:Forte.Resources.Text.SETTING_CORDOVA_PLUGIN_SETTING_XWALK_CAUTION,margin:"0 0 10 0"}]}]}]});
this.callParent()},setPlugin:function(a){this.plugin=a;return this},setPluginCard:function(a){this.pluginCard=a||null;return this},setParentScope:function(a){this.parentScope=a||null;return this},getPluginVersion:function(a){var b=$.Deferred(),c=a.plugin.id.split("@")[0],d=a.plugin.id.split("@")[1];Forte.API.getVersionListOfPlugin(c).then(function(f){var e=f[c];if(!e)return b.reject();var h=[];a.down("#plugin_version").store.removeAll();for(var g=0;g<e.length;g++)h.push({value:e[g]});a.down("#plugin_version").store.add(h);
a.down("#plugin_version").setValue(d);if(-1<a.plugin.id.indexOf("crosswalk")){f=f.crosswalk_version;e=[];a.down("#crosswalk_version").store.removeAll();for(g=0;g<f.length;g++)e.push({value:f[g]});a.down("#crosswalk_version").store.add(e)}b.resolve()});return b.promise()}})})();(function(){Ext.define("Forte.Widgets.ConfirmExcludedBuildFileDialog",{extend:"Cell.window.LightWindow",singleton:!0,modal:!1,initComponent:function(){var a=this,b=[490,380];Ext.apply(this,{id:"component:ConfirmExcludedBuildFileDialog",cls:"ide-build-window",title:Forte.Resources.Text.TAB_CONFIRM_CLOSE_TITLE,width:b[0],height:b[1],closable:!0,resizable:!1,closeAction:"hide",layout:"card",listeners:{},bbar:["->",{xtype:"cell.button",ui:"blue",width:100,text:Forte.Resources.Text.GENERAL_OK,handler:function(){a.down("#confirmDisplayCheckbox").getValue()&&
a.saveIsHiddenDialog("true");a.close();a.success_callback()}},{xtype:"cell.button",ui:"light",width:100,text:Forte.Resources.Text.GENERAL_CANCEL,handler:function(){a.close()}}],items:[{layout:"vbox",width:b[0]-90,height:b[1],style:{"margin-top":10},listeners:{},items:[{xtype:"container",itemId:"options_alias",items:[{xtype:"component",html:Forte.Resources.Text.NOTIFY_UNBUILD_FILE_EXISTS},{xtype:"textareafield",id:"excluded-build-subjects",grow:!1,readOnly:!0,name:"message",width:400,height:70},{xtype:"component",
id:"error_message",html:Forte.Resources.Text.NOTIFY_UNBUILD_FILES,style:{"margin-top":10}},{xtype:"checkbox",name:"reuse_provisioning",id:"confirmDisplayCheckbox",checked:!1,inputValue:"1",uncheckedValue:"0",width:b[0]-80,style:"margin-bottom: 7px;",boxLabel:Forte.Resources.Text.GENERAL_DONOT_ASK_AGAIN}]}]}]});this.callParent()},showDailog:function(){this.down("#excluded-build-subjects").setValue(this.displaySubjects.join("\n"));this.show()},setCallBack:function(a){this.success_callback=a},setDisplaySubjects:function(a){this.displaySubjects=
a},saveIsHiddenDialog:function(a){try{localStorage.setItem(Forte.API.projectId+"_"+this.id+"_isHidden",a)}catch(b){console.log(["Error saving LocalStorage",b])}},getIsHiddenDialog:function(){try{return localStorage.getItem(Forte.API.projectId+"_"+this.id+"_isHidden")}catch(a){console.log(["Error get LocalStorage",a])}}})})();
